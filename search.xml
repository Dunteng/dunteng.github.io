<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>小程序云函数路由优化之tcb-router</title>
      <link href="/2019/11/23/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E5%87%BD%E6%95%B0%E8%B7%AF%E7%94%B1%E4%BC%98%E5%8C%96%E4%B9%8Btcb-router.html"/>
      <url>/2019/11/23/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E5%87%BD%E6%95%B0%E8%B7%AF%E7%94%B1%E4%BC%98%E5%8C%96%E4%B9%8Btcb-router.html</url>
      
        <content type="html"><![CDATA[<h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>一个用户在一个云环境中只能创建50个云函数，之前是20个，更少。</p><p>比如我们要开发一个项目，当我们要获取A数据的时候可能要创建一个云函数，要获取B数据的时候又要创建一个云函数。。。。随着业务的增多，创建的对应的云函数数目越来越多，50个可能不够用，而且这种做法也很冗杂。</p><p>所以希望把相似的请求归类到同一个云函数处理，比如我们把获取音乐信息和获取电影信息都在同一个云函数里实现，从而避免创建过多云函数的情况。</p><p>要实现这一功能就要用到一个第三方库——<a href="https://github.com/TencentCloudBase/tcb-router" target="_blank" rel="noopener"><strong>tcb-router</strong></a> 一个<strong>koa风格</strong>的云函数路由库。</p><p><br></p><h2 id="koa洋葱模型"><a href="#koa洋葱模型" class="headerlink" title="koa洋葱模型"></a>koa洋葱模型</h2><p>koa框架采用了【中间件】的形式，中间件可以介入请求和相应的处理，可以理解是一个轻量级的模块，或者在我们的代码当中是一个函数形式。中间件可以负责一个特定的功能，通过一个<code>next</code>函数把每个中间件之间建立关系。</p><p>什么是【洋葱模型】？</p><p><img src="https://ask.qcloudimg.com/http-save/yehe-1000017/uuitxvbg4y.jpeg?imageView2/2/w/1620" alt=""></p><p><img src="https://images0.cnblogs.com/blog2015/570057/201507/281409123445079.jpg" alt=""></p><p>简单的理解就如上面两张图所表示的那样。</p><p><br></p><h2 id="tcbRouter云函数"><a href="#tcbRouter云函数" class="headerlink" title="tcbRouter云函数"></a>tcbRouter云函数</h2><p>这里我通过一个例子来说明一下<a href="https://github.com/TencentCloudBase/tcb-router" target="_blank" rel="noopener"><strong>tcb-router</strong></a>的用法。</p><p>我们实现一个功能：把获取音乐信息和获取电影信息都在同一个云函数里实现，两者都要获取<code>用户openid</code>并且获取各自的信息，从而避免创建多个云函数的情况。</p><p>创建云函数<code>tcbRouter</code>👇</p><p><img src="https://pic3.zhimg.com/80/v2-889713697407a747e014aeadc142866a_hd.jpg" alt=""></p><p>在tcbRouter云函数的目录下安装tcb-router依赖👇</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save tcb-router</span><br></pre></td></tr></table></figure><p><br></p><p>云函数<strong>tcbRouter</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 云函数入口文件</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line"><span class="comment">// 引入tcb-router</span></span><br><span class="line"><span class="keyword">const</span> TcbRouter = <span class="built_in">require</span>(<span class="string">'tcb-router'</span>)</span><br><span class="line"></span><br><span class="line">cloud.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 云函数入口函数</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// return &#123;event,context&#125;  //看看event和context到底是啥</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// new一个TcbRouter对象,需要传入一个参数,把event传入</span></span><br><span class="line">  <span class="comment">// 这时候tcb-router就会自动帮我们处理事件中的参数和路由转发</span></span><br><span class="line">  <span class="keyword">const</span> app = <span class="keyword">new</span> TcbRouter(&#123;event&#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 公共路由</span></span><br><span class="line">  <span class="comment">// app.use 表示该中间件会适用于所有的路由</span></span><br><span class="line">  app.use(<span class="keyword">async</span> (ctx,next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入全局中间件'</span>)</span><br><span class="line">    ctx.data = &#123;&#125;</span><br><span class="line">    ctx.data.openId = event.userInfo.openId <span class="comment">//通过该公共路由获取到用户openid</span></span><br><span class="line">    <span class="keyword">await</span> next()  <span class="comment">//执行一下中间件.这是一个异步操作,要加上await</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出全局中间件'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// music相关的路由</span></span><br><span class="line">  app.router(<span class="string">'music'</span>, <span class="keyword">async</span> (ctx,next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入音乐名称路由中间件'</span>)</span><br><span class="line">    ctx.data.musicName = <span class="string">"Let it be"</span></span><br><span class="line">    <span class="keyword">await</span> next()  <span class="comment">//执行一下中间件</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出音乐名称路由中间件'</span>)</span><br><span class="line">  &#125;, <span class="keyword">async</span> (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入音乐类型路由中间件'</span>)</span><br><span class="line">    ctx.data.musicType = <span class="string">'摇滚乐'</span></span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">      data: ctx.data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctx.body 返回数据到小程序端</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出音乐类型路由中间件'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// movie相关的路由</span></span><br><span class="line">  app.router(<span class="string">'movie'</span>, <span class="keyword">async</span> (ctx,next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入电影名称路由中间件'</span>)</span><br><span class="line">    ctx.data.movieName = <span class="string">"千与千寻"</span></span><br><span class="line">    <span class="keyword">await</span> next()  <span class="comment">//执行一下中间件</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出电影名称路由中间件'</span>)</span><br><span class="line">  &#125;, <span class="keyword">async</span> (ctx, next)=&gt;&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'进入电影类型路由中间件'</span>)</span><br><span class="line">    ctx.data.movieType = <span class="string">'动漫'</span></span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">      data: ctx.data</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ctx.body 返回数据到小程序端</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'退出电影类型路由中间件'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// // 必须写! 需要把当前的服务返回</span></span><br><span class="line">  <span class="keyword">return</span> app.serve()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><p>小程序端调用tcbRouter函数👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo.js</span></span><br><span class="line">getMusicInfo()&#123;</span><br><span class="line">   wx.cloud.callFunction(&#123;</span><br><span class="line">     name: <span class="string">'tcbRouter'</span>,</span><br><span class="line">     data: &#123;</span><br><span class="line">       $url: <span class="string">'music'</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(res)</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br><span class="line"> getMovieInfo()&#123;</span><br><span class="line">   wx.cloud.callFunction(&#123;</span><br><span class="line">     name: <span class="string">'tcbRouter'</span>,</span><br><span class="line">     data:&#123;</span><br><span class="line">       $url: <span class="string">'movie'</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(res)</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure><p>上面这段代码两个方法实际上调用的都是同一个云函数<strong>tcbRouter</strong>，但实现了不同的功能。</p><p><img src="https://pic1.zhimg.com/v2-928c9ce713a0d13a92d18d6abe21b910_r.jpg" alt=""></p><p><br></p><p>为了更加直观的体现【洋葱模型】这一概念在该例子上的应用，我们可以在云开发控制台的云函数运行日志中查看打印的日志👇</p><p><img src="https://pic3.zhimg.com/v2-0484ed79f891b5e7b2e82ad95296e6ca_r.jpg" alt=""></p><p><img src="https://images0.cnblogs.com/blog2015/570057/201507/281409123445079.jpg" alt=""></p><p><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> 小程序 </tag>
            
            <tag> 前端优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>复习预编译-作用域-闭包-立即执行函数</title>
      <link href="/2019/10/28/%E9%A2%84%E7%BC%96%E8%AF%91-%E4%BD%9C%E7%94%A8%E5%9F%9F-%E9%97%AD%E5%8C%85-%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0.html"/>
      <url>/2019/10/28/%E9%A2%84%E7%BC%96%E8%AF%91-%E4%BD%9C%E7%94%A8%E5%9F%9F-%E9%97%AD%E5%8C%85-%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0.html</url>
      
        <content type="html"><![CDATA[<h2 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h2><p>👉<a href="http://doc.liangxinghua.com/javascript/3.1.html" target="_blank" rel="noopener">点击</a></p><p>【补充】：</p><ul><li><p>注意区分什么是函数声明、什么是函数表示，不要混淆。</p></li><li><p>命定表达式</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570686806366.png" alt="1570686806366"></p><p>函数按照上面的方式定义后，只有test才是函数，test1不是一个函数，但是test1是test的name，可以通过test.name得到。</p></li></ul><h2 id="参数、返回值"><a href="#参数、返回值" class="headerlink" title="参数、返回值"></a>参数、返回值</h2><p>👉<a href="http://doc.liangxinghua.com/javascript/3.2.html" target="_blank" rel="noopener">点击</a></p><p><br><br></p><h2 id="预编译"><a href="#预编译" class="headerlink" title="预编译"></a>预编译</h2><p>JavaScript执行的三部曲：</p><p>​    1、语法分析：先通篇扫描一下看有没有语法错误，但是不执行。</p><p>​    2、预编译</p><p>​    3、解释执行</p><hr style="background-color:lightblue"><p><strong>【函数声明整体提升，变量的声明提升，变量的赋值不提升】</strong></p><p>我们知道JavaScript是解释一行执行一行的，看下面的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">666</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>它是可以成功执行打印出666的。因为<strong>函数声明整体提升</strong>了，它会把函数的声明提升到逻辑的最前面。</p><p>再看下面的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a);</span><br></pre></td></tr></table></figure><p>报错，a未定义。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">123</span>;</span><br></pre></td></tr></table></figure><p>可执行，但是打印结果为<strong>undefined</strong>。这说明了 a 是<strong>已经声明但是尚未赋值</strong>。这一现象是<strong>变量的声明提升</strong>。</p><p>但是，这两个口诀治标不治本，必须把预编译搞明白。</p><hr style="background-color:lightblue"><p><strong>imply global  暗示全局变量</strong>：</p><p>任何变量，如果变量未经声明就赋值，此变量就为全局对象window所有。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">a = <span class="number">10</span>; <span class="comment">//未经声明就赋值，相当于window.a = 10;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>再来一个栗子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = b = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">test();</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure><p>这个执行结果是报错的。</p><p><code>var a = b= 10</code>是从右往左赋值的，先将10赋值给b，但是b没有声明所以它是一个全局变量，之后再把b赋值给a，a有声明变量，它是函数test里面的一个局部变量。外界是无法访问a的，所以报错。但是如果打印b是可以正确输出10的。</p><hr style="background-color:lightblue"><p><strong>一切声明的全局变量，都归window所有，都是window的属性</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">var a = 10; //相当于window.a = 10;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><hr style="background-color:lightblue"><h3 id="函数预编译"><a href="#函数预编译" class="headerlink" title="函数预编译"></a>函数预编译</h3><p>函数预编译发生在函数执行的前一刻。过程如下：</p><ul><li>创建AO对象（Activation Object 执行期上下文，它的作用就是我们理解的作用域）</li><li>找形参和变量声明，将变量和形参名作为AO对象的属性名，值为undefined</li><li>将实参值和形参统一</li><li>找函数声明，将函数名也作为AO对象的属性名挂起来，将该声明的函数体作为值。</li></ul><p>举个栗子👇</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570706022488.png" alt="1570706022488"></p><p>这段代码执行结果为？</p><p>栗子1👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(a);</span><br><span class="line">      c = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">var</span> c;</span><br><span class="line">      a = <span class="number">3</span>;</span><br><span class="line">      b = <span class="number">2</span>;</span><br><span class="line">      <span class="built_in">console</span>.log(b);</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(b);</span><br><span class="line">    &#125;</span><br><span class="line">    test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>栗子2👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  <span class="built_in">console</span>.log(b);</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">234</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(b);</span><br><span class="line">  a = <span class="number">123</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  b = <span class="number">234</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><hr style="background-color:lightblue"><h3 id="全局预编译"><a href="#全局预编译" class="headerlink" title="全局预编译"></a>全局预编译</h3><p>和函数的预编译类似，同时它产生的叫做GO，GO就是window</p><ul><li>创建GO对象（global object 全局上下文，它的作用就是我们理解的全局作用域）</li><li>找形参和变量声明，将形参名、变量名作为GO对象的属性名，值为undefined</li><li>找函数声明，将函数名也作为GO对象的属性名挂起来，将该声明的函数体作为值。</li></ul><p>举个栗子👇</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570758880702.png" alt="1570758880702"></p><p>上面的栗子改动一下👇</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570759070170.png" alt="1570759070170"></p><p>来练练👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(test);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(test);</span><br><span class="line">  <span class="keyword">var</span> test = <span class="number">234</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(test);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> test = <span class="number">123</span>;</span><br><span class="line"><span class="built_in">console</span>.log(test);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(bar());</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      foo = <span class="number">10</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> foo = <span class="number">11</span>;</span><br><span class="line">      <span class="keyword">return</span> foo;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> foo;</span><br><span class="line">  foo = <span class="number">10</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> foo = <span class="number">11</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(bar());</span><br></pre></td></tr></table></figure><p><hr style="background-color:lightblue"></p><h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>每个JavaScript函数都是一个对象，对象中有些属性我们可以访问。也有些是不可以访问的，这种属性仅供JavaScript引擎存取，[[scope]]就是其中之一。</p><p>[[scope]]指的就是作用域，其中存储了运行期上下文的集合。</p><p>[[scope]]中所存储的执行期上下文对象的集合，这种集合呈链式链接，称作是<strong>作用域链</strong></p><hr style="background-color:lightblue"><p><strong>执行期上下文</strong>：当函数执行时，会创建一个称为执行期上下文的内部对象。一个执行期上下文定义了一个函数执行时的环境，函数每次执行时对应的执行上下文都是独一无二的，所以多次调用同一个函数会导致创建多个执行上下文，当函数执行完毕，它所产生的执行上下文就销毁。爽完了就抛弃，渣男！</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">test()  <span class="comment">//第一个执行test函数，创建了一个它的执行上下文AO</span></span><br><span class="line"><span class="comment">//执行完毕后，AO就被销毁了</span></span><br><span class="line">test()  <span class="comment">//再一次执行test函数，又需要创建一个执行上下文AO</span></span><br><span class="line"><span class="comment">//爽完之后再次抛弃(╬▔皿▔)凸</span></span><br></pre></td></tr></table></figure><p><hr style="background-color:lightblue"><br>举个栗子👇</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570772661596.png" alt="1570772661596"></p><p>这段代码首先是函数a的声明，a函数被定义的时候就产生了如下环节：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570772746072.png" alt="1570772746072"></p><p>a的[[scope]]里面存的是scope chain即作用域链，这时候作用域链里只有一个全局执行上下文GO，紧接着执行代码<code>var glob = 100</code>更新GO。紧接着执行函数a()。</p><p>a函数执行的时候就产生了它的执行期上下文AO，并把AO放到作用域链的最顶端，现前的GO就往后稍稍。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570773023375.png" alt="1570773023375"></p><p>一旦我们再a里面查找一个变量的话，它会从a的作用域链的顶端——AO<strong>依次向下</strong>查找。</p><p>紧接着，由于a的执行产生了一个过程——b函数的定义，b作为函数也有自己的[[scope]]，但是b刚出生时它的环境就是a给它的，所以b可以捡现成的[[scope]]。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570773293755.png" alt="1570773293755"></p><p>即b刚刚被定义的时候，它保存的就是a的劳动成果。</p><p>重点在于b函数被执行的时候，它也产生了它的执行上下文AO，将其放在作用域链的最顶端，之前a的AO和GO就又往后稍稍了。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570773491976.png" alt="1570773491976"></p><p>这时如果在b里面找一个变量的话，也是从作用域链的最顶端自顶向下查找。</p><p>b()执行完成之后，b自己的AO就被销毁了，b.[[[scope]]回到了b一开始被定义的时候；</p><p>接着b()执行完说明a()也执行完成了，a自己的AO也被销毁了，a.[[scope]]回到了a一开始定义的时候。</p><p><hr style="background-color:lightblue"><br>再举个栗子👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    c();</span><br><span class="line">  &#125;</span><br><span class="line">  b();</span><br><span class="line">&#125;</span><br><span class="line">a()</span><br></pre></td></tr></table></figure><p>执行a()，得到作用域链如下：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570775695313.png" alt="1570775695313"></p><p>在任何一个函数里面想要访问一个变量，找它的作用域链就完事了。想要访问变量一定是看在这个函数执行时产生的作用域链，而且是自顶向下访问。</p><p>假如我们要在b函数里面访问c函数里定义的cc变量，那么这时候我们是站在【b executing  b.[[scoep]]】这个作用域链上的，而这个作用域链里面根本没有cAO，也就访问不到c函数里面定义的cc变量了。这就是为什么函数外部无法访问函数内部的变量的原因。</p><p>ps：上面这段代码如果a函数没有执行就没有【a executing 。。。】及其之后的作用域链。</p><p><br><br></p><h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><p>一个栗子👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bbb = <span class="number">234</span>;</span><br><span class="line">    <span class="built_in">document</span>.write(aaa);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> aaa = <span class="number">123</span>;</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> glob = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> demo = a();</span><br><span class="line">demo();</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570777469422.png" alt="1570777469422"></p><p>a执行完毕后销毁了aAO，讲道理，里面的aaa也应该销毁了，但是a函数把b返回了出来并且赋给了demo，导致demo保留了aAO，从而可以访问到aaa。最终结果是打印出123。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570777779515.png" alt="1570777779515"></p><p>这就是闭包。</p><p><strong>但凡函数内部的函数，被保存到了外面，一定生成闭包。</strong></p><hr style="background-color:lightblue"><p>再来个详细一点的图文：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570780727395.png" alt="1570780727395"></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570784350992.png" alt="1570784350992"></p><hr style="background-color:lightblue"><p>当内部函数被保存到外部时，将会生成闭包。</p><h2 id="闭包的作用"><a href="#闭包的作用" class="headerlink" title="闭包的作用"></a>闭包的作用</h2><ul><li><p>实现公有变量</p><ul><li><p>栗子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">demo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     count++;</span><br><span class="line">     <span class="built_in">console</span>.log(count);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> demo</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//这样就把count这个变量公有化了</span></span><br><span class="line"> <span class="keyword">var</span> counter = add();</span><br><span class="line">    </span><br><span class="line"> setInterval(counter, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>可以做缓存（存储结构）</p></li><li><p>可以实现封装，属性私有化</p></li><li><p>模块化开发，防止污染全局变量</p></li></ul><p>【闭包的缺点】闭包会导致原有作用域链不释放，占用内存，造成内存泄漏。</p><p><br><br></p><h2 id="立即执行函数"><a href="#立即执行函数" class="headerlink" title="立即执行函数"></a>立即执行函数</h2><p>执行完立即销毁</p><p>两种格式：</p><ul><li>(function () { })()</li><li>(function () { }())</li></ul><p><br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test()<span class="comment">//这样是可以成功执行的</span></span><br></pre></td></tr></table></figure><p>而且打印test结果就是test函数的函数体。那么我这样写行不行呢？👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><p>⚠很遗憾，不行！！！</p><p>这里记住：【只有表达式才能被执行符号()执行】</p><p>所以上面栗子中<code>function test(){}</code>它是函数声明，不是表达式，不可以被执行；</p><p>而<code>test()</code>中<code>test</code>就算单独杵着它也是一个表达式，不是说非要<code>a+b</code>之类的才叫表达式，单独的<code>123;</code>、<code>test</code>也是表达式了。</p><p>那么！函数表达式能不能被执行呢？</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure><p>都叫表达式了它就一定能被执行。</p><p>【奇技淫巧】</p><p>记住表达式能被立即执行则表达式的名字不存在，举个栗子👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在控制台操作如下：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570789411336.png" alt="1570789411336"></p><p>这个test的名字还代表着这个函数。    </p><p>但是，我们在函数表达式后边加一个括号，这个表达式就可以被立即执行了：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><p>控制台中打印test为undefined，它就不再代表函数了，<code>function(){console.log(666)}</code>被永久的放弃了，这也符合立即执行函数的特点，用完就销毁。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570789509076.png" alt="1570789509076"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ function test() &#123;</span><br><span class="line">  console.log(666);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><p>函数声明后面加上括号是不可以被执行的，但是在函数声明前面加上一个加号，就会使得<code>function test(){}</code>有一个转化为number类型的趋势，整个<code>+ function(){}</code>就变成了一个表达式,，从而可以被括号执行。同样的减号也可以办到。但是乘号除号不可以。</p><p>以下的运算符都可以办到：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> || <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">    <span class="number">1</span> &amp;&amp; <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"> !<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">666</span>);</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><p>被执行了之后，test就不再代表<code>function (){}</code>了，变成了undefined。</p><p>以上的核心步骤就是【将函数声明变成表达式，就可以被立即执行了】</p><p><strong>那么括号()也是运算符，将函数声明用括号包起来，就能将函数声明变成表达式了！因此可以被立即执行。这就是立即执行函数的原理。</strong></p><p>好，来个迷惑又恶心的 栗子👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b, c, d</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a + b + c + d);</span><br><span class="line">&#125; (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>这个居然不报错！因为系统将其理解成了：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b, c, d</span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(a + b + c + d);</span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>虽然不报错，但也没执行test函数。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570795567350.png" alt="1570795567350"></p><p>再来一个👇：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f = (</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"1"</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">)();</span><br><span class="line"><span class="built_in">console</span>.log(f);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> f);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570807949996.png" alt="1570807949996"></p><p>再来一个难的栗子👇：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; &#125;) &#123;</span><br><span class="line">  x += <span class="keyword">typeof</span> f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(x);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570810489773.png" alt="1570810489773"></p><hr><p>【一颗经典的栗子】👇：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    arr[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test().forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">  element()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>我们想要的结果是输出从0到9，但是结果是输出了十个10。为啥呢？</p><p>在for循环的过程中，把函数体<code>function(){console.log(i)}</code>赋给了arr[0]、arr[1]、arr[2]。。。。。arr[9]，注意不是把<code>function(){console.log(0)}</code>赋给了arr[0]、把<code>function(){console.log(1)}</code>赋给arr[1]。。。把<code>function(){console.log(9)}</code>赋给arr[9]。这点要搞清楚。所以循环结束，是把十个相同的函数体赋给了数组arr，而在执行arr里的每一个元素即每一个函数体的时候，才会给函数体里的 i 进行赋值，而赋值的时候可以看到 i 的值为10！所以最终打印除了十个10。</p><p>{建议手写GO、AO作用域链，可以更理解清晰）</p><p>解决方案：</p><p>方法一：利用立即执行函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">j</span>) </span>&#123;</span><br><span class="line">      arr[j] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(j);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)(i)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test().forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">  element()</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>方案二：另一种立即执行函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params">ele</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ele);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    arr[i] = foo(i)；<span class="comment">//参数传入时foo函数就执行了</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test().forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">  element</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>以上栗子的实际应用如下👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给每个li添加点击事件，点击时打印该li的顺序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> liCollection = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'li'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; liCollection.length; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">j</span>) </span>&#123;</span><br><span class="line">      liCollection[j].onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(j);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test()</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="with"><a href="#with" class="headerlink" title="with"></a>with</h2><p>with 可以改变作用域链</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'obj-name'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"window"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'scope'</span>;</span><br><span class="line">  <span class="keyword">with</span> (obj) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure><p>with(obj){…}括号里填入对象obj，会把这个对象obj当作with圈定的代码体的作用域链的最顶端，即把obj当作最顶端的AO（执行上下文），所以打印出来的name就是obj里的name。</p><p>💡应用场景</p><p>之前说过命名空间</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> org = &#123;</span><br><span class="line">  dp1: &#123;</span><br><span class="line">    jc: &#123;</span><br><span class="line">      name: <span class="string">'jicheng'</span>,</span><br><span class="line">      age: <span class="number">22</span></span><br><span class="line">    &#125;,</span><br><span class="line">    deng: &#123;</span><br><span class="line">      name: <span class="string">"laodeng"</span>,</span><br><span class="line">      age: <span class="number">30</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  dp2: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当dp1部门的jc要开发的时候,通过如下方式获取并编程</span></span><br><span class="line"><span class="comment">// org.dp1.jc.age</span></span><br><span class="line"><span class="comment">// org.dp1.jc.name</span></span><br><span class="line"><span class="comment">// org.dp1.jc.xxx....</span></span><br><span class="line"><span class="comment">// 这样太麻烦了，可以先var jc = org.dp1.jc  从而简化代码</span></span><br><span class="line"><span class="comment">// 实际上开发时使用with的，这样最简便</span></span><br><span class="line"><span class="keyword">with</span> (org.dp1.jc) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">  <span class="built_in">console</span>.log(age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>⚠使用with会降低效率，所以<br>ES5严格模式禁止使用它。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>复习数组</title>
      <link href="/2019/10/28/%E5%A4%8D%E4%B9%A0%E6%95%B0%E7%BB%84.html"/>
      <url>/2019/10/28/%E5%A4%8D%E4%B9%A0%E6%95%B0%E7%BB%84.html</url>
      
        <content type="html"><![CDATA[<p>可以先看一下这里的总结👉<a href="https://www.jianshu.com/p/9521594710d7" target="_blank" rel="noopener">点击</a></p><h2 id="数组创建方法"><a href="#数组创建方法" class="headerlink" title="数组创建方法"></a>数组创建方法</h2><ul><li><p>字面量定义方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure></li><li><p>new Array</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>);<span class="comment">//创建了长度为10的稀松数组，值都为undefined</span></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>); <span class="comment">//创建了数组[1,2,3,4]</span></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10.2</span>)<span class="comment">//报错，长度不能为小数</span></span><br></pre></td></tr></table></figure></li></ul><p><br><br></p><h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><p>【会改变原数组的方法】</p><ul><li><p>push</p></li><li><p>pop</p></li><li><p>shift</p></li><li><p>unshift</p></li><li><p>reverse</p></li><li><p>splice</p></li><li><p>sort</p></li></ul><p>【不会改变原数组的方法】</p><ul><li>concat</li><li>join</li><li>slice</li><li>toString</li><li>join，返回字符串</li><li>String.split，这个不是数组的方法，它是字符串的方法。返回数组   join和split互逆</li></ul><p><strong>数组和字符串之间的相互转换就可以使用join和split</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570956573946.png" alt="1570956573946"></p><p>手写push方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">Array</span>.prototype.push = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">this</span>[<span class="keyword">this</span>.length] = <span class="built_in">arguments</span>[i];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.length + <span class="string">"  我是手写的push"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"><span class="built_in">console</span>.log(arr.push(<span class="number">5</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"><span class="built_in">console</span>.log(arr.push(<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure><p><br></p><p>  这个splice我要特别记一下，他是这样子的👇</p><p>  arr.splice(从第几位开始，截取多少的长度，在切口处添加新数据)</p><p>  这个位数的判断很微妙，这里特别说一下，之前一直理解错</p><p>  <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570954253675.png" alt="1570954253675"></p><p>  <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570954293519.png" alt="1570954293519"></p><p>  如果是splice(-1)表示从倒数第一位置开始切。</p><p><br></p><p>sort不能直接使用，要传入一个函数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">4</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure><p>以上是升序排序。</p><p>可以再简化一下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a - b;<span class="comment">//升序</span></span><br><span class="line"><span class="comment">//return b - a;//降序</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>练练👇：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给定一个有序的数组，使其乱序</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//对象数组的排序</span><br><span class="line">var aaa = &#123;</span><br><span class="line">  age: 12,</span><br><span class="line">  name: &apos;AAA&apos;</span><br><span class="line">&#125;,</span><br><span class="line">  bbb = &#123;</span><br><span class="line">    age: 20,</span><br><span class="line">    name: &apos;BBB&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  ccc = &#123;</span><br><span class="line">    age: 6,</span><br><span class="line">    name: &apos;CCC&apos;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">var arr = [aaa, bbb, ccc];</span><br><span class="line">arr.sort(function (a, b) &#123;</span><br><span class="line">  return a.age - b.age</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.log(arr);</span><br></pre></td></tr></table></figure><p><br></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570956085353.png" alt="1570956085353"></p><p><br></p><p>slice方法</p><p>slice（从该位开始截取，截取到该位），返回出截取出来的数组</p><p><br><br></p><h2 id="类数组"><a href="#类数组" class="headerlink" title="类数组"></a>类数组</h2><p>举个栗子，arguments就是个类数组。</p><p>手写一个类数组：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">  &quot;0&quot;: &apos;a&apos;,</span><br><span class="line">  &quot;1&quot;: &apos;b&apos;,</span><br><span class="line">  &quot;2&quot;: &apos;c&apos;,</span><br><span class="line">  &quot;length&quot;: 3,</span><br><span class="line">  &quot;push&quot;: Array.prototype.push</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570957073803.png" alt="1570957073803"></p><p>💡类数组：属性要为索引（数字）属性，必须有length属性，最好加上push方法。而且如果加上splice方法的话，外观就更像数组了👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="string">"0"</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="string">"1"</span>: <span class="string">'b'</span>,</span><br><span class="line">  <span class="string">"2"</span>: <span class="string">'c'</span>,</span><br><span class="line">  <span class="string">"length"</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="string">"push"</span>: <span class="built_in">Array</span>.prototype.push,</span><br><span class="line">  <span class="string">"splice"</span>: <span class="built_in">Array</span>.prototype.splice</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570957380785.png" alt="1570957380785"></p><p>阿里巴巴笔试题👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 运行以下代码，问obj变成了什么样？</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="string">"2"</span>: <span class="string">'a'</span>,</span><br><span class="line">  <span class="string">"3"</span>: <span class="string">'b'</span>,</span><br><span class="line">  <span class="string">"length"</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="string">"push"</span>: <span class="built_in">Array</span>.prototype.push,</span><br><span class="line">  <span class="string">"splice"</span>: <span class="built_in">Array</span>.prototype.splice</span><br><span class="line">&#125;</span><br><span class="line">obj.push(<span class="string">'c'</span>);</span><br><span class="line">obj.push(<span class="string">'d'</span>);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570957532671.png" alt="1570957532671"></p><p>这里看一下push的原理就懂了，我上文有写👆</p><p><br></p><p>【封装typeof】</p><p>使其可以准确判断类型</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_type</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> template = &#123;</span><br><span class="line">    <span class="string">"[object Array]"</span>: <span class="string">"array"</span>,</span><br><span class="line">    <span class="string">"[object Object]"</span>: <span class="string">"object"</span>,</span><br><span class="line">    <span class="comment">// 下面三个包装类</span></span><br><span class="line">    <span class="string">"[object Number]"</span>: <span class="string">"number - object"</span>,</span><br><span class="line">    <span class="string">"[object Boolean]"</span>: <span class="string">"boolean - object"</span>,</span><br><span class="line">    <span class="string">"[object String]"</span>: <span class="string">"string - object"</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (target == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> (target) == <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="built_in">Object</span>.prototype.toString.call(target);</span><br><span class="line">    <span class="keyword">return</span> template[str];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> (target);<span class="comment">//原始值和Function可以直接通过原生typeof判断</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><p>【数组去重】</p><p>方法一：利用对象属性的唯一性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> temp = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  <span class="keyword">var</span> len = <span class="keyword">this</span>.length;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!temp[<span class="keyword">this</span>[i]]) &#123;</span><br><span class="line">      temp[<span class="keyword">this</span>[i]] = <span class="string">"abc"</span>;</span><br><span class="line">      arr.push(<span class="keyword">this</span>[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="built_in">console</span>.log(arr.unique());</span><br></pre></td></tr></table></figure><p>方法二：利用ES6的[..new Set(arr)]或者Array.from(new Set(arr))</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>,];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'type error!'</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [...new <span class="built_in">Set</span>(arr)];</span><br><span class="line">  <span class="comment">//return Array.from(new Set(arr))  </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(unique(arr));</span><br></pre></td></tr></table></figure><p>方法三： 双循环</p><p>双重for（或while）循环是比较笨拙的方法，它实现的原理很简单：先定义一个包含原始数组第一个元素的数组，然后遍历原始数组，将原始数组中的每个元素与新数组中的每个元素进行比对，如果不重复则添加到新数组中，最后返回新数组；因为它的时间复杂度是O(n^2)，如果数组长度很大，那么将会非常耗费内存</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'type error!'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> res = [arr[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> flag = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; res.length; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] === res[j]) &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;<span class="comment">//利用一个flag来判断是否已存在，关键</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            res.push(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方法四：indexOf方法</p><p>数组的indexOf()方法可返回某个指定的元素在数组中首次出现的位置。该方法首先定义一个空数组res，然后调用indexOf方法对原来的数组进行遍历判断，如果元素不在res中，则将其push进res中，最后将res返回即可获得去重的数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'type error!'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> res = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.indexOf(arr[i]) === <span class="number">-1</span>) &#123;</span><br><span class="line">            res.push(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br><br></p><p>来点随堂练习👇：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">delete</span> x;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;)(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>结果为1。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 形参实际上就是隐式地执行了 var x;</span></span><br><span class="line">  <span class="comment">// 同时注意，var出来的变量，如果不是作为属性而存在的话，是无法被delete掉的</span></span><br><span class="line">  <span class="keyword">delete</span> x;<span class="comment">//无效</span></span><br><span class="line">  <span class="keyword">return</span> x;<span class="comment">//该是啥就是啥</span></span><br><span class="line">&#125;)(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> h = <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">23</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> a());<span class="comment">//Uncaught ReferenceError: a is not defined</span></span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>复习对象</title>
      <link href="/2019/10/28/%E5%AF%B9%E8%B1%A1.html"/>
      <url>/2019/10/28/%E5%AF%B9%E8%B1%A1.html</url>
      
        <content type="html"><![CDATA[<h2 id="对象创建方法"><a href="#对象创建方法" class="headerlink" title="对象创建方法"></a>对象创建方法</h2><ul><li><p>对象字面量</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; &#125;;</span><br></pre></td></tr></table></figure></li><li><p>系统自带的构造函数Object()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br></pre></td></tr></table></figure></li><li><p>自定义构造函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 与普通函数区别：1、函数名大驼峰命名；2、定义属性和方法为纯语句</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Teacher</span>(<span class="params">name, sex</span>) </span>&#123; <span class="comment">// 传入参数-单个属性</span></span><br><span class="line">    <span class="comment">// 当没有经过关键字new构造函数，就还没有实例化，此时this不存在</span></span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">25</span>; <span class="comment">// 默认属性</span></span><br><span class="line">    <span class="keyword">this</span>.smoke = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'I am smoking'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> teacher = <span class="keyword">new</span> Teacher(<span class="string">'dunteng'</span>,<span class="string">'male'</span>);</span><br></pre></td></tr></table></figure></li><li><p>Object.create()创建对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">"xiaoming"</span>,</span><br><span class="line">  age: <span class="number">18</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 将obj作为obj1的原型</span></span><br><span class="line"><span class="keyword">var</span> obj1 = <span class="built_in">Object</span>.create(obj)</span><br></pre></td></tr></table></figure></li></ul><p><br><br></p><h2 id="构造函数的内部原理"><a href="#构造函数的内部原理" class="headerlink" title="构造函数的内部原理"></a>构造函数的内部原理</h2><ol><li>在函数体最前面隐式地加上<code>this={}</code></li><li>执行<code>this.xxx = xxx;</code></li><li>隐式地返回<code>this</code></li></ol><p>构造函数能构造出对象的前提是要new它！从而触发构造函数的内部原理。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,height</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// var this =&#123;&#125;</span></span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.height = height;</span><br><span class="line">  <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.say);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// return this</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">'xiaolin'</span>,<span class="number">180</span>);</span><br></pre></td></tr></table></figure><p>⚠来点捣乱的</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, height</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.height = height;</span><br><span class="line">  <span class="keyword">this</span>.say = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.say);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;&#125;;<span class="comment">//返回一个空对象</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">'xiaolin'</span>, <span class="number">180</span>);</span><br></pre></td></tr></table></figure><p>结果person的值就变成了return出来的空对象。</p><p>在构造函数内部允许显示地return出一个对象（空对象也好其他对象也好），则new出来的实例结果就是对应的对象。⚠但是如果是显示return出数字、字符串、undefined或者null，即return的是五大原始值，则new出实例的时候仍然是return语句前面构造出来的this对象！</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570849572989.png" alt="1570849572989"></p><p><br><br></p><h2 id="包装类"><a href="#包装类" class="headerlink" title="包装类"></a>包装类</h2><p><strong>原始值是不能有属性和方法的</strong>。</p><p>看下面👇</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570850068707.png" alt="1570850068707"></p><p>这里的num依然是数字，但是它是用<strong>包装类</strong>Number new出来的数字对象，那么<strong>它就可以加属性和方法</strong>。同时它依旧可以运算，但是运算结果是原始值的数字。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570850243772.png" alt="1570850243772"></p><p>同样的也有:</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570850309748.png" alt="1570850309748"></p><p>前面说了原始值不能有属性和方法，那么看下面的栗子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">4</span>;</span><br><span class="line">num.len = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">console</span>.log(num.len);</span><br></pre></td></tr></table></figure><p>打印结果为undefined，也不报错。原因是存在包装类的隐式调用，如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">4</span>;</span><br><span class="line">num.len = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// 原始值是不能有属性和方法的，但是在这里系统会自动执行：new Number(num).len = 3以避免报错</span></span><br><span class="line"><span class="comment">// 但随即又delete自己。即刚new完Number随机就把自己删了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后在console.log(num.len)的时候，讲道理num.len已经不存在了会报错的</span></span><br><span class="line"><span class="comment">// 但是系统为了避免报错又隐式地执行了new Number(num).len，所以结果为输出undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(num.len);</span><br></pre></td></tr></table></figure><p><br></p><hr><p>对于数组，有以下的可行操作：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">arr.length = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(arr);<span class="comment">//[1,2]</span></span><br></pre></td></tr></table></figure><p>数组是可以通过length来截断的，但字符串不行！</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"1234"</span>;</span><br><span class="line">str.length = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str);<span class="comment">//"1234"</span></span><br></pre></td></tr></table></figure><p>分析：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"1234"</span>;</span><br><span class="line">str.length = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 执行到str.length = 2的时候系统隐式地执行了new Number(str).length=2,</span></span><br><span class="line"><span class="comment">// 以避免报错，但随机就销毁了</span></span><br><span class="line"><span class="built_in">console</span>.log(str);<span class="comment">//"1234"</span></span><br><span class="line"><span class="comment">// 执行console.log(str.length)的时候系统隐式地执行了new Number(str).length，</span></span><br><span class="line"><span class="comment">// 而length是String类型内置的属性，可以访问</span></span><br><span class="line"><span class="built_in">console</span>.log(str.length);<span class="comment">//4</span></span><br></pre></td></tr></table></figure><p><br></p><hr><p><strong>来练练</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"abc"</span>;</span><br><span class="line">str += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> test = <span class="keyword">typeof</span> (str);</span><br><span class="line"><span class="keyword">if</span> (test.length == <span class="number">6</span>) &#123;</span><br><span class="line">  test.sign = <span class="string">"hello world"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(test.sign);</span><br></pre></td></tr></table></figure><p>分析如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"abc"</span>;</span><br><span class="line">str += <span class="number">1</span>;  <span class="comment">//str变成了"abc1"</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="keyword">typeof</span> (str);  <span class="comment">//test为"string"</span></span><br><span class="line"><span class="keyword">if</span> (test.length == <span class="number">6</span>) &#123;</span><br><span class="line">  test.sign = <span class="string">"hello world"</span>;<span class="comment">//test是字符串，原始值不能有属性，隐式地执行</span></span><br><span class="line">  <span class="comment">//new Number(test).sign="hello world"，随即销毁</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//隐式地执行包装类转换：new Number(test).sign，随即销毁</span></span><br><span class="line"><span class="built_in">console</span>.log(test.sign);<span class="comment">//undefined</span></span><br></pre></td></tr></table></figure><p><br></p><p>同闭包知识点结合的一题👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, sex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sss</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    a++;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.say = sss;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</span><br><span class="line">person1.say();</span><br><span class="line">person1.say();</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</span><br><span class="line">person2.say();</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="原型prototype"><a href="#原型prototype" class="headerlink" title="原型prototype"></a>原型prototype</h2><ul><li><p>定义： 原型是function对象的一个属性，它定义了构造函数制造出的对象的公共祖先。通过该构造函数产生的对象，可以继承原型的属性和方法。原型也是对象。</p></li><li><p>利用原型特点和概念，可以提取共有属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Car.prototype.height = <span class="number">1400</span>;</span><br><span class="line">Car.prototype.lang = <span class="number">4900</span>;</span><br><span class="line">Car.prototype.carName = <span class="string">"BMW"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">color, owner</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.owner = owner;</span><br><span class="line">  <span class="keyword">this</span>.color = color;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">var</span> car = <span class="keyword">new</span> Car(<span class="string">'red'</span>, <span class="string">'dunteng'</span>)</span><br><span class="line"><span class="keyword">var</span> car = <span class="keyword">new</span> Car(<span class="string">'pink'</span>, <span class="string">'xiaolin'</span>)</span><br></pre></td></tr></table></figure></li><li><p>对象如何查看原型   通过隐式属性<code>__proto__</code></p><p>​    访问对象实例的属性的时候，先查看实例对象自己有没有，没有的话就通过它的隐式属性<code>__proto__</code>查看原型里有没有这个属性。</p><p>💡  <code>对象实例.__proto__</code>全等于<code>对象构造函数.prototype</code></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570862901392.png" alt="1570862901392"></p></li></ul><p>  <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570863065304.png" alt="1570863065304"></p><ul><li><p>对象如何查看对象的构造函数   通过<code>constructor</code></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570863239261.png" alt="1570863239261"></p><p>constructor存在于原型中。</p></li></ul><p><br><hr></p><p>看典例👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype.name = <span class="string">"sunny"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"sunny"</span></span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">"jenny"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"jenny"</span></span><br></pre></td></tr></table></figure><p>上面这个很容易理解，但下面改一下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Person.prototype.name = <span class="string">"sunny"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="comment">// 在new的时候存在一个隐式过程👇</span></span><br><span class="line"><span class="comment">// function Person() &#123;</span></span><br><span class="line"><span class="comment">// var this = &#123;</span></span><br><span class="line"><span class="comment">//   __proto__: Person.prototype   用__proto__记录了Person.prototype的地址</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"sunny"</span></span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  name: <span class="string">'jenny'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 将Person.prototype重新指向了一个新的空间，而person作为new出来的实例是通过__proto__查找</span></span><br><span class="line"><span class="comment">// 原型的，__proto__中记录的东西并没有改变，仍指向原来的Person.prototyped空间</span></span><br><span class="line"><span class="built_in">console</span>.log(person.name);  <span class="comment">//"sunny"</span></span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><p>原型也有自己的原型，就形成了原型链。原型链的终端是Object.prototype。可以说<strong>绝大多数</strong>对象的最终都会继承自Object.prototype。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GrandFather.prototype.lastName = <span class="string">"wang"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GrandFather</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">"祖父"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> grandfather = <span class="keyword">new</span> GrandFather();</span><br><span class="line"></span><br><span class="line">Father.prototype = grandfather;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">"父亲"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> father = <span class="keyword">new</span> Father();</span><br><span class="line"></span><br><span class="line">Son.prototype = father;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">"儿子"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br><span class="line"><span class="built_in">console</span>.log(son.lastName);<span class="comment">//"wang"</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570865370449.png" alt="1570865370449"></p><hr><p>前面有提到【绝大多数的对象最终都继承自Object.prototype】，那么什么对象例外呢？</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570866805009.png" alt="1570866805009"></p><hr><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570867335732.png" alt="1570867335732"></p><p>原始值的123是没有方法的，所以要用包装类包装成Number类型，再调用toString方法，注意这里的toString方法是Number()自己重写的，不是Object()的toString，Object()的toString()打印出来的是<code>[Object, Object]</code></p><p><br><br></p><h2 id="call-apply"><a href="#call-apply" class="headerlink" title="call/apply"></a>call/apply</h2><p>作用： 都能改变<code>this</code>指向</p><p>区别： 后面传递的参数形式不同</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person(<span class="string">'lin'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="comment">// 这里直接调用Person函数就没把它当作构造函数new了，里面的this就指向全局window</span></span><br><span class="line"><span class="built_in">console</span>.log(name);</span><br><span class="line"><span class="built_in">console</span>.log(age);</span><br></pre></td></tr></table></figure><p>这里说一下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test()实际上是test.call()</span><br></pre></td></tr></table></figure><p>使用<code>call</code>改变this指向：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">Person.call(obj, <span class="string">'lin'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj);<span class="comment">//obj里面age为18，name为lin</span></span><br></pre></td></tr></table></figure><p>这里使用call将this的指向改变成了obj，或者说这里就把对象<code>obj</code>拿来取代了this，或者说this就成了obj。</p><p>来个应用栗子👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, sex, tel, grade</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">  <span class="keyword">this</span>.tel = tel;</span><br><span class="line">  <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> student = <span class="keyword">new</span> Student(<span class="string">'lin'</span>, <span class="number">18</span>, <span class="string">'male'</span>, <span class="number">137</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure><p>这样<strong>代码太冗余</strong>了，用call方法改进一下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sex = sex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, sex, tel, grade</span>) </span>&#123;</span><br><span class="line">  Person.call(<span class="keyword">this</span>, name, age, sex)</span><br><span class="line">    <span class="comment">//上面结束后实际上 就有一个 this = &#123;name:'lin',age:'18',sex:'male' &#125; </span></span><br><span class="line">  <span class="keyword">this</span>.tel = tel;</span><br><span class="line">  <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> student = <span class="keyword">new</span> Student(<span class="string">'lin'</span>, <span class="number">18</span>, <span class="string">'male'</span>, <span class="number">137</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure><p><br></p><p>call需要把实参按照形参的个数一个个传进去，</p><p>apply需要传入一个实参数组</p><p>再来个栗子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wheel</span>(<span class="params">WheelSize, style</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.WheelSize = WheelSize;</span><br><span class="line">  <span class="keyword">this</span>.style = style;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sit</span>(<span class="params">c, sitColor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.c = c;</span><br><span class="line">  <span class="keyword">this</span>.sitColor = sitColor</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Model</span>(<span class="params">height, width, len</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.height = height;</span><br><span class="line">  <span class="keyword">this</span>.width = width;</span><br><span class="line">  <span class="keyword">this</span>.len = len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">WheelSize, style, c, sitColor, height, width, len</span>) </span>&#123;</span><br><span class="line">  Wheel.apply(<span class="keyword">this</span>, [WheelSize, style]);</span><br><span class="line">  Sit.apply(<span class="keyword">this</span>, [c, sitColor]);</span><br><span class="line">  Model.apply(<span class="keyword">this</span>, [height, width, len])</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> myCar = <span class="keyword">new</span> Car(<span class="number">100</span>, <span class="string">'花里胡哨'</span>, <span class="string">'真皮'</span>, <span class="string">'red'</span>, <span class="number">1800</span>, <span class="number">1900</span>, <span class="number">4900</span>)</span><br><span class="line"><span class="built_in">console</span>.log(myCar);</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>继承发展史：</p><ol><li><p>原型链</p><p>缺点：过多的继承了没用的属性<br></p></li><li><p>借用构造函数+call/apply</p><p>我上面讲call/apply的两个栗子就是</p><p>缺点：无法继承借用来的构造函数的原型，而且不方便。<br></p></li><li><p>共有原型</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Father.prototype.lastName = <span class="string">"xi"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">Target, Origin</span>) </span>&#123;</span><br><span class="line">  Target.prototype = Origin.prototype;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">inherit(Son, Father);<span class="comment">//一定要先继承再定义哦</span></span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br></pre></td></tr></table></figure><p>这种做法有<strong>缺点</strong>，如果想要给Son对象的原型添加些属性，那么很不好的事，Father对象并不需要这些属性，因为要知道，它俩的原型指向的是同一个。<br></p></li><li><p>圣杯模式 </p><p>借用一个中间层。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">Target, Origin</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">  F.prototype = Origin.prototype;<span class="comment">//这行和下一行顺序一定不能调换，否则就错了</span></span><br><span class="line">  Target.prototype = <span class="keyword">new</span> F();  <span class="comment">//F作为中间层，这样就算Target会修改原型，也只是修改了F，影响不到Origin</span></span><br><span class="line">  Target.prototype.constructor = Target;  <span class="comment">//手动添加构造器constructor</span></span><br><span class="line">  Target.prototype.uber = Origin.prototype; <span class="comment">//记录真实的原型</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">Father.prototype = &#123;</span><br><span class="line">  lastName: <span class="string">'Lin'</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">inherit(Son, Father);</span><br><span class="line"><span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br><span class="line"><span class="keyword">var</span> father = <span class="keyword">new</span> Father();</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570887149405.png" alt="1570887149405"></p><p>上面这个继承还可以再优化一下，使用立即执行函数和闭包来优化：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">var</span> inherit = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">Target, Origin</span>) </span>&#123;</span><br><span class="line">       F.prototype = Origin.prototype;</span><br><span class="line">       Target.prototype = <span class="keyword">new</span> F();</span><br><span class="line">       Target.prototype.constructor = Target;</span><br><span class="line">       Target.prototype.uber = Origin.prototype;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;())<span class="comment">//整个是一个立即执行函数，即用即销毁，优化性能</span></span><br><span class="line"><span class="comment">//inherit里面的F通过闭包保存成了inherit的私有化属性，更加优化</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Father</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Son</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">   Father.prototype = &#123;</span><br><span class="line">     lastName: <span class="string">'lin'</span></span><br><span class="line">   &#125;</span><br><span class="line">   inherit(Son, Father)</span><br><span class="line">   <span class="keyword">var</span> father = <span class="keyword">new</span> Father();</span><br><span class="line">   <span class="keyword">var</span> son = <span class="keyword">new</span> Son();</span><br></pre></td></tr></table></figure></li></ol><p><br><br></p><h2 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h2><p>管理变量，防止污染全局，适用于模块化开发。</p><p>传统的方法是用对象包起来形成专有的命名空间，用的时候就通过xxx.xxxx.xxx这样的方式访问。</p><p>解决方式：使用<strong>立即执行函数和闭包</strong></p><p>栗子👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">var</span> init = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> name = <span class="string">'abc'</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">callName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(name);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       callName();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> _init = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> name = <span class="string">'def'</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">callName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(name);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       callName();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)()</span><br><span class="line">   </span><br><span class="line">   init();</span><br><span class="line">_init();</span><br></pre></td></tr></table></figure><p>上面这两个函数变量命名互不影响，因为都存在于立即执行函数里面，而变量被闭包保存return带出来。<strong>实现模块开发，防止污染全局变量</strong></p><p><br><br></p><h2 id="对象的遍历"><a href="#对象的遍历" class="headerlink" title="对象的遍历"></a>对象的遍历</h2><p>对象遍历不可能像遍历数组那样for循环，因为根本不知道对象的“长度”</p><p>所以要使用<code>for key in obj</code>的方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'lin'</span>,</span><br><span class="line">  age: <span class="number">12</span>,</span><br><span class="line">  sex: <span class="string">"male"</span>,</span><br><span class="line">  height: <span class="number">180</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj[key]);<span class="comment">//这里的每一个key本身都是String类型</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们知道<code>obj.xxx</code>和<code>obj[&#39;xxx&#39;]</code>都可以访问到对象属性，但是在<code>for key in obj</code>循环里必须十一用<code>obj[&#39;xxx&#39;]</code>的方式访问，<code>obj.xxx</code>输出的为undefined</p><p><code>obj.name</code>实际上本质会先转化为<code>obj[&#39;name&#39;]</code>，索引框里必须是字符串类型。</p><p>在上面代码中如果使用<code>obj.xxx</code>的方式的话：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'lin'</span>,</span><br><span class="line">  age: <span class="number">12</span>,</span><br><span class="line">  sex: <span class="string">"male"</span>,</span><br><span class="line">  height: <span class="number">180</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj.key);<span class="comment">//这里变成了obj['key'],可是obj中没有key这个键，所以undefined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><code>for key in obj</code>可以遍历出原型里的东西吗？答案是可以的（除了Object.prototype）。</p><p>但是我就只想遍历出目标对象自己的属性，怎么做？</p><p><strong>利用<code>hasOwnProperty(xxx)</code>方法来判断<code>xxx</code>是不是obj自身的属性。</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'lin'</span>,</span><br><span class="line">  age: <span class="number">12</span>,</span><br><span class="line">  sex: <span class="string">"male"</span>,</span><br><span class="line">  height: <span class="number">180</span>,</span><br><span class="line">  __proto__: &#123;</span><br><span class="line">    hobby: <span class="string">"guitar"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj[key]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><p>除了<code>hasOwnProperty()</code>可以判断是不是属性，<code>in</code>也可以。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'height'</span> <span class="keyword">in</span> obj);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hobby'</span> <span class="keyword">in</span> obj);<span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>⚠注意：<code>hasOwnProperty()</code>是判断是不是对象自己的非继承属性，<code>in</code>指判断是不是属性，不管是不是继承来的。</p><p><br></p><p>💡再来说说<code>instanceof</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A <span class="keyword">instanceof</span> B</span><br></pre></td></tr></table></figure><p>它的语法理解就是：</p><p>​    看A对象是不是B构造函数构造出来的</p><p>​    更深层次的理解是看A对象的原型链上有没有B的原型</p><p>应用：判断一个变量是数组还是对象？</p><p>方法一：看constructor</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570897037168.png" alt="1570897037168"></p><p>方法二：用instanceof</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570897168419.png" alt="1570897168419"></p><p>方法三：看toString()</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570897447379.png" alt="1570897447379"></p><p><br><br></p><h2 id="this"><a href="#this" class="headerlink" title="this"></a>this</h2><ul><li><p>函数预编译过程中  this—&gt;window</p></li><li><p>全局作用域里  this—&gt;window</p></li><li><p>call/apply可以改变函数运行时this的指向</p></li><li><p>obj.func();   func()里面的this指向obj；即谁调用this就指向谁</p></li></ul><p><br></p><p>这里补充一下预编译：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> a = <span class="number">123</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570903506616.png" alt="1570903506616"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> a = <span class="number">123</span>;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> test(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570903422900.png" alt="1570903422900"></p><p>例题👇：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"222"</span>;</span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  name: <span class="string">"111"</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fun = a.say;</span><br><span class="line">fun()</span><br><span class="line">a.say()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = &#123;</span><br><span class="line">  name: <span class="string">"333"</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params">fun</span>) </span>&#123;</span><br><span class="line">    fun()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">b.say(a.say);</span><br><span class="line">b.say = a.say;</span><br><span class="line">b.say();</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pr</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.foo = <span class="number">234</span>;<span class="comment">//this指向全局window</span></span><br><span class="line">  <span class="built_in">console</span>.log(foo);</span><br><span class="line">&#125;</span><br><span class="line">pr();</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pr</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.foo = <span class="number">234</span>;<span class="comment">//this指向Object.create(pr.prototype)</span></span><br><span class="line">  <span class="built_in">console</span>.log(foo);<span class="comment">//123</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.foo);<span class="comment">//234</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> pr();</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  a = <span class="number">0</span>;</span><br><span class="line">  alert(a);</span><br><span class="line">  alert(<span class="keyword">this</span>.a);</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  alert(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();<span class="comment">//0  5  0</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  a = <span class="number">0</span>;</span><br><span class="line">  alert(a);</span><br><span class="line">  alert(<span class="keyword">this</span>.a);</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  alert(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> test();<span class="comment">//0  undefined  0</span></span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="arguments-callee和function-caller"><a href="#arguments-callee和function-caller" class="headerlink" title="arguments.callee和function.caller"></a>arguments.callee和function.caller</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570931723015.png" alt="1570931723015"></p><p><strong>callee</strong> 是 <code>arguments</code> 对象的一个属性。它可以用于引用该函数的函数体内当前正在执行的函数。这在函数的名称是未知时很有用，例如在没有名称的函数表达式 (也称为“匿名函数”)内。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//求阶乘</span></span><br><span class="line">    <span class="keyword">var</span> num = (<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">arguments</span>.callee(n - <span class="number">1</span>) * n</span><br><span class="line">    &#125;)(<span class="number">100</span>)</span><br></pre></td></tr></table></figure><hr><p>来说说<strong>Function.caller</strong>。</p><p>如果一个函数<code>f</code>是在全局作用域内被调用的,则<code>f.caller为`</code>null<code>,相反,如果一个函数是在另外一个函数作用域内被调用的,则</code>f.caller指向调用它的那个函数.`</p><p>⚠该特性是非标准的，官方建议不要再生产环境中使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller);</span><br><span class="line">&#125;</span><br><span class="line">test1();</span><br><span class="line"><span class="comment">//执行结果为null</span></span><br></pre></td></tr></table></figure><p><br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  test2()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.callee.caller === test1);</span><br><span class="line">&#125;</span><br><span class="line">test1();</span><br><span class="line"><span class="comment">//执行打印结果为test1函数体和true</span></span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="浅克隆-深克隆"><a href="#浅克隆-深克隆" class="headerlink" title="浅克隆/深克隆"></a>浅克隆/深克隆</h2><p>【浅克隆】</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  name: <span class="string">'abc'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sex: <span class="string">'male'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">origin, target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = target || &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> origin) &#123;</span><br><span class="line">    target[key] = origin[key]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> newObj = clone(obj);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570935515334.png" alt="1570935515334"></p><p>浅克隆的原始值属性更改，另一个对象不受影响。但是引用值属性一改就全都改了。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/jsnote/1570936074035.png" alt="1570936074035"></p><p>为了避免这个问题就需要进行<strong>深度克隆</strong></p><p>思想：</p><ol><li>遍历对象  <code>for (var prop in origin)</code></li><li>判断是不是原始值 ，同时排除null。 <code>origin[prop] !== null &amp;&amp; typeof (origin[prop]) == &#39;object&#39;</code></li><li>判断是数组还是对象，利用<code>Object.prototype.toStringcall(origin[prop])</code>方法</li><li>建立相应的数组或对象</li><li>递归</li></ol><p><br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> person1 = &#123;</span><br><span class="line">  name: <span class="string">'zhang'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sex: <span class="string">'male'</span>,</span><br><span class="line">  say: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="number">666</span>); &#125;,</span><br><span class="line">  children: &#123;</span><br><span class="line">    first: &#123;</span><br><span class="line">      name: <span class="string">'zhang2'</span>,</span><br><span class="line">      age: <span class="number">11</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  car: [<span class="string">'Benz'</span>, <span class="string">'Mazda'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = deepClone(person1);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">origin, target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = target || &#123;&#125;,</span><br><span class="line">    toStr = <span class="built_in">Object</span>.prototype.toString,</span><br><span class="line">    arrStr = <span class="string">"[object Array]"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> origin) &#123;</span><br><span class="line">    <span class="keyword">if</span> (origin.hasOwnProperty(prop)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (origin[prop] !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> (origin[prop]) == <span class="string">'object'</span>) &#123;</span><br><span class="line">        target[prop] = toStr.call(origin[prop]) == arrStr ? [] : &#123;&#125;;</span><br><span class="line">        deepClone(origin[prop], target[prop]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        target[prop] = origin[prop];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>💡另外还可以使用 JSON 来实现深度克隆：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="built_in">JSON</span>.stringify(person1);</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="built_in">JSON</span>.parse(str);</span><br></pre></td></tr></table></figure><p>但是json克隆无法克隆方法</p><p>haikyi</p><p><br></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vue页面间通信传值的方法</title>
      <link href="/2019/10/17/Vue%E9%A1%B5%E9%9D%A2%E9%97%B4%E9%80%9A%E4%BF%A1%E4%BC%A0%E5%80%BC%E7%9A%84%E6%96%B9%E6%B3%95.html"/>
      <url>/2019/10/17/Vue%E9%A1%B5%E9%9D%A2%E9%97%B4%E9%80%9A%E4%BF%A1%E4%BC%A0%E5%80%BC%E7%9A%84%E6%96%B9%E6%B3%95.html</url>
      
        <content type="html"><![CDATA[<h2 id="页面跳转与传值"><a href="#页面跳转与传值" class="headerlink" title="页面跳转与传值"></a>页面跳转与传值</h2><h3 id="一、使用router-link"><a href="#一、使用router-link" class="headerlink" title="一、使用router-link"></a>一、使用router-link</h3><p>routes路由：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/'</span>,</span><br><span class="line">        name: <span class="string">'Index'</span>,</span><br><span class="line">        component: Index</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/deitail'</span>,</span><br><span class="line">        name: <span class="string">'deitail'</span>,</span><br><span class="line">        component: deitail</span><br><span class="line">      &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用<code>&lt;router-link&gt;</code>进行跳转和传值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link :to=&quot;&#123;name:&apos;deitail&apos;,params:&#123;freezeMon:&apos;2017-10&apos;,owerName:&apos;西安&apos;&#125;&#125;&quot; tag=&quot;div&quot; &gt;</span><br><span class="line">&lt;/router-link&gt;</span><br></pre></td></tr></table></figure><p>取值时：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;$route.params.freezeMon&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>小结：router-link跳转传值要注意的地方</p><ul><li>to前面要加 <code>:</code></li><li>to后面{中的name值要与路由中的name值一致</li></ul><h3 id="二、使用-router-push"><a href="#二、使用-router-push" class="headerlink" title="二、使用$router.push()"></a>二、使用$router.push()</h3><h4 id="query写法"><a href="#query写法" class="headerlink" title="query写法"></a>query写法</h4><p><strong>传值的路由</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">"/login?uname="</span> + <span class="keyword">this</span>.userName</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>传值路由第二种写法</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">"/login"</span>,</span><br><span class="line">  query: &#123;</span><br><span class="line">    uname: <span class="keyword">this</span>.userName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>接收值的路由</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"接收过来的值为："</span> + <span class="keyword">this</span>.$route.query.uname);        <span class="comment">//这里是$route 没有r----</span></span><br></pre></td></tr></table></figure><p><br></p><h4 id="params写法"><a href="#params写法" class="headerlink" title="params写法"></a>params写法</h4><p><strong>传值路由第一种写法（还是会将参数显示在地址栏中）</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  path: <span class="string">"/login/"</span> + <span class="keyword">this</span>.userName</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>传值路由的第二种写法（不会将参数显示在地址栏中）</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">  name: <span class="string">"login"</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    uname: <span class="keyword">this</span>.userName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>接收值的路由</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"接收过来的值为："</span> + <span class="keyword">this</span>.$route.params.uname);</span><br></pre></td></tr></table></figure><p>注意：在使用params传递参数的时候，我们需要在router的对象里面，找到当前的这个路由，然后去更改它的 path</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   path: <span class="string">"/login/:uname"</span>, <span class="comment">//代表当前url跳转的路径</span></span><br><span class="line">   component: login, <span class="comment">//代表在当前这个路径下面，我们如何显示组件（显示那一个组件）</span></span><br><span class="line">   name: <span class="string">"login"</span> <span class="comment">//给当前路由取一个别名</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>上面的path后面是 /login/:uname ,这一个是我们的一个路径变量，前面的login代表路由，而后面<code>:uname</code>代表的是变量</p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>防抖节流</title>
      <link href="/2019/10/15/%E9%98%B2%E6%8A%96%E8%8A%82%E6%B5%81.html"/>
      <url>/2019/10/15/%E9%98%B2%E6%8A%96%E8%8A%82%E6%B5%81.html</url>
      
        <content type="html"><![CDATA[<h2 id="背景问题"><a href="#背景问题" class="headerlink" title="背景问题"></a>背景问题</h2><p>在前端开发中有一部分的用户行为会频繁的触发事件，从而频繁地执行函数，而对于DOM操作、资源加载等耗费性能的处理，很可能导致界面卡顿，甚至浏览器崩溃（本质是因为js是单线程的）。</p><p>函数节流（throttle）和函数防抖（debounce）可以解决问题。</p><h2 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h2><p>函数防抖就是在函数需要频繁触发情况时，只有等足够空闲的事件，才执行，为了避免又有事件触发。</p><ul><li>常见应用场景：搜索框实时搜索请求数据、拖拽</li></ul><ul><li>代码实现：</li></ul><p>关键点：设置定时器、this的指向、arguments的指向 </p><p>模拟搜索框实时请求数据👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oInp = <span class="built_in">document</span>.getElementById(<span class="string">'inp'</span>);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">oInp.oninput = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// console.log(arguments);</span></span><br><span class="line">  <span class="keyword">var</span> _self = <span class="keyword">this</span>;<span class="comment">//想要的是输入框input的数据，若无此步，setTimeout的this指向window</span></span><br><span class="line">  <span class="keyword">var</span> _arg = <span class="built_in">arguments</span>;</span><br><span class="line">  clearTimeout(timer);</span><br><span class="line">  timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    ajax.apply(_self, _arg)<span class="comment">//改变this指向，让输入框元素实际调用这个函数</span></span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e, <span class="keyword">this</span>.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的代码只能应对发送ajax这种业务，下面进行一下防抖的封装</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oInp = <span class="built_in">document</span>.getElementById(<span class="string">'inp'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e, <span class="keyword">this</span>.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">handler, delay</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handler  要进行防抖处理的功能性函数</span></span><br><span class="line">  <span class="comment">// delay    延迟时间</span></span><br><span class="line">  <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> _arg = <span class="built_in">arguments</span>;</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      handler.apply(_self, _arg)</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">oInp.oninput = debounce(ajax, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure><h2 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h2><p>函数节流就是预定一个函数只有在大于或等于执行周期时才执行，周期内调用不执行。</p><ul><li>常见应用场景<ul><li>窗口调整</li><li>页面滚动数据加载</li><li>防止恶意脚本抢购疯狂点击</li></ul></li></ul><ul><li><p>代码实现</p><p>模拟抢红包的功能👇</p><p><img src="/2019/10/15/防抖节流.htm/Users\Administrator\AppData\Roaming\Typora\typora-user-images\1571146823113.png" alt="1571146823113"></p><p>这种代码如果被人注入恶意脚本，使得按钮点击事件疯狂触发，服务器和客户端都受不了。为了避免这种情况，使用节流操作。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">我抢到<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"show"</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>个红包！</span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="keyword">var</span> oSpan = <span class="built_in">document</span>.getElementById(<span class="string">'show'</span>);</span><br><span class="line"><span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span><br><span class="line">  </span><br><span class="line"><span class="comment">// oBtn.onclick = function () &#123;</span></span><br><span class="line"><span class="comment">//   oSpan.innerText = parseInt(oSpan.innerText) + 1;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">oBtn.onclick = throttle(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  oSpan.innerText = <span class="built_in">parseInt</span>(oSpan.innerText) + <span class="number">1</span>;</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">handler, wait</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> lastTime = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">    <span class="keyword">if</span> (nowTime - lastTime &gt; wait) &#123;</span><br><span class="line">      handler();</span><br><span class="line">      lastTime = nowTime;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再改进一下👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oSpan = <span class="built_in">document</span>.getElementById(<span class="string">'show'</span>);</span><br><span class="line"><span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>);</span><br><span class="line">  </span><br><span class="line">oBtn.onclick = throttle(crazyClick, <span class="number">1000</span>)</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">handler, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> lastTime = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">        <span class="keyword">if</span> (nowTime - lastTime &gt; wait) &#123;</span><br><span class="line">            handler.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">            lastTime = nowTime;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">crazyClick</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>, e);</span><br><span class="line">    oSpan.innerText = <span class="built_in">parseInt</span>(oSpan.innerText) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><br></p><p>假设无限次触发：防抖函数永远不会真正执行；节流函数则会按照间隔时间执行。</p><p>防抖动和节流本质是不一样的。防抖动是将多次执行变为最后一次执行，节流是将多次执行变成每隔一段时间执行。</p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis</title>
      <link href="/2019/10/08/Redis.html"/>
      <url>/2019/10/08/Redis.html</url>
      
        <content type="html"><![CDATA[<h2 id="缓存背景"><a href="#缓存背景" class="headerlink" title="缓存背景"></a>缓存背景</h2><p>由于数据库是建立在硬盘上的，当有大量数据读写数据库时，而硬盘的读写速度慢，导致数据库性能有瓶颈，数据吞吐不够。</p><p>因此在客户端和数据库之前间，加一个<strong>缓存</strong>，而这个缓存是用内存做的，<strong>内存的读写速度非常快</strong>。 当要对数据库进行读写时，先访问中间层的缓存，读数据时先看缓存中有无想要的数据，若有直接从缓存拿，若无则再去访问数据库；写数据时，先写进缓存，之后缓存再慢慢同步到数据库。这样就帮数据库有效地拦截了一些频繁的读写操作。</p><p><img src="https://pic4.zhimg.com/v2-ae215207d175303dd4e37b37b61a7d33_r.jpg" alt=""></p><p>【什么样的数据存入缓存】缓存中存的应是读写数据库非常频繁的数据。</p><p>【防止缓存穿透】缓存穿透是指查询一个一定不存在的数据，由于缓存是不命中时被动写的，并且出于容错考虑，如果从存储层查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到存储层去查询，失去了缓存的意义。在流量大时，可能DB就挂掉了，要是有人利用不存在的key频繁攻击我们的应用，这就是漏洞。这需要一些算法去识别，比如布隆算法。参考文章👉<a href="https://blog.csdn.net/zeb_perfect/article/details/54135506" target="_blank" rel="noopener">点击</a></p><p><br></p><p>缓存这一层就用<strong>Redis</strong>来做。Redis既使用内存，也使用硬盘。作为读写操作的时候是用内存的，但是内存存数据是暂时的，机器一关内存里的东西就没了，所以需要用到硬盘来做缓存备份。内存与硬盘之间是同步数据和恢复数据的关系。</p><p>Redis是用C语言写的，Redis支持多种数据结构，key-value、key-map、key-set、key-list等等。比较常用的就是key-value，key一般是字符串，value可以是数字也可以是字符串。但是C语言中是没有字符串的。而Redis中的字符串长度是可变的，是用了SDS结构（Simple Dynamic String）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sdshdr</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录 buf 数组中已使用字节的数量</span></span><br><span class="line">    <span class="comment">// 等于 SDS 所保存字符串的长度</span></span><br><span class="line">    <span class="keyword">int</span> len;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录 buf 数组中未使用字节的数量</span></span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">free</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 字节数组，用于保存字符串</span></span><br><span class="line">    <span class="keyword">char</span> buf[];</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>当字符串变长时，先看sds结构内free还有没有足够的空间，没有的话就要重新创建一个更大的字节数组用以存储变长后的字符串。</p><p>关于更多Redis源码的知识这里就不说了，因为我只懂一点皮毛。</p><p><br></p><h2 id="Windows使用Redis"><a href="#Windows使用Redis" class="headerlink" title="Windows使用Redis"></a>Windows使用Redis</h2><p>Redis是微软开源的一个存储数据库。可以在GitHub上下载👉<a href="https://github.com/microsoftarchive/redis/releases" target="_blank" rel="noopener">https://github.com/microsoftarchive/redis/releases</a></p><p>注意window系统中只有64位的系统才能使用Redis。</p><p><img src="https://pic2.zhimg.com/v2-754e178d110a14222ca88e9d52ee724d_r.jpg" alt=""></p><p>下载后点击，不需要配置什么，按提示安装就行了。安装后要配置一些配置文件。</p><p><br></p><p><strong>设置链接密码，修改redis.windows-service.conf</strong></p><p>​    <img src="https://pic4.zhimg.com/v2-3d74b5d6edf13cb03fca1b642b1abc6b_r.jpg" alt=""></p><p><br></p><p><strong>查看是否允许本地访问</strong>，有的版本是允许的，如下所示</p><p><img src="https://pic3.zhimg.com/v2-f62414b17a45477d65578f64858c555e_r.jpg" alt=""></p><p><br></p><p>配置修改后需要重启Redis，打开系统的”服务“，找到Redis重启即可。</p><p><br></p><p>双击redis-cli.exe启动。</p><p>输入<code>auth 123456</code>连接Redis。通过<code>set</code>键值对来写入数据，通过<code>get</code>键来获取数据。</p><p><img src="https://pic4.zhimg.com/80/v2-c2683c7ddec97d9396f726cfbe89c9bb_hd.jpg" alt=""></p><h2 id="CentOS使用Redis"><a href="#CentOS使用Redis" class="headerlink" title="CentOS使用Redis"></a>CentOS使用Redis</h2><p>使用安装包下载👇</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-4.0.2.tar.gz</span><br></pre></td></tr></table></figure><p>解压</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar xzf redis-4.0.2.tar.gz</span><br></pre></td></tr></table></figure><p>下载gcc依赖环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc</span><br></pre></td></tr></table></figure><p>执行下面的命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make MOLLOC=libc</span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>之后再<code>/usr/local/bin</code>目录下就多了Redis的可执行文件</p><p><img src="https://pic3.zhimg.com/v2-8dda927023de977c96fdf8b25f4b581e_r.jpg" alt=""></p><p>执行命令👇</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-sever &amp;</span><br></pre></td></tr></table></figure><p>这样它就可以在后台运行了。</p><p>执行<code>ps aux grep|&quot;redis&quot;</code>查看到redis的进程正在执行。</p><p>如果要关闭Redis，就杀了它的进程。</p><p><img src="https://pic1.zhimg.com/v2-dff48949afd760407a8abce57ff851ec_r.jpg" alt=""></p><p><br></p><h2 id="node操作Redis"><a href="#node操作Redis" class="headerlink" title="node操作Redis"></a>node操作Redis</h2><p>需要<code>npm install redis --save</code>安装redis模块。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> redis = <span class="built_in">require</span>(<span class="string">'redis'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> port = <span class="number">6379</span>;</span><br><span class="line"><span class="keyword">var</span> host = <span class="string">"127.0.0.1"</span>;</span><br><span class="line"><span class="keyword">var</span> password = <span class="string">"123456"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> client = redis.createClient(port, host);</span><br><span class="line">client.auth(password, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"OK，redis连接成功"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getKey</span>(<span class="params">key, callback</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    client.on(<span class="string">"connect"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.get(key, callback);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setKey</span>(<span class="params">key, value, callback</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.set(key, value, callback);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">error, reply</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reply);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">setKey(<span class="string">'iii'</span>, <span class="string">'III'</span>, callback);</span><br><span class="line">getKey(<span class="string">'iii'</span>, callback);</span><br></pre></td></tr></table></figure><p><br></p><p>之前说过redis除了key-value的数据结构，还可以存哈希结构的数据。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sethash</span>(<span class="params">hash, key, value, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hset(hash, key, value, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gethash</span>(<span class="params">hash, key, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hget(hash, key, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getallhash</span>(<span class="params">hash, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hgetall(hash, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hmset</span>(<span class="params">hash, params, callback</span>) </span>&#123;</span><br><span class="line">    client.on(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        client.hmset(hash, ...params, callback)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">error, reply</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reply);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sethash(<span class="string">'map1'</span>, <span class="string">'key1'</span>, <span class="string">'value1'</span>, callback)</span><br><span class="line">sethash(<span class="string">'map1'</span>, <span class="string">'key2'</span>, <span class="string">'value2'</span>, callback)</span><br><span class="line">hmset(<span class="string">'set1'</span>, [<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">12</span>], callback)</span><br><span class="line">gethash(<span class="string">'map1'</span>, <span class="string">'key1'</span>, callback)</span><br><span class="line">getallhash(<span class="string">'map1'</span>, callback)</span><br><span class="line">getallhash(<span class="string">'set1'</span>, callback)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mongoDB</title>
      <link href="/2019/10/05/mongoDB.html"/>
      <url>/2019/10/05/mongoDB.html</url>
      
        <content type="html"><![CDATA[<h2 id="Windows安装"><a href="#Windows安装" class="headerlink" title="Windows安装"></a>Windows安装</h2><p>下载地址：<a href="https://www.mongodb.com/download-center/community" target="_blank" rel="noopener">https://www.mongodb.com/download-center/community</a></p><p>运行mongo.exe</p><p>输入<code>show dbs</code>显示数据库。</p><p><img src="https://pic2.zhimg.com/80/v2-f16be839b9b3f541f4de299d92ae0b75_hd.jpg" alt=""></p><p><br></p><h2 id="CentOS安装"><a href="#CentOS安装" class="headerlink" title="CentOS安装"></a>CentOS安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.4.9.tgz</span><br></pre></td></tr></table></figure><p>执行该命令下载安装报包。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf mongodb-linux-x86_64-2.4.9.tgz</span><br></pre></td></tr></table></figure><p>解压之后移动到/usr/local中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ./mongodb-linux-x86_64-2.4.9.tgz /usr/local/mongodb</span><br></pre></td></tr></table></figure><p>数据库存放到/home目录下，在/home目录下新建两个文件夹并创建mongodb.log</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir mongodb  /home/mongodb 即为数据库路径</span><br><span class="line">mkdir mongodblog  /home/mongodblog  日志路径</span><br><span class="line">cd /home/mongodblog</span><br><span class="line">touch mongodb.log</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mongodb/bin</span><br><span class="line">ll</span><br><span class="line">可以看到有一个可执行文件mongod</span><br></pre></td></tr></table></figure><p>回到mongodb的根路径下执行👇</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/mongod --dbpath /home/mongodb/ --logpath /home/mongolog/mongodb.log --fork --port 27017</span><br></pre></td></tr></table></figure><p><code>--fork</code>使得mongodb在后台执行。</p><p>查看是否成功启动：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux |grep &quot;mongo&quot;</span><br></pre></td></tr></table></figure><p><br></p><h2 id="mongodb基本指令"><a href="#mongodb基本指令" class="headerlink" title="mongodb基本指令"></a>mongodb基本指令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">查看数据库：</span><br><span class="line">show dbs</span><br><span class="line"></span><br><span class="line">使用数据库, （use 数据库名）如果这给数据库不存在，则创建之：</span><br><span class="line">use &lt;database&gt;</span><br><span class="line"></span><br><span class="line">查看当前数据库名：</span><br><span class="line">db.getName()</span><br><span class="line"></span><br><span class="line">mongodb没有mysql表的概念，但是有集合collection</span><br><span class="line">查看collection：</span><br><span class="line">show collections</span><br><span class="line"></span><br><span class="line">创建collection：</span><br><span class="line">db.createCollection(&apos;集合名称&apos;)</span><br><span class="line"></span><br><span class="line">集合中增加数据：</span><br><span class="line">db.collection1.save(&#123;name:&apos;tony&apos;,age:18&#125;);</span><br><span class="line"></span><br><span class="line">查询集合中所有数据：</span><br><span class="line">db.collection1.find()</span><br><span class="line"></span><br><span class="line">查询集合中有几条数据：</span><br><span class="line">db.collection1.find().count()</span><br><span class="line"></span><br><span class="line">条件查询:</span><br><span class="line">db.collection1.find(&#123;age:18&#125;)//age为18的数据</span><br><span class="line">db.collection1.find(&#123;age:&#123;$gt:18&#125;&#125;)//age大于18</span><br><span class="line">db.collection1.find(&#123;age:&#123;$lt:18&#125;&#125;)//age小于18</span><br><span class="line">db.collection1.find(&#123;age:&#123;$gte:18&#125;&#125;)//age大于等于18</span><br><span class="line">db.collection1.find(&#123;age:&#123;$lte:18&#125;&#125;)//age小于等于18</span><br><span class="line"></span><br><span class="line">名字去重</span><br><span class="line">db.collection1.distinct(&quot;name&quot;)</span><br><span class="line"> </span><br><span class="line">多重条件查询</span><br><span class="line">and：</span><br><span class="line">db.collection1.find(&#123;$and:[&#123;age:18&#125;,&#123;name:&apos;tony&apos;&#125;]&#125;)  //要特别注意这种写法</span><br><span class="line">or:   </span><br><span class="line">db.collection1.find(&#123;$or:[&#123;age:18&#125;,&#123;name:&apos;tony&apos;&#125;]&#125;)</span><br><span class="line"></span><br><span class="line">查询age大于12小于19：</span><br><span class="line">db.collection1.find(&#123;age:&#123;$gt:12, $lt:19&#125;&#125;)</span><br><span class="line"></span><br><span class="line">查询前两条数据：</span><br><span class="line">db.collection1.find().limit(2)</span><br><span class="line"></span><br><span class="line">跳过前两条然后只查看两条：</span><br><span class="line">db.collection1.find().skip(2).limit(2)</span><br><span class="line"></span><br><span class="line">删除age为12的数据：</span><br><span class="line">db.collection1.remove(&#123;age:12&#125;)</span><br><span class="line"></span><br><span class="line">修改：</span><br><span class="line">db.collection1.update(&#123;name:&apos;tony&apos;&#125;,&#123;$set:&#123;age:80&#125;&#125;, false ,true)</span><br></pre></td></tr></table></figure><p>更多操作Google一下。</p><p><br></p><h2 id="node操作mongodb"><a href="#node操作mongodb" class="headerlink" title="node操作mongodb"></a>node操作mongodb</h2><p>先安装mongodb依赖</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongodb --save</span><br></pre></td></tr></table></figure><p>先保证开启了mongodb，最基本的连接👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongo = <span class="built_in">require</span>(<span class="string">'mongodb'</span>).MongoClient;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">"mongodb://127.0.0.1:27017/test"</span>;  <span class="comment">//本地ip地址、端口号和数据库名称</span></span><br><span class="line"></span><br><span class="line">mongo.connect(url, <span class="function"><span class="keyword">function</span> (<span class="params">error, db</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(db);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">    db.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><br></p><p>进行【增删改查】代码操作👇</p><p>未完待续。。。。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> mongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>聊天机器人</title>
      <link href="/2019/10/05/%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA.html"/>
      <url>/2019/10/05/%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA.html</url>
      
        <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>这个Demo用node.js实现代理服务器，核心的api是<a href="http://www.turingapi.com/" target="_blank" rel="noopener">图灵机器人</a>，浏览器使用这个api存在跨域问题，所以用<strong>node.js代理服务器解决跨域问题</strong>。</p><p><br></p><h2 id="关于后端解决跨域"><a href="#关于后端解决跨域" class="headerlink" title="关于后端解决跨域"></a>关于后端解决跨域</h2><p><img src="https://pic3.zhimg.com/v2-1c347617d163242e7def6c157e82fc76_r.jpg" alt=""></p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://github.com/Dunteng/node.js/tree/v1/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA" target="_blank" rel="noopener">https://github.com/Dunteng/node.js/tree/v1/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA</a></p><h2 id="未完待续。。。"><a href="#未完待续。。。" class="headerlink" title="未完待续。。。"></a>未完待续。。。</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 项目 </tag>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用express搭建静态文件服务器</title>
      <link href="/2019/10/02/express%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8.html"/>
      <url>/2019/10/02/express%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8.html</url>
      
        <content type="html"><![CDATA[<h2 id="搭建静态文件服务器"><a href="#搭建静态文件服务器" class="headerlink" title="搭建静态文件服务器"></a>搭建静态文件服务器</h2><p>之前用过原生的node.js来写服务器👉（<a href="https://dunteng.github.io/[object%20Object]2019/09/30/net%E6%A8%A1%E5%9D%97%E5%86%99%E5%BE%AE%E5%9E%8Bnode%E6%9C%8D%E5%8A%A1%E5%99%A8.html">net服务器</a>，<a href="https://dunteng.github.io/[object%20Object]2019/10/01/%E4%BD%BF%E7%94%A8http%E6%A8%A1%E5%9D%97%E9%87%8D%E6%9E%84%E5%BE%AE%E5%9E%8B%E6%9C%8D%E5%8A%A1%E5%99%A8.html">http服务器</a>）</p><p>今天用express，比起<strong>原生node.js</strong>来太简单了！</p><p>先<code>npm init</code>初始化项目文件夹，运行<code>npm install express --save</code>安装express.</p><p>index.js服务器启动文件👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> express();<span class="comment">//创建express实例</span></span><br><span class="line"></span><br><span class="line">app.use(express.static(<span class="string">"page"</span>));</span><br><span class="line">app.listen(<span class="number">12306</span>);</span><br></pre></td></tr></table></figure><p>项目架构如下👇</p><p><img src="https://pic2.zhimg.com/v2-30bad54d291afaa93d00b03e257fb535_r.jpg" alt=""></p><p>运行<code>node index.js</code>，然后在浏览器中访问<a href="http://127.0.0.1:12306/index.html" target="_blank" rel="noopener">http://127.0.0.1:12306/index.html</a>和<a href="http://127.0.0.1:12306/test.html" target="_blank" rel="noopener">http://127.0.0.1:12306/test.html</a>就直接显示出相应的页面了。<strong>太他妈方便了！</strong></p><p><br></p><p>写一下配置文件和对应的处理文件稍微规范化一点👇</p><p><img src="https://pic3.zhimg.com/v2-6380ca214c7bf0c61be476f8cc1fbf0a_r.jpg" alt=""></p><p>📌<strong>config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> globalConfig = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> conf = fs.readFileSync(<span class="string">'./server.conf'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> configArr = conf.toString().split(<span class="string">"\r\n"</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; configArr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> itemArr = configArr[i].replace(<span class="regexp">/\s+/g</span>, <span class="string">""</span>).split(<span class="string">'='</span>);</span><br><span class="line">    globalConfig[itemArr[<span class="number">0</span>]] = itemArr[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(globalConfig);</span><br><span class="line"><span class="built_in">module</span>.exports = globalConfig;</span><br></pre></td></tr></table></figure><p><br><br></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MySQL基本的增删改查操作</title>
      <link href="/2019/10/01/MySQL%E5%9F%BA%E6%9C%AC%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%93%8D%E4%BD%9C.html"/>
      <url>/2019/10/01/MySQL%E5%9F%BA%E6%9C%AC%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%93%8D%E4%BD%9C.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://pic1.zhimg.com/v2-8dc902e921dfc2f2d189f2940dbbc3a7_1200x500.jpg" alt=""></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//增</span></span><br><span class="line">insert into student(name, age, stu_num, <span class="class"><span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">value</span> ('卡卡西',28,6600,1)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//改</span></span><br><span class="line">update student set name=<span class="string">'鸣人'</span> where id = <span class="number">1</span>;</span><br><span class="line">update student set name = <span class="string">'佐助'</span>, age=<span class="number">18</span>, stu_num=<span class="number">6631</span>, <span class="class"><span class="keyword">class</span></span>=<span class="number">1</span> where id = <span class="number">2</span>;</span><br><span class="line">update student</span><br><span class="line">set  id = <span class="number">3</span>, age=<span class="number">18</span>, stu_num=<span class="number">6632</span>, <span class="class"><span class="keyword">class</span></span>=<span class="number">1</span></span><br><span class="line">where name=<span class="string">'小樱'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查</span></span><br><span class="line">select * <span class="keyword">from</span> student;  <span class="comment">/*查询表中所有人*/</span></span><br><span class="line"></span><br><span class="line">select  name,age <span class="keyword">from</span> student;  <span class="comment">/*查询表中所有人的名字和年龄*/</span></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> student where age = <span class="number">18</span>; <span class="comment">/*查询年龄为18的所有人*/</span></span><br><span class="line"></span><br><span class="line">select count(<span class="number">1</span>) <span class="keyword">from</span> student; <span class="comment">/*查询表中所有记录条数（在这里就是表中所有人总数）*/</span></span><br><span class="line"></span><br><span class="line">select count(<span class="number">1</span>) <span class="keyword">from</span> student where age=<span class="number">18</span>; <span class="comment">/*查询表中年龄为18的人数*/</span></span><br><span class="line"></span><br><span class="line">select sum(age) <span class="keyword">from</span> student; <span class="comment">/* 所有人的年龄加起来的总数*/</span></span><br><span class="line"></span><br><span class="line">select avg(age) <span class="keyword">from</span> student;<span class="comment">/*求所有人的平均年龄*/</span></span><br><span class="line"></span><br><span class="line">select  avg(age) <span class="keyword">as</span> avg_age <span class="keyword">from</span> student; <span class="comment">/*给平均数设置别名*/</span></span><br><span class="line"></span><br><span class="line">select <span class="class"><span class="keyword">class</span>, <span class="title">count</span>(1) <span class="title">from</span> <span class="title">student</span> <span class="title">group</span> <span class="title">by</span> <span class="title">class</span></span>; <span class="comment">/*查询每班各有多少人，使用了group by进行分组*/</span></span><br><span class="line"></span><br><span class="line">select name, <span class="class"><span class="keyword">class</span> <span class="title">from</span> <span class="title">student</span> <span class="title">where</span> <span class="title">age</span>!</span>=<span class="number">18</span> and <span class="class"><span class="keyword">class</span></span>=<span class="number">3</span>; <span class="comment">/* 多个条件使用and */</span></span><br><span class="line">select name, <span class="class"><span class="keyword">class</span> <span class="title">from</span> <span class="title">student</span> <span class="title">where</span> <span class="title">age</span></span>=<span class="number">18</span> or stu_num&gt;<span class="number">6640</span>; <span class="comment">/* 或操作使用or */</span></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> student limit <span class="number">2</span>; <span class="comment">/* 只取前两条记录*/</span></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> student limit <span class="number">5</span>,<span class="number">3</span>; <span class="comment">/* 前5条记录不看，从第6条记录看起，取出3条记录*/</span></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> student order by id; <span class="comment">/* 以id进行正序排列 */</span></span><br><span class="line">select * <span class="keyword">from</span> student order by id desc ; <span class="comment">/* 倒序排列 */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//删</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> student;  <span class="comment">/*删除整个表。危险！！！*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> student where name=<span class="string">'卡卡西'</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用http模块重构微型服务器</title>
      <link href="/2019/10/01/%E4%BD%BF%E7%94%A8http%E6%A8%A1%E5%9D%97%E9%87%8D%E6%9E%84%E5%BE%AE%E5%9E%8B%E6%9C%8D%E5%8A%A1%E5%99%A8.html"/>
      <url>/2019/10/01/%E4%BD%BF%E7%94%A8http%E6%A8%A1%E5%9D%97%E9%87%8D%E6%9E%84%E5%BE%AE%E5%9E%8B%E6%9C%8D%E5%8A%A1%E5%99%A8.html</url>
      
        <content type="html"><![CDATA[<p>之前写过一个用net模块构建的微型服务器，👉<a href="https://dunteng.github.io/[object%20Object]2019/09/30/%E5%86%99%E4%B8%80%E4%B8%AA%E5%BE%AE%E5%9E%8Bnode%E6%9C%8D%E5%8A%A1%E5%99%A8.html">链接</a></p><p>现在用http模块来重构一下。👉<a href="https://github.com/Dunteng/node.js/tree/master/http%E9%87%8D%E6%9E%84%E5%BE%AE%E5%9E%8B%E6%9C%8D%E5%8A%A1%E5%99%A8" target="_blank" rel="noopener">GitHub仓库</a></p><h2 id="http模块的初步使用"><a href="#http模块的初步使用" class="headerlink" title="http模块的初步使用"></a>http模块的初步使用</h2><p><strong>配置文件server.conf，用以配置服务器信息</strong>👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">port=<span class="number">12306</span></span><br><span class="line">page_path=page</span><br><span class="line">static_file_type=.html|.js|.css|.jpg|.png|.gif|.ico|.json</span><br></pre></td></tr></table></figure><p>其中的静态资源信息用以后面判断请求是静态资源还是动态资源。</p><p>静态资源主要就是一些写好固定的文件，比如写好的html文件、图片、css、js等，</p><p>动态资源就涉及到了可能会与业务逻辑处理有关，需要ajax处理或者涉及数据库，动态生成的数据。</p><p>这里我们暂且简化概念，把后缀名为<code>.html|.js|.css|.jpg|.png|.gif|.ico|.json</code>的路径请求视为静态数据，其余的视为动态。具体由不同的操作，下文会处理。</p><p><br></p><p><strong>配置文件处理config.js，用以处理配置文件信息</strong>👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> conf = fs.readFileSync(<span class="string">'./server.conf'</span>);</span><br><span class="line"><span class="comment">// console.log(typeof conf);//这哥们是个对象</span></span><br><span class="line"><span class="keyword">var</span> confArr = conf.toString().split(<span class="string">'\n'</span>);<span class="comment">//将conf字符串化后根据换行符分割成数组</span></span><br><span class="line"><span class="comment">// console.log(confArr);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> globalConfig = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> i <span class="keyword">in</span> confArr) &#123;</span><br><span class="line">    <span class="keyword">var</span> itemArr = confArr[i].replace(<span class="regexp">/\s+/g</span>, <span class="string">""</span>).split(<span class="string">'='</span>);<span class="comment">//去掉所有空格并用'='拆分</span></span><br><span class="line">    <span class="comment">// console.log(itemArr);</span></span><br><span class="line">    globalConfig[itemArr[<span class="number">0</span>]] = itemArr[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (globalConfig.static_file_type) &#123;</span><br><span class="line">    globalConfig.static_file_type = globalConfig.static_file_type.split(<span class="string">"|"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"配置文件异常，缺少:static_file_type"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// console.log(globalConfig);</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = globalConfig;</span><br></pre></td></tr></table></figure><p>处理完配置文件后导出，长这个样子👇</p><p><img src="https://pic4.zhimg.com/v2-87d153cd7dc81bf29e2c1ccc5145f72b_r.jpg" alt=""></p><p><br></p><p><strong>duntengServer.js 服务器端文件</strong>👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> globalConfig = <span class="built_in">require</span>(<span class="string">'./config'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'新的连接已建立'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(request.url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> urlObj = url.parse(request.url);</span><br><span class="line">    <span class="keyword">var</span> pathName = url.parse(request.url).pathname;</span><br><span class="line">    <span class="keyword">var</span> params = url.parse(request.url).query;</span><br><span class="line">    <span class="keyword">var</span> paramsObj = url.parse(request.url, <span class="literal">true</span>).query;</span><br><span class="line">    <span class="built_in">console</span>.log(urlObj);</span><br><span class="line">    <span class="built_in">console</span>.log(pathName);</span><br><span class="line">    <span class="built_in">console</span>.log(params);</span><br><span class="line">    <span class="built_in">console</span>.log(paramsObj);</span><br><span class="line">&#125;).listen(globalConfig.port);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(globalConfig);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是静态数据请求还是动态数据请求</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isStaticsRequest</span>(<span class="params">pathName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; globalConfig.static_file_type.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> temp = globalConfig.static_file_type[i];</span><br><span class="line">        <span class="keyword">if</span> (pathName.indexOf(temp) == pathName.length - temp.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来尝试启动它，浏览器访问<a href="http://127.0.0.1:12306/index.html?a=1&amp;b=3" target="_blank" rel="noopener">http://127.0.0.1:12306/index.html?a=1&amp;b=3</a></p><p>终端输出如下👇</p><p><img src="https://pic1.zhimg.com/v2-bccefe3e22d1c4410b99c644ccf30b68_r.jpg" alt=""></p><p><br></p><h2 id="处理静态数据请求"><a href="#处理静态数据请求" class="headerlink" title="处理静态数据请求"></a>处理静态数据请求</h2><p>从上一步可以得到浏览器的请求头信息，最主要的就是我们服务端知道了浏览器想要得到<code>index.html</code>的内容，并可以判断出是静态数据请求还是动态数据请求：</p><p><br></p><p>写个html文件<code>/page/login.html</code>👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>script&gt;</span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;h1&gt;hello man！&lt;/</span>h1&gt;</span><br><span class="line">    &lt;img src=<span class="string">"./cheng.png"</span> alt=<span class="string">""</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure><p><br></p><p><strong>duntengServer.js</strong>👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> globalConfig = <span class="built_in">require</span>(<span class="string">'./config'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'新的连接已建立'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(request.url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> urlObj = url.parse(request.url);</span><br><span class="line">    <span class="keyword">var</span> pathName = url.parse(request.url).pathname;</span><br><span class="line">    <span class="keyword">var</span> params = url.parse(request.url).query;</span><br><span class="line">    <span class="keyword">var</span> paramsObj = url.parse(request.url, <span class="literal">true</span>).query;</span><br><span class="line">    <span class="built_in">console</span>.log(urlObj);</span><br><span class="line">    <span class="built_in">console</span>.log(pathName);</span><br><span class="line">    <span class="built_in">console</span>.log(params);</span><br><span class="line">    <span class="built_in">console</span>.log(paramsObj);</span><br><span class="line">    <span class="built_in">console</span>.log(isStaticsRequest(pathName));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isStaticsRequest(pathName)) &#123;</span><br><span class="line">        <span class="comment">// 处理静态数据请求</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> dataFile = fs.readFileSync(globalConfig.page_path + pathName);</span><br><span class="line">            response.writeHead(<span class="number">200</span>);</span><br><span class="line">            response.write(dataFile)</span><br><span class="line">            response.end();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            response.writeHead(<span class="number">404</span>);</span><br><span class="line">            response.write(<span class="string">"&lt;html&gt;&lt;body&gt;&lt;h1&gt;404 NotFound&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">            response.end();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 处理动态数据请求</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'动态请求'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;).listen(globalConfig.port);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是静态数据请求还是动态数据请求</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isStaticsRequest</span>(<span class="params">pathName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; globalConfig.static_file_type.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> temp = globalConfig.static_file_type[i];</span><br><span class="line">        <span class="keyword">if</span> (pathName.indexOf(temp) == pathName.length - temp.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动duntengServer.js，浏览器访问&lt;<a href="http://127.0.0.1:12306/login.html" target="_blank" rel="noopener">http://127.0.0.1:12306/login.html</a></p><p>浏览器如下👇</p><p><img src="https://pic1.zhimg.com/v2-e26b850a27f3c42c88b6b5f91dd87c40_r.jpg" alt=""></p><p>在服务器终端打印出以下信息👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> node duntengServer.js</span><br><span class="line">新的连接已建立</span><br><span class="line">/login.html</span><br><span class="line">Url &#123;</span><br><span class="line">  protocol: <span class="literal">null</span>,</span><br><span class="line">  slashes: <span class="literal">null</span>,</span><br><span class="line">  auth: <span class="literal">null</span>,</span><br><span class="line">  host: <span class="literal">null</span>,</span><br><span class="line">  port: <span class="literal">null</span>,</span><br><span class="line">  hostname: <span class="literal">null</span>,</span><br><span class="line">  hash: <span class="literal">null</span>,</span><br><span class="line">  search: <span class="literal">null</span>,</span><br><span class="line">  query: <span class="literal">null</span>,</span><br><span class="line">  pathname: <span class="string">'/login.html'</span>,</span><br><span class="line">  path: <span class="string">'/login.html'</span>,</span><br><span class="line">  href: <span class="string">'/login.html'</span> &#125;</span><br><span class="line">/login.html</span><br><span class="line"><span class="literal">null</span></span><br><span class="line">[<span class="built_in">Object</span>: <span class="literal">null</span> prototype] &#123;&#125;</span><br><span class="line"><span class="literal">true</span></span><br><span class="line">静态请求</span><br><span class="line">/login.html</span><br><span class="line">新的连接已建立</span><br><span class="line">/cheng.png</span><br><span class="line">Url &#123;</span><br><span class="line">  protocol: <span class="literal">null</span>,</span><br><span class="line">  slashes: <span class="literal">null</span>,</span><br><span class="line">  auth: <span class="literal">null</span>,</span><br><span class="line">  host: <span class="literal">null</span>,</span><br><span class="line">  port: <span class="literal">null</span>,</span><br><span class="line">  hostname: <span class="literal">null</span>,</span><br><span class="line">  hash: <span class="literal">null</span>,</span><br><span class="line">  search: <span class="literal">null</span>,</span><br><span class="line">  query: <span class="literal">null</span>,</span><br><span class="line">  pathname: <span class="string">'/cheng.png'</span>,</span><br><span class="line">  path: <span class="string">'/cheng.png'</span>,</span><br><span class="line">  href: <span class="string">'/cheng.png'</span> &#125;</span><br><span class="line">/cheng.png</span><br><span class="line"><span class="literal">null</span></span><br><span class="line">[<span class="built_in">Object</span>: <span class="literal">null</span> prototype] &#123;&#125;</span><br><span class="line"><span class="literal">true</span></span><br><span class="line">静态请求</span><br><span class="line">/cheng.png</span><br></pre></td></tr></table></figure><p>可见，每请求一次静态数据就会创建对应的http链接，这里一共建立了两个http请求链接，分别是对<code>login.html</code>和<code>cheng.png</code>的</p><p><br></p><h2 id="处理动态数据请求"><a href="#处理动态数据请求" class="headerlink" title="处理动态数据请求"></a>处理动态数据请求</h2><p>到这一步为止，就完成了对客户端请求静态数据的响应处理，接下来搞一下动态的数据请求处理。</p><p>这里以一个ajax请求为例子。</p><p><strong>page/login.js</strong>👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    xmlHttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xmlHttp.open(<span class="string">"GET"</span>, <span class="string">"/getData"</span>, <span class="literal">true</span>);</span><br><span class="line">    xmlHttp.send(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    xmlHttp.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlHttp.readyState == <span class="number">4</span> &amp;&amp; xmlHttp.status == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(xmlHttp.responseText);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">typeof</span> xmlHttp.responseText);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样<code>login.js</code>就触发了对<a href="http://127.0.0.1:12306/getData" target="_blank" rel="noopener">http://127.0.0.1:12306/getData</a>的请求，这个路径都不符合<code>server.conf</code>中对静态数据的限定，所以视为动态请求。</p><p>在<code>login.html</code>中引入<code>login.js</code>👇</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./login.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello man！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./cheng.png"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><p><code>duntengServer.js</code>中处理动态数据请求，将其路径名称打印出来👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> globalConfig = <span class="built_in">require</span>(<span class="string">'./config'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'新的连接已建立'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(request.url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> urlObj = url.parse(request.url);</span><br><span class="line">    <span class="keyword">var</span> pathName = url.parse(request.url).pathname;</span><br><span class="line">    <span class="keyword">var</span> params = url.parse(request.url).query;</span><br><span class="line">    <span class="keyword">var</span> paramsObj = url.parse(request.url, <span class="literal">true</span>).query;</span><br><span class="line">    <span class="built_in">console</span>.log(urlObj);</span><br><span class="line">    <span class="built_in">console</span>.log(pathName);</span><br><span class="line">    <span class="built_in">console</span>.log(params);</span><br><span class="line">    <span class="built_in">console</span>.log(paramsObj);</span><br><span class="line">    <span class="built_in">console</span>.log(isStaticsRequest(pathName));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isStaticsRequest(pathName)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"静态请求"</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(pathName);</span><br><span class="line">        <span class="comment">// 处理静态数据请求</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> dataFile = fs.readFileSync(globalConfig.page_path + pathName);</span><br><span class="line">            response.writeHead(<span class="number">200</span>);</span><br><span class="line">            response.write(dataFile)</span><br><span class="line">            response.end();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            response.writeHead(<span class="number">404</span>);</span><br><span class="line">            response.write(<span class="string">"&lt;html&gt;&lt;body&gt;&lt;h1&gt;404 NotFound&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">            response.end();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 处理动态数据请求</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'动态请求'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(pathName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;).listen(globalConfig.port);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是静态数据请求还是动态数据请求</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isStaticsRequest</span>(<span class="params">pathName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; globalConfig.static_file_type.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> temp = globalConfig.static_file_type[i];</span><br><span class="line">        <span class="keyword">if</span> (pathName.indexOf(temp) == pathName.length - temp.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动之，浏览器访问<a href="http://127.0.0.1:12306/login.html" target="_blank" rel="noopener">http://127.0.0.1:12306/login.html</a>，可以看到👇</p><p><img src="https://pic3.zhimg.com/v2-aaec8ec3106268c5e11d8e16f8c1a4aa_r.jpg" alt=""></p><p><img src="https://pic2.zhimg.com/v2-a123410cd6c292df40378871820c474d_r.jpg" alt=""></p><p>可以看到对动态请求的监测和处理是成功了。</p><h2 id="从duntengServer-js中抽离出业务处理代码"><a href="#从duntengServer-js中抽离出业务处理代码" class="headerlink" title="从duntengServer.js中抽离出业务处理代码"></a>从duntengServer.js中抽离出业务处理代码</h2><p>上文中客户端发起了数据请求，比如<code>login.html--&gt;login.js--&gt;ajax</code>我们直接在<code>duntengServer.js</code>中处理了针对它的业务处理（打印出了/getData的路径），<strong>但是</strong>这是不合适的，对于这种业务处理的代码应该交由<code>/web/loginController.js</code>来处理。所以应该在<code>/web/loginController.js</code>中写针对<code>login这一功能</code>的业务处理代码，然后在<code>duntengServer.js</code>中require这个<code>/web/loginController.js</code>。如下👇</p><p>📌<strong>/web/loginController.js</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"666~"</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">    <span class="comment">// 或者是存储数据等其他什么操作，这里只以打印操作为例</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = getData;</span><br></pre></td></tr></table></figure><p>📌<strong>duntengServer.js</strong>：</p><p><img src="https://pic1.zhimg.com/v2-e2604cb1b573b9f6bbbb5baa6a011f7c_r.jpg" alt=""></p><p><img src="https://pic4.zhimg.com/v2-aec6bf41f5d6f24a4aa56b4734056c5f_r.jpg" alt=""></p><p><br></p><p>但是如果一个项目里面除了login，还有其他很多的业务操作，像上面这样子一个一个地往<code>duntengServer.js</code>里手动引入会很繁琐，所以要想办法自动引入👇</p><p><br></p><h2 id="进一步优化实现自动识别路径和处理方法的映射"><a href="#进一步优化实现自动识别路径和处理方法的映射" class="headerlink" title="进一步优化实现自动识别路径和处理方法的映射"></a>进一步优化实现自动识别路径和处理方法的映射</h2><p>项目分层架构</p><p><img src="https://pic3.zhimg.com/80/v2-c12a1ed050c3cb1a76ee6a9d67ff4a3a_hd.jpg" alt=""></p><p>📌创建一个<code>/loader.js</code>，它负责将<code>/web</code>下所有业务处理 js 文件中的路径与方法函数之间的映射存进一个Map中👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> globalConfig = <span class="built_in">require</span>(<span class="string">"./config"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pathMap = <span class="keyword">new</span> <span class="built_in">Map</span>();<span class="comment">//用于管理全局的路径请求和对应方法(操作)的映射</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> files = fs.readdirSync(globalConfig[<span class="string">'web_path'</span>]); <span class="comment">//读取出了web路径下的所有文件名</span></span><br><span class="line"><span class="comment">// console.log(files);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; files.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> temp = <span class="built_in">require</span>(<span class="string">'./'</span> + globalConfig[<span class="string">'web_path'</span>] + <span class="string">'/'</span> + files[i]);</span><br><span class="line">    <span class="keyword">if</span> (temp.path) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> [key, value] <span class="keyword">of</span> temp.path) &#123;</span><br><span class="line">            <span class="comment">// console.log("key为 " + key);</span></span><br><span class="line">            <span class="comment">// console.log("value为 " + value);</span></span><br><span class="line">            <span class="keyword">if</span> (pathMap.get(key) == <span class="literal">null</span>) &#123;</span><br><span class="line">                pathMap.set(key, value);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"重复设置了pathMap，key为"</span> + key + <span class="string">"的路径和方法的映射已存在，请检查你的代码是否针对"</span> + key + <span class="string">"路径设置了多个处理方法"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// console.log(pathMap);</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = pathMap;</span><br></pre></td></tr></table></figure><p>📌<strong>web/loginController.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    response.writeHead(<span class="number">200</span>);</span><br><span class="line">    response.write(<span class="string">"hey kong, can u hear me?"</span>);</span><br><span class="line">    response.end();</span><br><span class="line">&#125;</span><br><span class="line">path.set(<span class="string">"/getData"</span>, getData);</span><br><span class="line"><span class="built_in">module</span>.exports.path = path;</span><br></pre></td></tr></table></figure><p>📌<strong>web/test.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> path = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testA</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    response.writeHead(<span class="number">200</span>);</span><br><span class="line">    response.write(<span class="string">"This is testA"</span>);</span><br><span class="line">    response.end();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testB</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    response.writeHead(<span class="number">200</span>);</span><br><span class="line">    response.write(<span class="string">"This is testB"</span>);</span><br><span class="line">    response.end();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">path.set(<span class="string">"/testA"</span>, testA);</span><br><span class="line">path.set(<span class="string">"/testB"</span>, testB);</span><br><span class="line"><span class="built_in">module</span>.exports.path = path;</span><br></pre></td></tr></table></figure><p>📌<strong>duntengServer.js</strong></p><p><img src="https://pic4.zhimg.com/v2-dce9c3e212881c762a5138e7b071ab5f_r.jpg" alt=""></p><p><img src="https://pic1.zhimg.com/v2-1ac404b18f188fb7a4aeb3278872e8f8_r.jpg" alt=""></p><p>启动服务器duntengServer.js，浏览器访问<a href="http://127.0.0.1:12306/login.html" target="_blank" rel="noopener">http://127.0.0.1:12306/login.html</a>👇</p><p><img src="https://pic3.zhimg.com/v2-0271a7f2b65255a6271bd897ccc6e056_r.jpg" alt=""></p><p><img src="https://pic4.zhimg.com/v2-a9cc15570463bcd4f0990170e0e7dd2b_r.jpg" alt=""></p><p><img src="https://pic2.zhimg.com/v2-096a3a28f5252ad840ea67cf43d99ae9_r.jpg" alt=""></p><p><br>浏览器访问<a href="http://127.0.0.1:12306/testA" target="_blank" rel="noopener">http://127.0.0.1:12306/testA</a>和&lt;<a href="http://127.0.0.1:12306/testB" target="_blank" rel="noopener">http://127.0.0.1:12306/testB</a>  👇</p><p><img src="https://pic1.zhimg.com/v2-f2b1bfe8ff194a6a0529face2f7dc03c_r.jpg" alt=""></p><p><img src="https://pic4.zhimg.com/v2-e733e42fed98df821d04c6ecc97ee5a3_r.jpg" alt=""></p><p><br><br></p><h2 id="生成运行日志"><a href="#生成运行日志" class="headerlink" title="生成运行日志"></a>生成运行日志</h2><p>📌 <strong>log.js</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">var</span> globalConfig = <span class="built_in">require</span>(<span class="string">"./config"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fileName = globalConfig.log_path + globalConfig.log_name;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleString();</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">    fs.appendFile(fileName, time + <span class="string">"  "</span> + data + <span class="string">"\n"</span>, &#123; <span class="attr">flag</span>: <span class="string">"a"</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = log;</span><br></pre></td></tr></table></figure><p>在<code>duntengServer.js</code>中引用<code>log.js</code>，在服务启动的时候调用log函数进行日志的更新写入。</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>写一个微型node服务器</title>
      <link href="/2019/09/30/net%E6%A8%A1%E5%9D%97%E5%86%99%E5%BE%AE%E5%9E%8Bnode%E6%9C%8D%E5%8A%A1%E5%99%A8.html"/>
      <url>/2019/09/30/net%E6%A8%A1%E5%9D%97%E5%86%99%E5%BE%AE%E5%9E%8Bnode%E6%9C%8D%E5%8A%A1%E5%99%A8.html</url>
      
        <content type="html"><![CDATA[<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><a href="https://github.com/Dunteng/node.js/tree/master/net%E5%BE%AE%E5%9E%8B%E6%9C%8D%E5%8A%A1%E5%99%A8" target="_blank" rel="noopener">https://github.com/Dunteng/node.js/tree/master/net%E5%BE%AE%E5%9E%8B%E6%9C%8D%E5%8A%A1%E5%99%A8</a></p><p><br><br></p><h2 id="基础demo"><a href="#基础demo" class="headerlink" title="基础demo"></a>基础demo</h2><p>我们可以使用浏览器来对Server建立连接并发送请求。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">"net"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = net.createServer();</span><br><span class="line">server.listen(<span class="number">12306</span>, <span class="string">"127.0.0.1"</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">"listening"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"服务已启动"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">"connection"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"有新的连接"</span>);</span><br><span class="line">    socket.on(<span class="string">"data"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><br>开启server服务，然后在浏览器访问<code>127.0.0.0:12306</code>，可以看到打印出了data，而这个data就是请求头👇</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1571650335272.png" alt="1571650335272"></p><p><br></p><p>模拟获取请求头数据和设置响应头👇</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">"net"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = net.createServer();</span><br><span class="line">server.listen(<span class="number">12306</span>, <span class="string">"127.0.0.1"</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">"listening"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"服务已启动"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">"connection"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"有新的连接"</span>);</span><br><span class="line">    socket.on(<span class="string">"data"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">        <span class="keyword">var</span> request = data.toString().split(<span class="string">"\r\n"</span>);</span><br><span class="line">        <span class="keyword">var</span> url = request[<span class="number">0</span>].split(<span class="string">" "</span>)[<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">console</span>.log(url);</span><br><span class="line">        socket.write(<span class="string">"HTTP 200OK\r\nContent-type:text/html\r\nServer:DWS/1.1\r\n\r\n&lt;html&gt;&lt;body&gt;hello browser&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><br></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1571651223434.png" alt="1571651223434"></p><p><br></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1571651233360.png" alt="1571651233360"></p><p><br></p><p>💡到了这一步，我们可以进一步实现平时看到的网站响应的效果：</p><p>​    新建一个<code>index.html</code>文件，我们通过浏览器访问<a href="http://127.0.0.1:12306/index" target="_blank" rel="noopener">http://127.0.0.1:12306/index</a>，然后服务端解析请求头截取到<code>index</code>字段，通过这个字段知道服务端要响应出<code>index.html</code>的数据。怎么获取到目标文件的内容，这就涉及到了读写文件的操作了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> net = <span class="built_in">require</span>(<span class="string">"net"</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = net.createServer();</span><br><span class="line">server.listen(<span class="number">12306</span>, <span class="string">"127.0.0.1"</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'listening'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'服务启动了'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">socket</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'有新的连接建立了'</span>);</span><br><span class="line"></span><br><span class="line">    socket.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">        <span class="keyword">var</span> request = data.toString().split(<span class="string">'\r\n'</span>);</span><br><span class="line">        <span class="keyword">var</span> url = request[<span class="number">0</span>].split(<span class="string">" "</span>)[<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">console</span>.log(url);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> dataFile = fs.readFileSync(__dirname + url);</span><br><span class="line">            <span class="comment">// console.log(dataFile.toString());</span></span><br><span class="line">            socket.write(<span class="string">"HTTP 200OK\r\nContent-type:text/html\r\nServer:DWS/1.1\r\n\r\n"</span>);</span><br><span class="line">            socket.write(dataFile)  <span class="comment">//socket分成两部写，避免dataFile被字符串化</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            socket.write(<span class="string">"HTTP 404NotFound\r\nContent-type:text/html\r\nServer:DWS/1.1\r\n\r\n&lt;html&gt;&lt;body&gt;&lt;h1&gt;&lt;/h1&gt;404 Not Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        socket.end();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br>运行<code>node server.js</code>，在浏览器访问<a href="http://127.0.0.1:12306/index.html就可以显示出`index.html`中的页面，如果访问的页面不存在会显示404页面。" target="_blank" rel="noopener">http://127.0.0.1:12306/index.html就可以显示出`index.html`中的页面，如果访问的页面不存在会显示404页面。</a></p><p><br><br></p><h2 id="微型服务器的编写"><a href="#微型服务器的编写" class="headerlink" title="微型服务器的编写"></a>微型服务器的编写</h2><p>在此基础上进行配置文件的编写，从而构建一个node.js微型服务器👇</p><ul><li>server.conf   配置文件，在里面写入要打开的文件的路径，相对路径和绝对路径都可。</li><li>conf.js   处理配置信息，暴露出一个全局的配置</li><li>newserver.js  服务端代码</li></ul><p>运行<code>node newserver.js</code>服务器，在浏览器打开<a href="http://127.0.0.1:12306/index.html" target="_blank" rel="noopener">http://127.0.0.1:12306/index.html</a>即可成功访问。</p><p>代码实现见文首GitHub链接。</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>虚拟机安装centos7和node</title>
      <link href="/2019/09/25/%E6%96%B0linux%E5%AD%A6%E4%B9%A0.html"/>
      <url>/2019/09/25/%E6%96%B0linux%E5%AD%A6%E4%B9%A0.html</url>
      
        <content type="html"><![CDATA[<p>【外部文章】：</p><ul><li>我的Linux基础整理网站👉<a href="https://rockdunteng.github.io/LinuxStudy/index.html" target="_blank" rel="noopener">rockdunteng</a></li></ul><h2 id="虚拟机安装centos7"><a href="#虚拟机安装centos7" class="headerlink" title="虚拟机安装centos7"></a>虚拟机安装centos7</h2><ul><li><p><a href="https://www.cnblogs.com/lynn-li/p/6077944.html" target="_blank" rel="noopener">参考文章</a></p></li><li><p>我安装的是迷你版，没有桌面系统，纯命令模式。</p></li><li><p>之后我们会搭建小型的集群</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1560265774418.png" alt="1560265774418"></p><p><br>现实项目中的全栈过程👇</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1571589448636.png" alt="1571589448636"></p><p><br>推荐的虚拟机内存配置：</p><ul><li>最好就是16G内存，随便配；但是老子是8G，往下看</li><li>proxy代理服务器：512</li><li>Service服务器： 1024</li><li>Cache缓存服务器： 1024</li><li>Database服务器： 1024</li><li>Release服务器： 1024/512</li></ul></li></ul><p><br><br></p><h2 id="桥接网络设置"><a href="#桥接网络设置" class="headerlink" title="桥接网络设置"></a>桥接网络设置</h2><ul><li><p>设置的是桥接网络，为了是不与宿主机共享同一网络。这时是无法上网的，需要进行下面的配置：</p><ul><li><p>进入路径<code>/etc/sysconfig/network-scripts</code>，修改<code>ifcfg-ens33</code>文件，将末行的<code>ONBOOT=no</code>改为<code>yes</code>。</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1571577252621.png" alt="1571577252621"></p></li><li><p>重启系统<code>reboot</code>。然后尝试<code>ping</code>功能，发现可以<code>ping</code>通即可。</p></li><li><p>如果还是ping不通，见这两篇文章👉   <a href="https://blog.csdn.net/bob_666/article/details/81412242" target="_blank" rel="noopener">一</a>   <a href="https://jingyan.baidu.com/article/f7ff0bfc7859502e26bb1328.html" target="_blank" rel="noopener">二</a></p></li><li><p>这里我平时用的是校园网，是无法桥接成功的。所以我改用手机热点wifi，并把网卡换成相应的无线网卡。</p></li><li><p>注意，我用热点的时候网速很慢，当要下载东西的时候最好切换回nat模式连接网络。</p></li></ul></li></ul><p><br><br></p><h2 id="安装wget和node"><a href="#安装wget和node" class="headerlink" title="安装wget和node"></a>安装wget和node</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install wget//用于网络请求</span><br><span class="line"></span><br><span class="line">wget https://nodejs.org/dist/v10.16.0/node-v10.16.0-linux-x64.tar.xz    //安装node压缩包</span><br><span class="line"></span><br><span class="line">xz -d node-v10.16.0-linux-x64.tar.xz      //解压成node-v10.16.0-linux-x64.tar</span><br><span class="line"></span><br><span class="line">tar -xf node-v10.16.0-linux-x64.tar      //解压成node-v10.16.0-linux-x64文件夹</span><br></pre></td></tr></table></figure><p><br>安装成功之后在本路径下查看：</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1560361705831.png" alt="1560361705831"></p><p><br>通过<code>ll</code>指令可以看到多了node的安装包，之后通过<code>xz -d</code>指令解压得到.tar<br>的压缩包，再通过<code>tar -xf</code>指令解压得到node-v10.16.0-linux-x64的文件夹。</p><p><br><br></p><h2 id="创建node软连接（快捷方式）"><a href="#创建node软连接（快捷方式）" class="headerlink" title="创建node软连接（快捷方式）"></a>创建node软连接（快捷方式）</h2><p>目前node安装在了root的用户目录下，没有放在<code>/usr/bin</code>下，所以需要创建一个软连接到<code>/usr/bin</code>下。</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1560527054649.png" alt="1560527054649"></p><p><br>定位到/usr/bin路径下，这个文件夹下有很多可执行的程序。上面绿色的就是代表可执行程序，浅蓝色的是链接，连接到指定的程序，有点类似win下的快捷方式。</p><p>我们进入node/bin文件夹里面，可以看到有<code>node</code>，<code>npm</code>，<code>npx</code>等可执行程序，这就是我们之前常用到的node命令。</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1560527879178.png" alt="1560527879178"></p><p>为了使得node指令在全局范围下都可以使用，我们需要把上述的node可执行程序放到/usr/bin/文件夹中。怎么实现呢？我们做个<strong>软连接</strong>而不是真的把文件放到那里面去。</p><p><br></p><ul><li><p>node</p><p>使用指令<code>ln -s ~/node-v10.16.0-linux-x64/bin/node /usr/bin/node</code>将原本node-xxx/bin/文件夹中的node可执行程序软连接到了/usr/bin/node文件夹中，可以看到在用户根目录路径下就可以使用node指令了</p><p> <img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1560528488411.png" alt="1560528488411"><br></p></li><li><p>npm和npx</p><p>同样地搞一下npm和npx</p><p>通过检查版本可以看到，这时已经可以在全局下使用node、npm、npx了：</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1571587193826.png" alt="1571587193826"></p></li></ul><p>  <br>这时再到/usr/bin/路径下输入<code>ls</code>指令就能看到我们链接的三个程序，使用<code>shift+PgUp</code> 向前翻看,一般翻13页左右。<code>shift+PgDown</code>向后翻看,一般翻13页左右。</p><p>  <img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/1560529922036.png" alt="1560529922036"></p><p>  <br></p><p><br></p><h2 id="FHS-文件系统层次化标准"><a href="#FHS-文件系统层次化标准" class="headerlink" title="FHS(文件系统层次化标准)"></a>FHS(文件系统层次化标准)</h2><p><img src="https://oscimg.oschina.net/oscnet/719336e7cbb111e832a03c95075d32701fa.jpg" alt=""></p><p><br></p><p>/home和/root的区别：实际上，linux与windows的分区都有主分区，扩展分区，逻辑分区，只是他们的目录结构不一样，windows为森林型目录结构，他可以有很多的跟，如C，D，E，F都是他的根目录，而linux中是一个树形机构，他只有一个根目录那就是 / ,然后在他下面有子目录/root  /home  /etc /bin 等，你可以将各个子目录单独挂载到一个分区，而其中的/root 相当于是linux超级权限用户root的家目录，而/home/XXX(用户名)这是普通用户的家目录，当新建一个普通用户时候，那么在/home 目录下就有一个对应的/home/XX 路径，用来存放用户的主目录</p><p><br><br></p><h2 id="使用xshell"><a href="#使用xshell" class="headerlink" title="使用xshell"></a>使用xshell</h2><p>虚拟机的终端不支持复制粘贴，不太方便，所以可以使用xshell远程连接上虚拟机，通过xshell来执行操作。</p><p><br><br></p><h2 id="node服务器初试"><a href="#node服务器初试" class="headerlink" title="node服务器初试"></a>node服务器初试</h2><p>找个目录，我随便在<code>/home/test</code>下新建了一个<code>test.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">res.writeHead(<span class="number">200</span>,&#123;<span class="string">"Content-Type"</span>:<span class="string">"text/plain"</span>&#125;);</span><br><span class="line">res.end(<span class="string">"hello world"</span>);</span><br><span class="line">&#125;</span><br><span class="line">http.createServer(hello).listen(<span class="number">12306</span>,<span class="string">"192.168.171.134"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"hello world"</span>);</span><br></pre></td></tr></table></figure><p>【注意】：</p><ul><li>通过<code>ip addr</code>查看IP地址，然后用xshell远程连接之。</li><li>代码中的IP地址即为centos的IP地址，开启端口为12306</li><li>在<code>/home/test</code>下执行<code>node test.js</code>指令就开启了node服务器。</li><li>然后要<strong>关闭centos的防火墙</strong>。<code>systemctl disable firewalld</code>，然后<code>reboot</code>重启之。</li><li>这下子就可以在浏览器中访问到<code>http://192.168.171.134:12306/</code>了，页面显示<code>res.end</code>中的内容。</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux基础入门</title>
      <link href="/2019/09/01/Linux%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html"/>
      <url>/2019/09/01/Linux%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html</url>
      
        <content type="html"><![CDATA[<p><br><br><br></p><p>点击此处跳转👉  <a href="https://rockdunteng.github.io/LinuxStudy/index.html" target="_blank" rel="noopener">Linux笔记</a></p><p><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue基础笔记</title>
      <link href="/2019/08/09/vue%E7%9F%A5%E8%AF%86%E7%82%B9.html"/>
      <url>/2019/08/09/vue%E7%9F%A5%E8%AF%86%E7%82%B9.html</url>
      
        <content type="html"><![CDATA[<h1 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h1><p style="color:red">【复习本篇笔记时一边看源码】</p><p><a href="https://github.com/rockdunteng/rockdunteng.github.io/tree/master/note/vue/%E6%B8%A1%E4%B8%80%E6%96%B0Vue%E6%BA%90%E7%A0%81" target="_blank" rel="noopener">https://github.com/rockdunteng/rockdunteng.github.io/tree/master/note/vue/%E6%B8%A1%E4%B8%80%E6%96%B0Vue%E6%BA%90%E7%A0%81</a><br><br><br></p><h1 id="一、Vue前导"><a href="#一、Vue前导" class="headerlink" title="一、Vue前导"></a>一、Vue前导</h1><p>Vue的优点：</p><ol><li>减少dom操作，性能更好</li><li>视图、数据分离</li><li>维护成本低</li></ol><p>点击该<a href="https://rockdunteng.github.io/note/vue/vue%E7%9A%84%E4%BC%98%E7%82%B9.pdf" target="_blank" rel="noopener">pdf</a>查看详情</p><p><br><br><br></p><h1 id="二、数据绑定与视图渲染"><a href="#二、数据绑定与视图渲染" class="headerlink" title="二、数据绑定与视图渲染"></a>二、数据绑定与视图渲染</h1><p>使用“Mustache”语法 (双花括号)插值表达式渲染视图。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564215958637.png" alt="1564215958637"></p><p><br><br></p><h2 id="数据要先存在，才能实现数据绑定"><a href="#数据要先存在，才能实现数据绑定" class="headerlink" title="数据要先存在，才能实现数据绑定"></a><strong>数据要先存在，才能实现数据绑定</strong></h2><p>在下图所示中，可以通过<code>vm.name</code>的方式进行数据的获取和修改，数据修改的同时，视图也随之改变，如本例中的<code>name</code>的值由jimmy变成了tony，视图立即随之改变。但是当<code>vm.obj.xx=12</code>时，虽然<code>vm.obj.xx</code>成功创建了，但是视图没有随之渲染。</p><p>因为在 Vue 中，<strong>数据要先存在，才能实现数据绑定，从而渲染视图</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564212932741.png" alt="1564212932741"></p><p><br><br></p><h2 id="通过索引的方式修改数组，或通过修改数组长度的方式修改数组，都无法重新渲染视图"><a href="#通过索引的方式修改数组，或通过修改数组长度的方式修改数组，都无法重新渲染视图" class="headerlink" title="通过索引的方式修改数组，或通过修改数组长度的方式修改数组，都无法重新渲染视图"></a>通过<strong>索引的方式</strong>修改数组，或通过<strong>修改数组长度的方式</strong>修改数组，都无法重新渲染视图</h2><p> <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564213382860.png" alt="1564213382860"></p><p><br><br></p><h2 id="数组变异方法"><a href="#数组变异方法" class="headerlink" title="数组变异方法"></a>数组变异方法</h2><p>发现使用数组方法时，就会触发视图重新渲染。</p><p>Vue的数据绑定是通过<strong>数据劫持</strong>来实现的，在数据劫持的时候通过<strong>索引修改数组</strong>或者<strong>通过修改数组长度来修改数组</strong>是无法被感知的，Vue在设计的时候通过<strong>修改数组的一些方法</strong>，在这些方法里面添加了一个<strong>更新视图的方法的执行</strong>，所以当我们调用这些数组的方法的时候可以触发更新视图方法，从而更新视图。这些数组的方法在vue中被称为<strong>数组变异方法</strong>。这些方法已经不是原生的 js 方法了，是被 Vue 改写了，让它能有一个重新渲染视图的功能。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564214165792.png" alt="1564214165792"></p><p><br><br></p><p>Vue 有以下7中变异方法</p><ul><li><code>push()</code>        往数组最后面添加一个元素，成功返回当前数组的长度 </li><li><code>pop()</code>             删除数组的最后一个元素，成功返回删除元素的值 </li><li><code>shift()</code>          删除数组的第一个元素，成功返回删除元素的值 </li><li><code>unshift()</code>      往数组最前面添加一个元素，成功返回当前数组的长度 </li><li><code>splice()</code>        有三个参数，第一个是想要删除的元素的下标（必选），第二个是想要删除的个数（必选），                     第三个是删除后想要在原位置替换的值（可选） </li><li><code>sort()</code>             使数组按照字符编码默认从小到大排序,成功返回排序后的数组 </li><li><code>reverse()</code>           将数组倒序，成功返回倒序后的数组 </li></ul><p><br><br></p><h2 id="set方法"><a href="#set方法" class="headerlink" title="$set方法"></a>$set方法</h2><p>$set方法可以<strong>解决对象中未存在数据的数据绑定问题</strong>。</p><p>可以实现视图的实时更新。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564216195094.png" alt="1564216195094"></p><p><br><br></p><h2 id="el"><a href="#el" class="headerlink" title="$el"></a>$el</h2><p>Vue实例vm中有一个 $el 属性，它能指向挂载 Vue 的Dom结构。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564217181273.png" alt="1564217181273"><br></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564217272687.png" alt="1564217272687"></p><p><br>上图一共修改了 name 三次，修改了 age 两次，最后一行代码是打印 <code>$el.innerText</code>，但是这五次的数据修改是<strong>异步</strong>的，结果就是是先打印了一开始的 <code>$el.innerText</code>:</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564217455589.png" alt="1564217455589"></p><p><br>这样导致我们无法打印获取到数据更改后的<code>$el.innerText</code>，如何解决，看下面的 <code>$nextTick</code></p><p><br><br></p><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="$nextTick"></a>$nextTick</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564217936576.png" alt="1564217936576"></p><p>它会在数据都修改完成并且重新渲染到页面上之后才执行里面的函数。这样就能获取到数据更改后的dom。</p><p><br><br></p><h2 id="mount"><a href="#mount" class="headerlink" title="$mount"></a>$mount</h2><p>创建 Vue 实例的时候可以不写 <code>el: &#39;#app&#39;</code>, 使用 <code>$mount</code>也能实现同样的效果。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564218209720.png" alt="1564218209720"></p><p><br><br></p><h2 id="refs"><a href="#refs" class="headerlink" title="$refs"></a>$refs</h2><p>在元素标签上使用<code>ref</code>来标记，然后通过<code>$refs</code>来获取到标记的引用：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567579888756.png" alt="1567579888756"></p><p><br>注意的是，不能重复标记相同名称，相同名称的 ref 只会覆盖为最后一个：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567580190773.png" alt="1567580190773"></p><p><br>但是，如果是用 v-for 的方式来循环标记，则不会发生覆盖，会得到一个数组：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567580308732.png" alt="1567580308732"></p><p>ref 除了可以标记 dom 元素，还可以标记组件。如果在普通的 DOM 元素上使用，引用指向的就是 DOM 元素；如果用在子组件上，引用就指向组件实例。下文讲组件传值时会讲到。</p><p> <br><br><br></p><h1 id="三、Vue-指令"><a href="#三、Vue-指令" class="headerlink" title="三、Vue 指令"></a>三、Vue 指令</h1><h2 id="v-pre、v-cloak和v-once指令"><a href="#v-pre、v-cloak和v-once指令" class="headerlink" title="v-pre、v-cloak和v-once指令"></a>v-pre、v-cloak和v-once指令</h2><h3 id="v-pre指令"><a href="#v-pre指令" class="headerlink" title="v-pre指令"></a>v-pre指令</h3><p>在模板中跳过vue的编译，直接输出原始值。就是在标签中加入v-pre就不会输出vue中的data值了。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-pre</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这时并不会输出我们的message值，而是直接在网页中显示<code></code><br></p><h3 id="v-cloak指令"><a href="#v-cloak指令" class="headerlink" title="v-cloak指令"></a>v-cloak指令</h3><p>在vue渲染完指定的整个DOM后才进行显示。它必须和CSS样式一起使用，</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[v-cloak]</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="selector-tag">div</span> <span class="selector-tag">v-cloak</span>&gt;</span><br><span class="line">  &#123;&#123; message &#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="v-once指令"><a href="#v-once指令" class="headerlink" title="v-once指令"></a>v-once指令</h3><p>在第一次DOM时进行渲染，渲染完成后视为静态内容，跳出以后的渲染过程。</p><p><br></p><h2 id="其他常用指令"><a href="#其他常用指令" class="headerlink" title="其他常用指令"></a>其他常用指令</h2><p>还有 v-html、v-text、v-if、v-else-if、v-else、v-show等，具体见旧版笔记。</p><p><br><br></p><h2 id="xss攻击"><a href="#xss攻击" class="headerlink" title="xss攻击"></a>xss攻击</h2><p>讲到 v-html 的时候，提到了<strong>XSS攻击</strong>，了解一下。</p><p><a href="https://github.com/lynnic26/LynnNote/issues/1" target="_blank" rel="noopener">https://github.com/lynnic26/LynnNote/issues/1</a></p><p><br><br></p><h2 id="v-bind和v-on"><a href="#v-bind和v-on" class="headerlink" title="v-bind和v-on"></a>v-bind和v-on</h2><p><code>&lt;img v-bind:src=&quot;imgUrl&quot; alt=&quot;&quot;&gt;</code>中的<code>v-bind</code>可以简写为<code>&lt;img :src=&quot;imgUrl&quot; alt=&quot;&quot;&gt;</code></p><p><br><br></p><h3 id="绑定class"><a href="#绑定class" class="headerlink" title="绑定class"></a>绑定class</h3><ol><li><p>使用 <strong>:class</strong> 来绑定类名：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">    <span class="selector-class">.red</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: red</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;p :class=&apos;redClass&apos;&gt;peace!&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">   </span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        data: &#123;</span><br><span class="line">            redClass: &apos;red&apos;,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">   </span><br><span class="line">    vm.$mount(&apos;#app&apos;)</span><br><span class="line">   </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>这样 p 标签就添加上了一个名为 red 的类了。<br><br></p></li></ol><ol start="2"><li><p>结合<strong>数组</strong>方式绑定类名：</p><p>如果想要给一个标签绑定多个类名，</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564384342505.png" alt="1564384342505"></p><p>正确方式是使用【数组】：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">"[redClass, bigClass]"</span>&gt;</span>peace!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>​    还可以在数组中进行判断运算：</p><p>​    <img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564385335421.png" alt="1564385335421"></p><p><br></p><ol start="3"><li><p>结合<strong>对象</strong>绑定class：    </p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564386032576.png" alt="1564386032576"></p><p>也可以这样：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564386210997.png" alt="1564386210997"></p></li></ol><p><br><br></p><h3 id="绑定style"><a href="#绑定style" class="headerlink" title="绑定style"></a>绑定style</h3><p>将样式写进一个对象花括号里面，注意键值对中的值要用引号包起来。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p :style=&quot;&#123;width:&apos;100px&apos;,height:&apos;200px&apos;,backgroundColor:&apos;red&apos;&#125;&quot;&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure><p>也可以在data中写样式对象，然后用<code>:style</code>绑定，这样比较清晰：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564386818920.png" alt="1564386818920"></p><p>如果想要给一个标签绑定上多个样式对象，需要使用数组：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564387087174.png" alt="1564387087174"></p><p>注意一点是在一个标签内部，<code>style</code>的权重低于<code>:style</code>的权重，先执行style的样式，然后再执行<code>:style</code>的样式，遇到相同的backgroundColor<code>:style</code>的样式会覆盖<code>style</code>的。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1564387434614.png" alt="1564387434614"></p><p>p 的背景颜色为red</p><p><br><br></p><h2 id="v-for"><a href="#v-for" class="headerlink" title="v-for"></a>v-for</h2><p><br><br></p><h2 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h2><p>实现双向数据绑定</p><p>可以实现 v-model 的表单元素：</p><ul><li>input text</li><li>input checkbox</li><li>input radio</li><li>textarea</li><li>select</li></ul><p>【这部分看一下源码】</p><p><br><br><br></p><h1 id="四、自定义键盘修饰符"><a href="#四、自定义键盘修饰符" class="headerlink" title="四、自定义键盘修饰符"></a>四、自定义键盘修饰符</h1><h3 id="2-x中自定义键盘修饰符"><a href="#2-x中自定义键盘修饰符" class="headerlink" title="2.x中自定义键盘修饰符"></a><a href="https://cn.vuejs.org/v2/guide/events.html#键值修饰符" target="_blank" rel="noopener">2.x中自定义键盘修饰符</a></h3><ol><li>通过<code>Vue.config.keyCodes.名称 = 按键值</code>来自定义案件修饰符的别名：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.keyCodes.f2 = 113;</span><br></pre></td></tr></table></figure><ol><li>使用自定义的按键修饰符：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; v-model=&quot;name&quot; @keyup.f2=&quot;add&quot;&gt;</span><br></pre></td></tr></table></figure><p><br><br><br></p><h1 id="五、directive自定义指令"><a href="#五、directive自定义指令" class="headerlink" title="五、directive自定义指令"></a><a href="https://cn.vuejs.org/v2/guide/custom-directive.html" target="_blank" rel="noopener">五、directive自定义指令</a></h1><ol><li>自定义全局和局部的 自定义指令：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 自定义全局指令 v-focus，为绑定的元素自动获取焦点：</span><br><span class="line"></span><br><span class="line">Vue.directive(&apos;focus&apos;, &#123;</span><br><span class="line"></span><br><span class="line">  inserted: function (el) &#123; // inserted 表示被绑定元素插入父节点时调用</span><br><span class="line"></span><br><span class="line">    el.focus();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 自定义局部指令 v-color 和 v-font-weight，为绑定的元素设置指定的字体颜色 和 字体粗细：</span><br><span class="line"></span><br><span class="line">  directives: &#123;</span><br><span class="line"></span><br><span class="line">    color: &#123; // 为元素设置指定的字体颜色</span><br><span class="line"></span><br><span class="line">      bind(el, binding) &#123;</span><br><span class="line"></span><br><span class="line">        el.style.color = binding.value;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    &apos;font-weight&apos;: function (el, binding2) &#123; // 自定义指令的简写形式，等同于定义了 bind 和 update 两个钩子函数</span><br><span class="line"></span><br><span class="line">      el.style.fontWeight = binding2.value;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ol><li>自定义指令的使用方式：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; v-model=&quot;searchName&quot; v-focus v-color=&quot;&apos;red&apos;&quot; v-font-weight=&quot;900&quot;&gt;</span><br></pre></td></tr></table></figure><p>【渡一案例见源码和视频】</p><p>F:\渡一前端课\新录制的vue课程资料\9. directive\vue.html</p><p><br><br><br></p><h1 id="六、filter过滤器"><a href="#六、filter过滤器" class="headerlink" title="六、filter过滤器"></a>六、filter过滤器</h1><p>概念：Vue.js 允许你自定义过滤器，<strong>可被用作一些常见的文本格式化</strong>。过滤器可以用在两个地方：<strong>mustache 插值和 v-bind 表达式</strong>。过滤器应该被添加在 JavaScript 表达式的尾部，由“管道”符指示；<br><br></p><h3 id="私有过滤器"><a href="#私有过滤器" class="headerlink" title="私有过滤器"></a>私有过滤器</h3><ol><li>HTML元素：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&#123;&#123;item.ctime | dataFormat(&apos;yyyy-mm-dd&apos;)&#125;&#125;&lt;/td&gt;</span><br></pre></td></tr></table></figure><ol><li>私有 <code>filters</code> 定义方式：</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">filters: &#123; // 私有局部过滤器，只能在 当前 VM 对象所控制的 View 区域进行使用</span><br><span class="line"></span><br><span class="line">    dataFormat(input, pattern = &quot;&quot;) &#123; // 在参数列表中 通过 pattern=&quot;&quot; 来指定形参默认值，防止报错</span><br><span class="line"></span><br><span class="line">      var dt = new Date(input);</span><br><span class="line"></span><br><span class="line">      // 获取年月日</span><br><span class="line"></span><br><span class="line">      var y = dt.getFullYear();</span><br><span class="line"></span><br><span class="line">      var m = (dt.getMonth() + 1).toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line">      var d = dt.getDate().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      // 如果 传递进来的字符串类型，转为小写之后，等于 yyyy-mm-dd，那么就返回 年-月-日</span><br><span class="line"></span><br><span class="line">      // 否则，就返回  年-月-日 时：分：秒</span><br><span class="line"></span><br><span class="line">      if (pattern.toLowerCase() === &apos;yyyy-mm-dd&apos;) &#123;</span><br><span class="line"></span><br><span class="line">        return `$&#123;y&#125;-$&#123;m&#125;-$&#123;d&#125;`;</span><br><span class="line"></span><br><span class="line">      &#125; else &#123;</span><br><span class="line"></span><br><span class="line">        // 获取时分秒</span><br><span class="line"></span><br><span class="line">        var hh = dt.getHours().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line">        var mm = dt.getMinutes().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line">        var ss = dt.getSeconds().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        return `$&#123;y&#125;-$&#123;m&#125;-$&#123;d&#125; $&#123;hh&#125;:$&#123;mm&#125;:$&#123;ss&#125;`;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>使用ES6中的字符串新方法 String.prototype.padStart(maxLength, fillString=’’) 或 String.prototype.padEnd(maxLength, fillString=’’)来填充字符串；</p></blockquote><p><br><br></p><h3 id="全局过滤器"><a href="#全局过滤器" class="headerlink" title="全局过滤器"></a>全局过滤器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">// 定义一个全局过滤器</span><br><span class="line"></span><br><span class="line">Vue.filter(&apos;dataFormat&apos;, function (input, pattern = &apos;&apos;) &#123;</span><br><span class="line"></span><br><span class="line">  var dt = new Date(input);</span><br><span class="line"></span><br><span class="line">  // 获取年月日</span><br><span class="line"></span><br><span class="line">  var y = dt.getFullYear();</span><br><span class="line"></span><br><span class="line">  var m = (dt.getMonth() + 1).toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line">  var d = dt.getDate().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  // 如果 传递进来的字符串类型，转为小写之后，等于 yyyy-mm-dd，那么就返回 年-月-日</span><br><span class="line"></span><br><span class="line">  // 否则，就返回  年-月-日 时：分：秒</span><br><span class="line"></span><br><span class="line">  if (pattern.toLowerCase() === &apos;yyyy-mm-dd&apos;) &#123;</span><br><span class="line"></span><br><span class="line">    return `$&#123;y&#125;-$&#123;m&#125;-$&#123;d&#125;`;</span><br><span class="line"></span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">    // 获取时分秒</span><br><span class="line"></span><br><span class="line">    var hh = dt.getHours().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line">    var mm = dt.getMinutes().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line">    var ss = dt.getSeconds().toString().padStart(2, &apos;0&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    return `$&#123;y&#125;-$&#123;m&#125;-$&#123;d&#125; $&#123;hh&#125;:$&#123;mm&#125;:$&#123;ss&#125;`;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>注意：当有局部和全局两个名称相同的过滤器时候，会以就近原则进行调用，即：局部过滤器优先于全局过滤器被调用！</p></blockquote><p>【渡一案例见源码和视频】</p><p>F:\渡一前端课\新录制的vue课程资料\10. filter\vue.html</p><p><br><br><br></p><h1 id="七、el、-template、render"><a href="#七、el、-template、render" class="headerlink" title="七、el、 template、render"></a>七、el、 template、render</h1><p>挂载过程：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/挂载流程.jpg" alt=""></p><p>【渡一案例见源码和视频】</p><p>F:\渡一前端课\新录制的vue课程资料\11. el、template、render\vue.html</p><p><br><br><br></p><h1 id="八、vue实例的生命周期"><a href="#八、vue实例的生命周期" class="headerlink" title="八、vue实例的生命周期"></a><a href="https://cn.vuejs.org/v2/guide/instance.html#实例生命周期" target="_blank" rel="noopener">八、vue实例的生命周期</a></h1><p><a href="https://ws1.sinaimg.cn/large/006ttwEMly1g2hbe8i32jj31xe25qtku.jpg" target="_blank" rel="noopener">[查看大图]</a><img src="https://ws1.sinaimg.cn/large/006ttwEMly1g2hbe8i32jj31xe25qtku.jpg" alt=""></p><ul><li>什么是生命周期：从Vue实例创建、运行、到销毁期间，总是伴随着各种各样的事件，这些事件，统称为生命周期！</li><li><a href="https://cn.vuejs.org/v2/api/#选项-生命周期钩子" target="_blank" rel="noopener">生命周期钩子</a>：就是生命周期事件的别名而已；</li><li>生命周期钩子 = 生命周期函数 = 生命周期事件</li><li><p>主要的生命周期函数分类：</p></li><li><p>创建期间的生命周期函数：</p></li><li><p>beforeCreate：实例刚在内存中被创建出来，此时，还没有初始化好 data 和 methods 属性</p></li><li>created：实例已经在内存中创建OK，此时 data 和 methods 已经创建OK，此时还没有开始 编译模板</li><li>beforeMount：此时已经完成了模板的编译，但是还没有挂载到页面中</li><li><p>mounted：此时，已经将编译好的模板，挂载到了页面指定的容器中显示</p></li><li><p>运行期间的生命周期函数：</p></li><li><p>beforeUpdate：状态更新之前执行此函数， 此时 data 中的状态值是最新的，但是界面上显示的 数据还是旧的，因为此时还没有开始重新渲染DOM节点</p></li><li><p>updated：实例更新完毕之后调用此函数，此时 data 中的状态值 和 界面上显示的数据，都已经完成了更新，界面已经被重新渲染好了！</p></li><li><p>销毁期间的生命周期函数：</p></li><li><p>beforeDestroy：实例销毁之前调用。在这一步，实例仍然完全可用。</p></li><li>destroyed：Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。</li></ul><p><br><br><br></p><h1 id="九、计算属性computed和监听器watch"><a href="#九、计算属性computed和监听器watch" class="headerlink" title="九、计算属性computed和监听器watch"></a>九、计算属性computed和监听器watch</h1><p>模板内的表达式非常便利，但是设计它们的初衷是用于简单运算的。在模板中放入太多的逻辑会让模板过重且难以维护。 </p><p>当我想要拼接name，looks，和age时，使用模板表达式很麻烦。直接写入describe属性中有显得代码亢余。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv1"</span>&gt;</span>&#123;&#123;name&#125;&#125; &#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv2"</span>&gt;</span>&#123;&#123;name+' '+age&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv3"</span>&gt;</span>&#123;&#123;describe&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#dv"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            name: <span class="string">"dunteng"</span>,</span><br><span class="line">            age: <span class="string">"18"</span>,</span><br><span class="line">            describe: <span class="string">"dunteng 18"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>效果：<img src="https://ws1.sinaimg.cn/large/006ttwEMgy1g2czp6tk1ej303o02dmwx.jpg" alt=""></p><p>以上三种方法都可以，但是并不灵活。</p><p>应该用methods中的方法来实现：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv1"</span>&gt;</span>&#123;&#123;name&#125;&#125; &#123;&#123;age&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv2"</span>&gt;</span>&#123;&#123;name+' '+age&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv3"</span>&gt;</span>&#123;&#123;describe()&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>   //括号不可丢1</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#dv"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            name: <span class="string">"dunteng"</span>,</span><br><span class="line">            age: <span class="string">"18"</span>,</span><br><span class="line">            height: <span class="number">180</span>,</span><br><span class="line">            <span class="comment">// describe: "dunteng 18"  data中的变量命名和methods中的方法不可同名</span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            describe()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"方法describe被执行了"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.name+<span class="string">" "</span>+<span class="keyword">this</span>.age;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>函数返回了 name和age这两个属性，并且渲染到页面 </p><p>如此相比直接用模板语法来拼接确实简洁很多。</p><p><br><br></p><p>【这里需要知道】</p><p>在控制台上修改了这两个属性的其中一个之后，函数会被再执行一次，比如我在控制台输入<code>vm.name = &quot;hh&quot;</code>后， 页面上的<code>dunteng 18</code>会立即变成<code>hh 18</code>并再打印一次console语句。简而言之就是，<strong>当视图重新渲染了就会再执行一次该函数。</strong>另外当我们修改与describe方法无关的变量且该变量没有被渲染到试图上如height时，不会触发describe方法，但是一旦这个与describe方法无关的变量是有渲染到视图里的，则照样触发describe方法。</p><p><strong>因此我们修改属性影响视图渲染的同时，会涉及到重新加载无关的函数的问题，如此对性能十分不友好。</strong></p><p><br></p><p><strong>解决方法一：watch</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv3"</span>&gt;</span>&#123;&#123;describe&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#dv"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            name: <span class="string">"dunteng"</span>,</span><br><span class="line">            age: <span class="string">"18"</span>,</span><br><span class="line">            height: <span class="number">180</span>,</span><br><span class="line">            describe: <span class="string">"dunteng 18"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        watch: &#123;</span><br><span class="line">            <span class="comment">// 监听name的变化</span></span><br><span class="line">            name()&#123;</span><br><span class="line">                <span class="keyword">this</span>.describe = <span class="keyword">this</span>.name + <span class="string">" "</span> +<span class="keyword">this</span>.age;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 监听age的变化</span></span><br><span class="line">            age()&#123;</span><br><span class="line">                <span class="keyword">this</span>.describe = <span class="keyword">this</span>.name + <span class="string">" "</span> +<span class="keyword">this</span>.age;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>这个方式虽然解决了问题，但是并不方便，代码冗余。</p><p><br></p><p><strong>解决方法二： computed</strong></p><p>这是最优的解决方法。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv3"</span>&gt;</span>&#123;&#123;describe&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#dv"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            name: <span class="string">"dunteng"</span>,</span><br><span class="line">            age: <span class="string">"18"</span>,</span><br><span class="line">            height: <span class="number">180</span></span><br><span class="line">        &#125;,</span><br><span class="line">        computed: &#123;</span><br><span class="line">               describe()&#123;</span><br><span class="line">                   <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">" "</span> + <span class="keyword">this</span>.age;</span><br><span class="line">               &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>computed里面除了可以像上面那样写成方法（实际上并不是方法）的样子，还可以写成对象：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv3"</span>&gt;</span>&#123;&#123;describe&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#dv"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            name: <span class="string">"dunteng"</span>,</span><br><span class="line">            age: <span class="string">"18"</span>,</span><br><span class="line">            height: <span class="number">180</span></span><br><span class="line">        &#125;,</span><br><span class="line">        computed: &#123;</span><br><span class="line">            <span class="comment">//    describe()&#123;</span></span><br><span class="line">            <span class="comment">//        return this.name + " " + this.age;</span></span><br><span class="line">            <span class="comment">//    &#125;</span></span><br><span class="line">            describe: &#123;</span><br><span class="line">            <span class="comment">//当我们获得这个describe的时候（渲染的时候）会执行get方法</span></span><br><span class="line">                get()&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">" "</span> + <span class="keyword">this</span>.age;</span><br><span class="line">                &#125;,</span><br><span class="line">                set()&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">"describe被修改了"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br><br></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/006ttwEMgy1g2d14c4gstj308c076jrd.jpg" alt=""></p><p><br><br>【注意】：上述例子中，当<code>vm.name</code>  和<code>vm.age</code>修改了的时候，因为有computed监听，所以在修改的同时页面的内容也相应地修改了。但是当<code>vm.describe</code>整个被修改的时候，页面时没有同步渲染更新的，所以还要如下操作：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv3"</span>&gt;</span>&#123;&#123;describe&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv4"</span>&gt;</span>&#123;&#123;height&#125;&#125;cm<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">"#dv"</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            name: <span class="string">"dunteng"</span>,</span><br><span class="line">            age: <span class="string">"18"</span>,</span><br><span class="line">            height: <span class="number">180</span></span><br><span class="line">        &#125;,</span><br><span class="line">        computed: &#123;</span><br><span class="line">            <span class="comment">//    describe()&#123;</span></span><br><span class="line">            <span class="comment">//        return this.name + " " + this.age;</span></span><br><span class="line">            <span class="comment">//    &#125;</span></span><br><span class="line">            describe: &#123;</span><br><span class="line">                get()&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">" "</span> + <span class="keyword">this</span>.age;</span><br><span class="line">                &#125;,</span><br><span class="line">                set(value)&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">"describe被修改了"</span>);</span><br><span class="line">                    <span class="keyword">const</span> arr = value.split(<span class="string">" "</span>);</span><br><span class="line">                    <span class="built_in">console</span>.log(arr[<span class="number">0</span>]);</span><br><span class="line">                    <span class="built_in">console</span>.log(arr[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">this</span>.name = arr[<span class="number">0</span>];</span><br><span class="line">                    <span class="keyword">this</span>.age = arr[<span class="number">1</span>]; </span><br><span class="line">                    <span class="keyword">if</span>(arr[<span class="number">0</span>]==<span class="string">"大帅哥"</span>)&#123;</span><br><span class="line">                        <span class="keyword">this</span>.height = <span class="number">200</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><strong>新版渡一代码</strong>：F:\渡一前端课\新录制的vue课程资料\13. 计算属性和侦听器\vue.html</p><p><strong>思否文章</strong>：<a href="https://segmentfault.com/a/1190000012948175" target="_blank" rel="noopener">https://segmentfault.com/a/1190000012948175</a></p><p><br><br><br></p><h1 id="十、组件"><a href="#十、组件" class="headerlink" title="十、组件"></a>十、组件</h1><h2 id="全局组件"><a href="#全局组件" class="headerlink" title="全局组件"></a>全局组件</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567510618984.png" alt="1567510618984"></p><p>这样注册了一个全局组件，名为lin-dunteng，使用时直接标签化。</p><p>也可以写成小驼峰式：linDunteng，标签化为<code>&lt;lin-Dunteng&gt;&lt;lin-Dunteng&gt;</code>或者<code>&lt;lin-dunteng&gt;&lt;/lin-dunteng&gt;</code>，但是不能写成<code>&lt;linDunteng&gt;&lt;/linDunteng&gt;</code></p><p>也可以写成大驼峰式：LinDunteng，标签化为<code>&lt;lin-Dunteng&gt;&lt;lin-Dunteng&gt;</code>或者<code>&lt;lin-dunteng&gt;&lt;/lin-dunteng&gt;</code>或者<code>&lt;Lin-dunteng&gt;&lt;/Lin-dunteng&gt;</code>或者<code>&lt;Lin-Dunteng&gt;&lt;/Lin-Dunteng&gt;</code>, 但是不能写成<code>&lt;LinDunteng&gt;&lt;/LinDunteng&gt;</code></p><p>【提醒】不过以上情况是针对.html文件而言的，之后在.vue文件中就没这么多禁忌，相对比较自由宽泛。还有一点就是在.html文件中最好使用双标签，使用单标签可能会有些bug，但是在.vue文件中就没事</p><p>【问题】：为什么组件中的data要通过函数返回对象？</p><p>答：当一个组件被定义， data 必须声明为返回一个初始数据对象的函数，因为组件可能被用来创建多个实例。如果 data 仍然是一个纯粹的对象，则所有的实例将共享引用同一个数据对象！通过提供 data 函数，每次创建一个新实例后，我们能够调用 data 函数，从而返回初始数据的一个全新副本数据对象。</p><p>其实也很好理解，大概意思就是：</p><p>类比与引用数据类型。如果不用function return 每个组件的data都是内存的同一个地址，那一个数据改变其他也改变了，这当然就不是我们想要的。用function return 其实就相当于申明了新的变量，相互独立，自然就不会有这样的问题；js在赋值object对象时，是直接一个相同的内存地址。所以为了每个组件的data独立，采用了这种方式。<br>如果不是组件的话，正常data的写法可以直接写一个对象，比如data：{ msg ： ‘ 下载 ‘ }，但由于组件是会在多个地方引用<br>的，JS中直接共享对象会造成引用传递，也就是说修改了msg后所有按钮的msg都会跟着修改，所以这里用function来每次返回一个对象实例。</p><p><br><br></p><h2 id="局部组件"><a href="#局部组件" class="headerlink" title="局部组件"></a>局部组件</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567511594805.png" alt="1567511594805"></p><p>该局部组件只能在相应的el中使用</p><p><br><br></p><h2 id="动态组件和插槽-v-slot"><a href="#动态组件和插槽-v-slot" class="headerlink" title="动态组件和插槽 v-slot"></a>动态组件和插槽 v-slot</h2><h3 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h3><p>关键为<code>&lt;component :is=&quot;comName&quot;&gt;&lt;/component&gt;</code>和<code>&lt;keep-alive&gt;&lt;/keep-alive&gt;</code></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567668494678.png" alt="1567668494678"></p><p><br><br></p><h3 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h3><p><strong>【匿名插槽】</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567668892295.png" alt="1567668892295"></p><p><br><br></p><p><strong>【具名插槽】</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567669076852.png" alt="1567669076852"></p><p><br><br><strong>【作用域插槽】</strong></p><p>详见F:\渡一前端课\0我的学习\VUE\上课学习代码\Vue全家桶一\09动态组件与插槽\作用域插槽01.html</p><p>和F:\渡一前端课\0我的学习\VUE\上课学习代码\Vue全家桶一\09动态组件与插槽\作用域插槽02.html</p><p>和<a href="https://ke.qq.com/webcourse/index.html#cid=288781&amp;term_id=100342071&amp;taid=2943852189345805&amp;type=1024&amp;vid=l14309p5itq" target="_blank" rel="noopener">https://ke.qq.com/webcourse/index.html#cid=288781&amp;term_id=100342071&amp;taid=2943852189345805&amp;type=1024&amp;vid=l14309p5itq</a></p><p><br><br></p><h2 id="组件传值"><a href="#组件传值" class="headerlink" title="组件传值"></a>组件传值</h2><p>利用属性的方式传值</p><h3 id="组件传递普通的值"><a href="#组件传递普通的值" class="headerlink" title="组件传递普通的值"></a>组件传递普通的值</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567512737130.png" alt="1567512737130"></p><p><br><br></p><h3 id="组件传递data中的值，父组件传值给子组件"><a href="#组件传递data中的值，父组件传值给子组件" class="headerlink" title="组件传递data中的值，父组件传值给子组件"></a>组件传递data中的值，父组件传值给子组件</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567513134224.png" alt="1567513134224"></p><p>以上的<code>props</code>都是一个数组的形式，它还可以写成一个对象的形式，而且有多个属性，看下面的例子 ：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567514346664.png" alt="1567514346664"></p><p>数组和对象这两个引用类型，default需要写成一个函数的形式。</p><p>【一个小练习】：</p><p>F:\渡一前端课\新录制的vue课程资料\15. 组件数据传递&amp;属性校验</p><p><br><br></p><h3 id="多层父传子通信"><a href="#多层父传子通信" class="headerlink" title="多层父传子通信"></a>多层父传子通信</h3><p>【场景】： 父组件要传值给子组件和孙子组件（子组件的子组件）</p><p>####【方案一】两层的父传子通信。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567519232543.png" alt="1567519232543"></p><p><br><br></p><h4 id="【方案二】利用-attrs-来传值"><a href="#【方案二】利用-attrs-来传值" class="headerlink" title="【方案二】利用 $attrs 来传值"></a>【方案二】利用 $attrs 来传值</h4><p>vm.$attrs 包含是组件中未被props注册的属性</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567573718978.png" alt="1567573718978"></p><p>$attrs–继承所有的父组件属性（除了prop注册传递的属性、class 和 style ），一般用在子组件的子元素上。</p><p>在本例中 <code>&lt;my-p :content=&#39;$attrs.content&#39;&gt;&lt;/my-p&gt;</code>得到应用。</p><p>【注意】如果$attrs继承了很多的属性，那么像上栗这样子一个一个在子组件标签中列出来很麻烦，可以直接使用</p><p><code>v-bind=&#39;$attrs&#39;</code>来一次性全部拿到$attrs中的全部属性。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567574861249.png" alt="1567574861249"></p><p>但是我们发现，在html结构中，被props注册传递的属性不会出现，而未被props注册传递的属性会出现，如下图所示：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567574935531.png" alt="1567574935531"></p><p>如何去除呢？</p><p>使用<code>inheritAttrs：false</code>!</p><p>inheritAttrs：默认值true,继承所有的父组件属性（除props的特定绑定）作为普通的HTML特性应用在子组件的根元素上，如果你不希望组件的根元素继承特性设置inheritAttrs: false,但是class属性会继承（<strong>简单的说，inheritAttrs：true 继承除props之外的所有属性；inheritAttrs：false 只继承class属性</strong>）</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567575042562.png" alt="1567575042562"></p><p>像这样子写之后，就大功告成了。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567575099573.png" alt="1567575099573"></p><p><br><br></p><h4 id="【方案三】利用-parent"><a href="#【方案三】利用-parent" class="headerlink" title="【方案三】利用 $parent"></a>【方案三】利用 $parent</h4><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567576385970.png" alt="1567576385970"></p><p>对于$children，是一个数组，因为可以有多个子组件。</p><p>但是这种方法官方不推荐使用，像孙子组件myP中这样多个$parent写起来很不友好。</p><p><br><br></p><h4 id="【方案四】利用provide和inject"><a href="#【方案四】利用provide和inject" class="headerlink" title="【方案四】利用provide和inject"></a>【方案四】利用provide和inject</h4><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567576901607.png" alt="1567576901607"></p><p>在组件中inject拿到的属性和数据是来自provide的，而非data中的。</p><p>虽然很方便却也是不太推荐使用的， 容易使得代码混乱，不知道属性是从何而来的。但是必须知道，面试的时候可以装逼。</p><p><br><br></p><h3 id="子组件向父组件传值"><a href="#子组件向父组件传值" class="headerlink" title="子组件向父组件传值"></a>子组件向父组件传值</h3><h4 id="【方案一】利用-children"><a href="#【方案一】利用-children" class="headerlink" title="【方案一】利用 $children"></a>【方案一】利用 $children</h4><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567579334058.png" alt="1567579334058"></p><p>但是这种方法官方不推荐使用。</p><p><br><br></p><h4 id="【方案二】-利用-refs"><a href="#【方案二】-利用-refs" class="headerlink" title="【方案二】 利用 $refs"></a>【方案二】 利用 $refs</h4><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567581936328.png" alt="1567581936328"></p><p>通过 $refs 获取到了子组件的数据和方法。</p><p><br><br></p><p>####【方案三】$emit</p><p>这是比较常用的方法</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567585452418.png" alt="1567585452418"></p><p>效果如下：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567585482438.png" alt="1567585482438"></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567585581527.png" alt="1567585581527"></p><p><br><br></p><h3 id="兄弟组件之间的传值"><a href="#兄弟组件之间的传值" class="headerlink" title="兄弟组件之间的传值"></a>兄弟组件之间的传值</h3><h4 id="利用事件总线EventBus"><a href="#利用事件总线EventBus" class="headerlink" title="利用事件总线EventBus"></a>利用事件总线EventBus</h4><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567588110311.png" alt="1567588110311"></p><p>【具体实现方式】：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Eventbus=<span class="keyword">new</span> Vue();    </span><br><span class="line">Eventbus.$emit(事件名,数据);    </span><br><span class="line">Eventbus.$on(事件名,data =&gt; &#123;&#125;);</span><br></pre></td></tr></table></figure><p><br><br></p><h3 id="组件双向数据通信"><a href="#组件双向数据通信" class="headerlink" title="组件双向数据通信"></a>组件双向数据通信</h3><p>暂未整理</p><p><br><br><br></p><h1 id="十一、Vue-cli-脚手架"><a href="#十一、Vue-cli-脚手架" class="headerlink" title="十一、Vue-cli 脚手架"></a>十一、Vue-cli 脚手架</h1><h2 id="安装初试"><a href="#安装初试" class="headerlink" title="安装初试"></a>安装初试</h2><p>npm install -g @vue/cli     安装脚手架，用于生成项目，使用指令<code>vue --version</code>查看是否安装成功<br>npm install -g @vue/cli-service-global   快速原型开发，可以直接通过<code>vue serve xxx.vue</code>的指令来编译.vue文件</p><p>如果之前已经安装过旧版本（非3.x）脚手架，需先卸载旧版本：<br>npm uninstall vue-cli -g</p><p>如果仍然需要使用旧版本的 vue init 功能，可以全局安装一个桥接工具：<br>npm install -g @vue/cli-init    拉取旧版本</p><p>插件名字：Vetur（由于vscode并不认识.vue文件，所以没有代码高亮，需要安装Vetur这个插件来弥补</p><p><code>vue create vue-app</code>创建一个vue项目文件夹，叫做vue-app，【注意这里的命令操作最好用cmd执行，git bash有些操作完成不了】。会提示选择一个预设的方案，有default和manually selectfeature，选择后者。然后会有一些配置需要你选择，按空格键进行选择和取消选择，这里只选择Babel。再然后选择<code>In package.json</code>选项，选<img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567834770585.png" alt="1567834770585"></p><ul><li>★ 同时注意使用<code>redirect</code>来重定向到具体的一个子路由路径上，否则一打开“community”路由的时候没有默认的选中子路由，只会显示空白不会显示出具体的子路由页面。</li></ul><ul><li><p>在一级路由.vue文件中继续使用<code>&lt;router-link&gt;</code>和<code>&lt;router-view&gt;</code></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567834990024.png" alt="1567834990024"></p></li></ul><ul><li><p>关于首页路径和<code>router-link-active</code>的优化</p><p>在本例子中路由community的样式是加在<code>router-link-extra-active</code>上的，且匹配的是路径<code>/community</code>，因此路由community的子路由被点击时community的样式没有显现，因为此时的路径变成了<code>/community/xxx</code>没有完全匹配<code>/community</code>。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567836335642.png" alt="1567836335642">因此要把样式加到<code>router-link-active</code>上。但是问题又来了，<code>router-link-active</code>匹配了两个路径<code>/</code>和<code>/community</code></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567836265612.png" alt="1567836265612"></p><p>这样就应该把原本首页匹配的路径由根路径<code>/</code>换成<code>/home</code>。然后又有一个问题，就是我们访问<code>http://localhost:8080</code>的时候无法自动跳转到首页。所以还需要进行一步重定向：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567836714591.png" alt="1567836714591"></p><p>或者还可以这样子使用redirect ( )重定向：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567836792711.png" alt="1567836792711"></p></li><li><p>不存在的路径和优化</p><p>比如不存在该路径<code>http://localhost:8080/gjalhj</code>，对此要将这一切不存在路径同意跳转到某一指定页面</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567837033399.png" alt="1567837033399"></p><p>这里的<code>path: *</code>表示当以上的所有路径都没有匹配的时候，判断路径是否为<code>/</code>，是则重定向到<code>/home</code>，否则重定向到统一的指定页面。</p></li></ul><p><br><br></p><h2 id="router的push、replace和go"><a href="#router的push、replace和go" class="headerlink" title="$router的push、replace和go"></a>$router的push、replace和go</h2><ul><li><p>this.$router.push()</p><p>描述：跳转到不同的url，但这个方法回向history栈添加一个记录，点击后退会返回到上一个页面。</p><p>用法：<img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1568037236fa.jpg" alt=""></p></li></ul><ul><li><p>this.$router.replace()</p><p>描述：同样是跳转到指定的url，但是这个方法不会向history里面添加新的记录，点击返回，会跳转到上上一个页面。上一个记录是不存在的。</p></li><li><p>this.$router.go(n)</p><p>相对于当前页面向前或向后跳转多少个页面,类似 window.history.go(n)。n可为正数可为负数。正数返回上一个页面</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/20180315110305411.png" alt=""></p></li></ul><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567838042925.png" alt="1567838042925"></p><p>-</p><p><br><br></p><h2 id="导航守卫和动态路由"><a href="#导航守卫和动态路由" class="headerlink" title="导航守卫和动态路由"></a><a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB" target="_blank" rel="noopener">导航守卫</a>和动态路由</h2><p>【重要的一节课】F:\渡一前端课\新录制的vue课程资料\28. 导航守卫&amp;动态路由</p><h3 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h3><p>【方案一】使用params：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567850470296.png" alt="1567850470296"></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567850528088.png" alt="1567850528088"></p><p>【方案二】使用query：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567851075014.png" alt="1567851075014"></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567851012789.png" alt="1567851012789"></p><p><br><br></p><h3 id="组件内的守卫"><a href="#组件内的守卫" class="headerlink" title="组件内的守卫"></a>组件内的守卫</h3><p>你可以在路由组件内直接定义以下路由导航守卫：</p><ul><li><code>beforeRouteEnter</code></li><li><code>beforeRouteUpdate</code> (2.2 新增)</li><li><code>beforeRouteLeave</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">  template: <span class="string">`...`</span>,</span><br><span class="line">  beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="comment">// 在渲染该组件的对应路由被 confirm 前调用</span></span><br><span class="line">    <span class="comment">// 不！能！获取组件实例 `this`</span></span><br><span class="line">    <span class="comment">// 因为当守卫执行前，组件实例还没被创建</span></span><br><span class="line">  &#125;,</span><br><span class="line">  beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="comment">// 在当前路由改变，但是该组件被复用时调用</span></span><br><span class="line">    <span class="comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span><br><span class="line">    <span class="comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span><br><span class="line">    <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">  &#125;,</span><br><span class="line">  beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="comment">// 导航离开该组件的对应路由时调用</span></span><br><span class="line">    <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>beforeRouteEnter</code> 守卫 <strong>不能</strong> 访问 <code>this</code>，因为守卫在导航确认前被调用,因此即将登场的新组件还没被创建。</p><p>不过，你可以通过传一个回调给 <code>next</code>来访问组件实例。在导航被确认的时候执行回调，并且把组件实例作为回调方法的参数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">  next(<span class="function"><span class="params">vm</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 通过 `vm` 访问组件实例</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意 <code>beforeRouteEnter</code> 是支持给 <code>next</code> 传递回调的唯一守卫。对于 <code>beforeRouteUpdate</code> 和 <code>beforeRouteLeave</code> 来说，<code>this</code> 已经可用了，所以<strong>不支持</strong>传递回调，因为没有必要了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">  <span class="comment">// just use `this`</span></span><br><span class="line">  <span class="keyword">this</span>.name = to.params.name</span><br><span class="line">  next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个离开守卫通常用来禁止用户在还未保存修改前突然离开。该导航可以通过 <code>next(false)</code> 来取消。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">beforeRouteLeave (to, <span class="keyword">from</span> , next) &#123;</span><br><span class="line">  <span class="keyword">const</span> answer = <span class="built_in">window</span>.confirm(<span class="string">'Do you really want to leave? you have unsaved changes!'</span>)</span><br><span class="line">  <span class="keyword">if</span> (answer) &#123;</span><br><span class="line">    next()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next(<span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>【案例】实现一个功能</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567845124241.png" alt="1567845124241"></p><p>这就要用到导航守卫之<strong>beforeRouterLeave</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567845232834.png" alt="1567845232834"></p><p>相应的还有<strong>beforeRouteEnter</strong> ：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567850373975.png" alt="1567850373975"></p><p><strong>beforeRouteUpdate</strong>：</p><p>★ 这个看视频【F:\渡一前端课\新录制的vue课程资料\28. 导航守卫&amp;动态路由】</p><p><br><br></p><h3 id="路由独享守卫"><a href="#路由独享守卫" class="headerlink" title="路由独享守卫"></a>路由独享守卫</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567926980649.png" alt="1567926980649"></p><p><br><br></p><h3 id="全局前置守卫"><a href="#全局前置守卫" class="headerlink" title="全局前置守卫"></a>全局前置守卫</h3><p>你可以使用 <code>router.beforeEach</code> 注册一个全局前置守卫：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>当一个导航触发时，全局前置守卫按照创建顺序调用。守卫是异步解析执行，此时导航在所有守卫 resolve 完之前一直处于 <strong>等待中</strong>。</p><p>每个守卫方法接收三个参数：</p><ul><li><strong>to: Route</strong>: 即将要进入的目标 <a href="https://router.vuejs.org/zh/api/#%E8%B7%AF%E7%94%B1%E5%AF%B9%E8%B1%A1" target="_blank" rel="noopener">路由对象</a></li><li><strong>from: Route</strong>: 当前导航正要离开的路由</li><li><strong>next: Function</strong>: 一定要调用该方法来 <strong>resolve</strong> 这个钩子。执行效果依赖 <code>next</code> 方法的调用参数。<ul><li><strong>next()</strong>: 进行管道中的下一个钩子。如果全部钩子执行完了，则导航的状态就是 <strong>confirmed</strong> (确认的)。</li><li><strong>next(false)</strong>: 中断当前的导航。如果浏览器的 URL 改变了 (可能是用户手动或者浏览器后退按钮)，那么 URL 地址会重置到 <code>from</code> 路由对应的地址。</li><li><strong>next(‘/‘) 或者 next({ path: ‘/‘ })</strong>: 跳转到一个不同的地址。当前的导航被中断，然后进行一个新的导航。你可以向 <code>next</code> 传递任意位置对象，且允许设置诸如 <code>replace: true</code>、<code>name: &#39;home&#39;</code> 之类的选项以及任何用在 <a href="https://router.vuejs.org/zh/api/#to" target="_blank" rel="noopener"><code>router-link</code> 的 <code>to</code> prop</a> 或 <a href="https://router.vuejs.org/zh/api/#router-push" target="_blank" rel="noopener"><code>router.push</code></a> 中的选项。</li><li><strong>next(error)</strong>: (2.4.0+) 如果传入 <code>next</code> 的参数是一个 <code>Error</code> 实例，则导航会被终止且该错误会被传递给 <a href="https://router.vuejs.org/zh/api/#router-onerror" target="_blank" rel="noopener"><code>router.onError()</code></a> 注册过的回调。</li></ul></li></ul><p><strong>确保要调用 next 方法，否则钩子就不会被 resolved。</strong></p><p><br><br></p><h3 id="全局解析守卫"><a href="#全局解析守卫" class="headerlink" title="全局解析守卫"></a>全局解析守卫</h3><blockquote><p>2.5.0 新增</p></blockquote><p>在 2.5.0+ 你可以用 <code>router.beforeResolve</code> 注册一个全局守卫。这和 <code>router.beforeEach</code> 类似，区别是在导航被确认之前，<strong>同时在所有组件内守卫和异步路由组件被解析之后</strong>，解析守卫就被调用。</p><p><br><br></p><h3 id="全局后置钩子"><a href="#全局后置钩子" class="headerlink" title="全局后置钩子"></a>全局后置钩子</h3><p>你也可以注册全局后置钩子，然而和守卫不同的是，这些钩子不会接受 <code>next</code> 函数也不会改变导航本身：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.afterEach(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567928081876.png" alt="1567928081876"></p><p><br><br></p><h3 id="导航守卫小汇总"><a href="#导航守卫小汇总" class="headerlink" title="导航守卫小汇总"></a>导航守卫小汇总</h3><ol><li><strong>全局守卫</strong></li></ol><ul><li><p>beforeEach</p></li><li><p>beforeResolve</p></li><li><p>afterEach</p></li></ul><ol start="2"><li><strong>路由独享守卫</strong></li></ol><ul><li>beforeEnter</li></ul><ol start="3"><li><strong>组件内守卫</strong></li></ol><ul><li><p>beforeRouteLeave 当离开这个路径时执行</p></li><li><p>beforeRouteEnter </p></li><li><p>beforeRouteUpdate mounted</p></li></ul><p>   进入某一个路径时，执行顺序</p><p>- beforeEach -&gt; beforeEnter -&gt; beforeRouteEnter -&gt; beforeResolve -&gt; afterEach </p><p><br></p><h3 id="完整的导航解析流程"><a href="#完整的导航解析流程" class="headerlink" title="完整的导航解析流程"></a>完整的导航解析流程</h3><ol><li>导航被触发。</li><li>在失活的组件里调用离开守卫。</li><li>调用全局的 <code>beforeEach</code> 守卫。</li><li>在重用的组件里调用 <code>beforeRouteUpdate</code> 守卫 (2.2+)。</li><li>在路由配置里调用 <code>beforeEnter</code>。</li><li>解析异步路由组件。</li><li>在被激活的组件里调用 <code>beforeRouteEnter</code>。</li><li>调用全局的 <code>beforeResolve</code> 守卫 (2.5+)。</li><li>导航被确认。</li><li>调用全局的 <code>afterEach</code> 钩子。</li><li>触发 DOM 更新。</li><li>用创建好的实例调用 <code>beforeRouteEnter</code> 守卫中传给 <code>next</code> 的回调函数。</li></ol><p><br><br></p><h2 id="路由元信息"><a href="#路由元信息" class="headerlink" title="路由元信息"></a>路由元信息</h2><p>定义路由的时候可以配置 <code>meta</code> 字段：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/foo'</span>,</span><br><span class="line">      component: Foo,</span><br><span class="line">      children: [</span><br><span class="line">        &#123;</span><br><span class="line">          path: <span class="string">'bar'</span>,</span><br><span class="line">          component: Bar,</span><br><span class="line">          <span class="comment">// a meta field</span></span><br><span class="line">          meta: &#123; <span class="attr">requiresAuth</span>: <span class="literal">true</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>那么如何访问这个 <code>meta</code> 字段呢？</p><p>首先，我们称呼 <code>routes</code> 配置中的每个路由对象为 <strong>路由记录</strong>。路由记录可以是嵌套的，因此，当一个路由匹配成功后，他可能匹配多个路由记录</p><p>例如，根据上面的路由配置，<code>/foo/bar</code> 这个 URL 将会匹配父路由记录以及子路由记录。</p><p>一个路由匹配到的所有路由记录会暴露为 <code>$route</code> 对象 (还有在导航守卫中的路由对象) 的 <code>$route.matched</code> 数组。因此，我们需要遍历 <code>$route.matched</code> 来检查路由记录中的 <code>meta</code> 字段。</p><p>下面例子展示在全局导航守卫中检查元字段：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.matched.some(<span class="function"><span class="params">record</span> =&gt;</span> record.meta.requiresAuth)) &#123;</span><br><span class="line">    <span class="comment">// this route requires auth, check if logged in</span></span><br><span class="line">    <span class="comment">// if not, redirect to login page.</span></span><br><span class="line">    <span class="keyword">if</span> (!auth.loggedIn()) &#123;</span><br><span class="line">      next(&#123;</span><br><span class="line">        path: <span class="string">'/login'</span>,</span><br><span class="line">        query: &#123; <span class="attr">redirect</span>: to.fullPath &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      next()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next() <span class="comment">// 确保一定要调用 next()</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>【案例】实现用户登录后才有查看内容权限，仍然基于上面的程序，要求用户登录后才可以查看“学员展示”和”社区“</p><p>★★★ F:\渡一前端课\新录制的vue课程资料\30. 路由元信息</p><p><br><br><br></p><h1 id="十三、Vuex"><a href="#十三、Vuex" class="headerlink" title="十三、Vuex"></a>十三、Vuex</h1><h2 id="state、getters、mutations、actions"><a href="#state、getters、mutations、actions" class="headerlink" title="state、getters、mutations、actions"></a>state、getters、mutations、actions</h2><p>详见我的完整笔记：</p><p><a href="https://github.com/Dunteng/learnVue/tree/master/%E5%AD%A6%E4%B9%A0Vuex#%E6%9C%AC%E6%96%87%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">https://github.com/Dunteng/learnVue/tree/master/%E5%AD%A6%E4%B9%A0Vuex#%E6%9C%AC%E6%96%87%E4%BB%A3%E7%A0%81</a></p><p><br><br></p><h2 id="vuex-module"><a href="#vuex-module" class="headerlink" title="vuex module"></a>vuex module</h2><p>【F:\渡一前端课\新录制的vue课程资料\33. vuex mutation&amp;action\src】</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567958712382.png" alt="1567958712382"></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vue/1567958795682.png" alt="1567958795682"></p><p>注意到在此，使用的 vuex state都是存放关于 “学员展示” 模块的，一旦其他板块如 “课程学习” “社区” 等也需要用到 vuex ， 那么一大堆的数据都堆积到state中，这样就很庞大很杂乱，不好维护和管理，<strong>因此需要分模块用到 vuex module</strong>。</p><h3 style="color:red;">★★★★★ 看代码【F:\渡一前端课\新录制的vue课程资料\34. vuex module\src】</h3><p> <strong>modules</strong></p><ul><li><p>根据功能让vuex分出模块</p></li><li><p>state会放入到每一个模块下，getters、mutations、actions会直接放入到全局</p><p><strong>获取vuex中的数据（无namespaced）</strong></p></li><li><p>获取state : this.$store.state.moduleName.xxx</p></li><li><p>获取getters： this.$store.getters.xxx</p></li><li><p>获取mutations： this.$store.commit(‘xxx’)</p></li><li><p>获取actions： this.$store.dispatch(‘xxx’)</p></li><li><p>可以通过mapXXX 方式拿到getters、mutations、action，但是不能拿到state，如果想通过这种方式获取state，需要加命名空间：namespaced：true</p><p><strong>获取vuex中的数据（有namespaced）</strong></p></li><li><p>获取state : this.$store.state.moduleName.xxx</p></li><li><p>获取getters： this.$store[‘moduleName/getters’].xxx</p></li><li><p>获取mutations： this.$store.commit(‘moduleName/xxx’)</p></li><li><p>获取actions： this.$store.dispatch(‘moduleName/xxx’)</p></li><li><p>可以通过mapXXX: mapXXX(‘moduleName’, [‘xxx’])  mapXXX(‘moduleName’, {})</p></li></ul><p><br><br><br></p><h1 id="十四、跨域"><a href="#十四、跨域" class="headerlink" title="十四、跨域"></a>十四、跨域</h1><h1 id="十五、网络请求axios"><a href="#十五、网络请求axios" class="headerlink" title="十五、网络请求axios"></a>十五、网络请求axios</h1><p>参考：</p><ul><li><a href="https://www.kancloud.cn/yunye/axios/234845" target="_blank" rel="noopener">https://www.kancloud.cn/yunye/axios/234845</a></li><li>王红元老师的<a href="https://www.bilibili.com/video/av67171816/?p=146" target="_blank" rel="noopener">vue课程</a></li></ul><p>axios 是 Vue 作者尤雨溪推荐的官方 ajax 库。有一下主要功能特点：</p><ul><li>在浏览器中发送 XMLHttpRequest 请求</li><li>在 node.js 中发送 http 请求</li><li>支持 Promise API</li><li>拦截请求和响应</li><li>转化请求和响应数据</li></ul><p><br></p><p>先安装：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios --save</span><br></pre></td></tr></table></figure><p>再引入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br></pre></td></tr></table></figure><p>发送请求：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">  url: <span class="string">"http://123.207.32.32:8000/home/multidata"</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>以上没有指定 GET 请求还是 POST 请求，只传了一个 url ，默认为 GET 请求。</p><p><br></p><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>执行 <code>GET</code> 请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为给定 ID 的 user 创建请求</span></span><br><span class="line">axios.get(<span class="string">'/user?ID=12345'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选地，上面的请求可以这样做</span></span><br><span class="line">axios.get(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      ID: <span class="number">12345</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>执行 <code>POST</code> 请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.post(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>执行多个<strong>并发请求</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserAccount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserPermissions</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345/permissions'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">axios.all([getUserAccount(), getUserPermissions()])</span><br><span class="line">    .then(axios.spread(<span class="function">(<span class="params">res1, res2</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res1);</span><br><span class="line">    <span class="built_in">console</span>.log(res2);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/vue/1568962541144.png" alt="1568962541144"></p><p><br></p><h2 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h2><p>看下面的例子</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/vue/1568962967595.png" alt="1568962967595"></p><p>这里面的 baseURL 和 timeout 存在冗余，可以将其再全局配置中写好。事实上，在开发中可能很多参数都是固定的，这时候我们可以进行一些抽取，也可以利用axios的全局配置。</p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/vue/1568963218053.png" alt="1568963218053"></p><p>类似的还有</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>]=<span class="string">'application/x-www-form-urlencoded'</span></span><br></pre></td></tr></table></figure><p>还有其他配置选项，我就不一一列出来了。</p><p><br></p><h2 id="axios-的实例使用"><a href="#axios-的实例使用" class="headerlink" title="axios 的实例使用"></a>axios 的实例使用</h2><p>像上面的几个例子都是直接使用 axios ，但是有时候这样子直接使用 axios 是不合适的。</p><p>比如，我们的项目并非只是在 baseURL=“<a href="http://aaaa:8000”，而是还有多个" target="_blank" rel="noopener">http://aaaa:8000”，而是还有多个</a> baseURL，那么这时候如果直接用 axios 来配置 baseURL 和其他的相关配置，就实现不了了，所以可以使用 axios 的实例，使用实例就可以避免这样的问题。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个axios的实例 instance1</span></span><br><span class="line"><span class="keyword">const</span> instance1 = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'http://123.123.123.12:8000'</span>,</span><br><span class="line">  timeout: <span class="number">5000</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 使用instance1实例</span></span><br><span class="line">instance1(&#123;</span><br><span class="line">  url: <span class="string">'/home/multidata'</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个axios实例 instance2</span></span><br><span class="line"><span class="keyword">const</span> instance2 = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'http://456.123.123.12:8000'</span>,</span><br><span class="line">  timeout: <span class="number">5000</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 使用instance2实例</span></span><br><span class="line">instance2(&#123;</span><br><span class="line">  url: <span class="string">'/home/multidata'</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br></p><h2 id="axios-封装代码"><a href="#axios-封装代码" class="headerlink" title="axios 封装代码"></a>axios 封装代码</h2><p>假设项目中有十处组件要用到 axios 来请求数据，那么我们可能需要引入 axios 十次，如果有五十次要用到就要引入五十次。万一某天 axios 挂掉了或者不再维护了，那么我们的项目就要大改了，每次用到 axios 的地方都要重新编写，五十次就够呛了，大型项目的话直接扑街。</p><p>所以在实际开发中，一定要有意识的封装 axios 代码，比如我们在 <code>src/network/request.js</code>中对 axios 进行了封装，对外导出实例<code>request</code>，在进行数据请求的时候就可以使用封装好的<code>request</code>而不是直接使用 axios，这样一来，如果以后要更换技术或者修改，就不用每处地方都进行修改，只要该封装代码<code>request</code>就可以了。</p><p>下面开始进行封装：</p><h3 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//   src/network/request.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config, success, failure</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 创建axios的实例</span></span><br><span class="line">    <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">        baseURL: <span class="string">' https://easy-mock.com/mock/5c88abff4c25252b7c484888/magazine'</span>,</span><br><span class="line">        timeout: <span class="number">5000</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送网络请求,使用回调函数来处理数据</span></span><br><span class="line">    instance(config).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        success(res)</span><br><span class="line">    &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        failure(err)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; request &#125; <span class="keyword">from</span> <span class="string">'./network/request'</span></span><br><span class="line"></span><br><span class="line">request(&#123;</span><br><span class="line">  url: <span class="string">'/home'</span></span><br><span class="line">&#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;,</span><br><span class="line">  err =&gt; &#123;   </span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><br></p><h3 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 创建axios的实例</span></span><br><span class="line">    <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">        baseURL: <span class="string">' https://easy-mock.com/mock/5c88abff4c25252b7c484888/magazine'</span>,</span><br><span class="line">        timeout: <span class="number">5000</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送真正的网络请求</span></span><br><span class="line">    instance(config.baseConfig).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        config.success(res)</span><br><span class="line">    &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        config.failure(err)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; request &#125; <span class="keyword">from</span> <span class="string">'./network/request'</span></span><br><span class="line"></span><br><span class="line">request(&#123;</span><br><span class="line">  baseConfig: &#123;</span><br><span class="line">    url: <span class="string">'/home'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">  &#125;,</span><br><span class="line">  failure: <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><br></p><h3 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h3><p><strong>Promise化</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 返回一个Promise</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">            baseURL: <span class="string">' http://www.liulongbin.top:3005'</span>,</span><br><span class="line">            timeout: <span class="number">5000</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        instance(config).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(res)</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            reject(err)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>调用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; request &#125; <span class="keyword">from</span> <span class="string">'./network/request'</span></span><br><span class="line"></span><br><span class="line">request(&#123;</span><br><span class="line">  url: <span class="string">'/api/getlunbo'</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br></p><h3 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h3><p>上面封装成 Promise 的版本还不是最好的，事实上<code>instance(config)</code>所返回的就是一个 <strong>Promise</strong>，因此可以不必再去封装成 Promise ，直接将 <code>instance(config)</code>返回出来即可：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 返回一个Promise</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">        baseURL: <span class="string">' http://www.liulongbin.top:3005'</span>,</span><br><span class="line">        timeout: <span class="number">5000</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> instance(config)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; request &#125; <span class="keyword">from</span> <span class="string">'./network/request'</span></span><br><span class="line"></span><br><span class="line">request(&#123;</span><br><span class="line">  url: <span class="string">'/api/getlunbo'</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><p>在请求或响应被 <code>then</code> 或 <code>catch</code> 处理前拦截它们。</p><p>一般有以下业务场景：</p><ul><li>当config中的一些信息不符合服务器要求，可以在发送请求之前拦截之并进行修改</li><li>每次发送网络请求时，在界面中触发加载动画，响应完成时关闭加载动画</li><li>某些网络请求（比如登录的token），必须携带一些特殊的信息</li><li>等等等</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加请求拦截器</span></span><br><span class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 在发送请求之前做些什么</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对请求错误做些什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加响应拦截器</span></span><br><span class="line">axios.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对响应数据做点什么</span></span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对响应错误做点什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>如果你想在稍后移除拦截器，可以这样：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myInterceptor = axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="comment">/*...*/</span>&#125;);</span><br><span class="line">axios.interceptors.request.eject(myInterceptor);</span><br></pre></td></tr></table></figure><p>可以为自定义 axios 实例添加拦截器</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> instance = axios.create();</span><br><span class="line">instance.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="comment">/*...*/</span>&#125;);</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 返回一个Promise</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">        baseURL: <span class="string">' http://www.liulongbin.top:3005'</span>,</span><br><span class="line">        timeout: <span class="number">5000</span></span><br><span class="line">    &#125;)</span><br><span class="line">    instance.interceptors.request.use(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(config);<span class="comment">//拦截config进行处理，这里将其打印出来，这里的config实际上就是上面的config</span></span><br><span class="line">        <span class="keyword">return</span> config  <span class="comment">//这里必须return config以取消拦截，否则之后无法响应成功</span></span><br><span class="line">    &#125;, err =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    instance.interceptors.response.use(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res);<span class="comment">//拦截res进行处理，这里将其打印出来</span></span><br><span class="line">        <span class="keyword">return</span> res.data<span class="comment">//这里必须return res.data以取消拦截，否则之后无法响应成功</span></span><br><span class="line">    &#125;, err =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> instance(config)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一、博客项目大作战之数据库建表</title>
      <link href="/2019/08/09/%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE01.html"/>
      <url>/2019/08/09/%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE01.html</url>
      
        <content type="html"><![CDATA[<h2 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h2><p><img src="https://pic3.zhimg.com/v2-56d60579638b9a59ede77fb0fa3ecd2a_r.jpg" alt=""></p><p><br></p><h2 id="持久层之数据库建表"><a href="#持久层之数据库建表" class="headerlink" title="持久层之数据库建表"></a>持久层之数据库建表</h2><p>创建数据库<strong>my_blog</strong>👇</p><p><img src="https://pic3.zhimg.com/v2-5cc8b67e76935f8d3ac1152b3835f902_r.jpg" alt=""></p><p><br></p><p>创建表<strong>blog</strong>👇</p><p>用于存储博客文章，特别注意要设置编码格式为<strong>utf8mb4</strong>，否则emoji无法正常显示。</p><p><code>views</code>为文章浏览次数，<code>ctime</code>为创建时间，<code>utime</code>为修改时间。</p><p><img src="https://pic4.zhimg.com/v2-c29c1a6cfbae94644e9e9be24fc76467_r.jpg" alt=""></p><p>设置表的索引👇</p><p><img src="https://pic3.zhimg.com/v2-2e8103ce4cd64220a21c6fd873fc0cfe_r.jpg" alt=""></p><p><br></p><p>创建表<strong>every_day</strong>👇</p><p><img src="https://pic4.zhimg.com/v2-b6b7376a12907be6eecf759fd2f2af77_r.jpg" alt=""></p><p>设置索引👇</p><p><img src="https://pic3.zhimg.com/v2-0f8fc5b1803ee14ddee30b2941e9f172_r.jpg" alt=""></p><p><br></p><p>创建表tags👇</p><p><img src="https://pic2.zhimg.com/v2-2e9839df691ec4ea2714bd28a9968fed_r.jpg" alt=""></p><p>设置索引👇</p><p><img src="https://pic1.zhimg.com/v2-1f699976957e423bc457d1251d4f1c84_r.jpg" alt=""></p><p><br></p><p>创建表tag_blog_mapping（tags和blog之间的映射表）👇</p><p><img src="https://pic3.zhimg.com/v2-0da154a08d9edc56cd79313b5ed2419e_r.jpg" alt=""></p><p>设置索引👇</p><p><img src="https://pic2.zhimg.com/v2-57572abfa8a419ba3b66a943cb10bb89_r.jpg" alt=""></p><p><br></p><p>创建表comments👇</p><p><img src="https://pic4.zhimg.com/v2-4d74bfe8b3e17764cdb3f9b169adf35f_r.jpg" alt=""></p><p>设置索引👇</p><p><img src="https://pic2.zhimg.com/v2-56e73521abea3d3b2fe61889ff4f082d_r.jpg" alt=""></p><p><br><br></p><p>博客项目的数据库表基本创建完成。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> 项目 </tag>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vi编辑器教程</title>
      <link href="/2019/08/08/vi%E2%80%94%E7%BB%88%E7%AB%AF%E4%B8%AD%E7%9A%84%E7%BC%96%E8%BE%91%E5%99%A8.html"/>
      <url>/2019/08/08/vi%E2%80%94%E7%BB%88%E7%AB%AF%E4%B8%AD%E7%9A%84%E7%BC%96%E8%BE%91%E5%99%A8.html</url>
      
        <content type="html"><![CDATA[<h1 id="vi-——-终端中的编辑器"><a href="#vi-——-终端中的编辑器" class="headerlink" title="vi —— 终端中的编辑器"></a><code>vi</code> —— 终端中的编辑器</h1><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ul><li><code>vi</code> 简介</li><li>打开和新建文件</li><li>三种工作模式</li><li>常用命令</li><li>分屏命令</li><li>常用命令速查图</li></ul><h2 id="01-vi-简介"><a href="#01-vi-简介" class="headerlink" title="01. vi 简介"></a>01. <code>vi</code> 简介</h2><h3 id="1-1-学习-vi-的目的"><a href="#1-1-学习-vi-的目的" class="headerlink" title="1.1 学习 vi 的目的"></a>1.1 学习 <code>vi</code> 的目的</h3><ul><li>在工作中，要对 <strong>服务器</strong> 上的文件进行 <strong>简单</strong> 的修改，可以使用 <code>ssh</code> 远程登录到服务器上，并且使用 <code>vi</code> 进行快速的编辑即可</li><li>常见需要修改的文件包括：<ul><li><strong>源程序</strong></li><li><strong>配置文件</strong>，例如 <code>ssh</code> 的配置文件 <code>~/.ssh/config</code></li></ul></li></ul><blockquote><ul><li>在没有图形界面的环境下，要编辑文件，<code>vi</code> 是最佳选择！</li><li>每一个要使用 Linux 的程序员，都应该或多或少的学习一些 <code>vi</code> 的常用命令</li></ul></blockquote><h3 id="1-2-vi-和-vim"><a href="#1-2-vi-和-vim" class="headerlink" title="1.2 vi 和 vim"></a>1.2 vi 和 vim</h3><ul><li>在很多 <code>Linux</code> 发行版中，直接把 <code>vi</code> 做成 <code>vim</code> 的软连接</li></ul><h4 id="vi"><a href="#vi" class="headerlink" title="vi"></a>vi</h4><ul><li><code>vi</code> 是 <code>Visual interface</code> 的简称，是 <code>Linux</code> 中 <strong>最经典</strong> 的文本编辑器</li><li><code>vi</code> 的核心设计思想 —— <strong>让程序员的手指始终保持在键盘的核心区域，就能完成所有的编辑操作</strong></li></ul><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vi/001_vi%E9%94%AE%E7%9B%98.png" alt="001_vi键盘-w551"></p><ul><li><code>vi</code> 的特点：<ul><li><strong>没有图形界面</strong> 的 <strong>功能强大</strong> 的编辑器</li><li>只能是编辑 <strong>文本内容</strong>，不能对字体、段落进行排版</li><li><strong>不支持鼠标操作</strong></li><li><strong>没有菜单</strong></li><li><strong>只有命令</strong></li></ul></li><li><code>vi</code> 编辑器在 <strong>系统管理</strong>、<strong>服务器管理</strong> 编辑文件时，<strong>其功能永远不是图形界面的编辑器能比拟的</strong></li></ul><h4 id="vim"><a href="#vim" class="headerlink" title="vim"></a><code>vim</code></h4><p><strong>vim = vi improved</strong></p><ul><li><code>vim</code> 是从 <code>vi</code> 发展出来的一个文本编辑器，支持 <strong>代码补全</strong>、<strong>编译</strong> 及 <strong>错误跳转</strong> 等方便编程的功能特别丰富，在程序员中被广泛使用，被称为 <strong>编辑器之神</strong></li></ul><h4 id="查询软连接命令（知道）"><a href="#查询软连接命令（知道）" class="headerlink" title="查询软连接命令（知道）"></a>查询软连接命令（知道）</h4><ul><li>在很多 <code>Linux</code> 发行版中直接把 <code>vi</code> 做成 <code>vim</code> 的软连接</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找 vi 的运行文件</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">which</span> vi</span><br><span class="line">$ ls -l /usr/bin/vi</span><br><span class="line">$ ls -l /etc/alternatives/vi</span><br><span class="line">$ ls -l /usr/bin/vim.basic</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找 vim 的运行文件</span></span><br><span class="line">$ <span class="built_in">which</span> vim</span><br><span class="line">$ ls -l /usr/bin/vim</span><br><span class="line">$ ls -l /etc/alternatives/vim</span><br><span class="line">$ ls -l /usr/bin/vim.basic</span><br></pre></td></tr></table></figure><h2 id="02-打开和新建文件"><a href="#02-打开和新建文件" class="headerlink" title="02. 打开和新建文件"></a>02. 打开和新建文件</h2><ul><li>在终端中输入 <code>vi</code> <strong>在后面跟上文件名</strong> 即可</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi 文件名</span><br></pre></td></tr></table></figure><ul><li>如果文件已经存在，会直接打开该文件</li><li>如果文件不存在，会新建一个文件</li></ul><h3 id="2-1-打开文件并且定位行"><a href="#2-1-打开文件并且定位行" class="headerlink" title="2.1 打开文件并且定位行"></a>2.1 打开文件并且定位行</h3><ul><li>在日常工作中，有可能会遇到 <strong>打开一个文件，并定位到指定行</strong> 的情况</li><li><p>例如：在开发时，<strong>知道某一行代码有错误</strong>，可以 <strong>快速定位</strong> 到出错代码的位置</p></li><li><p>这个时候，可以使用以下命令打开文件</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi 文件名 +行数</span><br></pre></td></tr></table></figure><blockquote><p>提示：如果只带上 <code>+</code> 而不指定行号，会直接定位到文件末尾</p></blockquote><h3 id="2-2-异常处理"><a href="#2-2-异常处理" class="headerlink" title="2.2 异常处理"></a>2.2 异常处理</h3><ul><li>如果 <code>vi</code> 异常退出，在磁盘上可能会保存有 <strong>交换文件</strong></li><li>下次再使用 <code>vi</code> 编辑该文件时，会看到以下屏幕信息，按下字母 <code>d</code> 可以 <strong>删除交换文件</strong> 即可</li></ul><blockquote><p>提示：按下键盘时，注意关闭输入法</p></blockquote><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vi/002_%E5%88%A0%E9%99%A4%E4%BA%A4%E6%8D%A2%E6%96%87%E4%BB%B6.png" alt="002_删除交换文件-w1048"></p><h2 id="03-三种工作模式"><a href="#03-三种工作模式" class="headerlink" title="03. 三种工作模式"></a>03. 三种工作模式</h2><ul><li><p><code>vi</code> 有三种基本工作模式：</p><ol><li><strong>命令模式</strong><ul><li><strong>打开文件首先进入命令模式</strong>，是使用 <code>vi</code> 的 <strong>入口</strong></li><li>通过 <strong>命令</strong> 对文件进行常规的编辑操作，例如：<strong>定位</strong>、<strong>翻页</strong>、<strong>复制</strong>、<strong>粘贴</strong>、<strong>删除</strong>……</li><li>在其他图形编辑器下，通过 <strong>快捷键</strong> 或者 <strong>鼠标</strong> 实现的操作，都在 <strong>命令模式</strong> 下实现</li></ul></li><li><strong>末行模式</strong> —— 执行 <strong>保存</strong>、<strong>退出</strong> 等操作 <ul><li>要退出 <code>vi</code> 返回到控制台，需要在末行模式下输入命令</li><li><strong>末行模式</strong> 是 <code>vi</code> 的 <strong>出口</strong></li></ul></li><li><strong>编辑模式</strong> —— 正常的编辑文字</li></ol></li></ul><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vi/003_vi%E7%9A%84%E6%A8%A1%E5%BC%8F.png" alt="003_vi的模式-w500"></p><blockquote><p>提示：在 <code>Touch Bar</code> 的 Mac 电脑上 ，按 <code>ESC</code> 不方便，可以使用 <code>CTRL + [</code> 替代</p></blockquote><h3 id="末行模式命令"><a href="#末行模式命令" class="headerlink" title="末行模式命令"></a>末行模式命令</h3><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">w</td><td style="text-align:center">write</td><td>保存</td></tr><tr><td style="text-align:center">q</td><td style="text-align:center">quit</td><td>退出，如果没有保存，不允许退出</td></tr><tr><td style="text-align:center">q!</td><td style="text-align:center">quit</td><td>强行退出，不保存退出</td></tr><tr><td style="text-align:center">wq</td><td style="text-align:center">write &amp; quit</td><td>保存并退出</td></tr><tr><td style="text-align:center">x</td><td style="text-align:center"></td><td>保存并退出</td></tr></tbody></table><h2 id="04-常用命令"><a href="#04-常用命令" class="headerlink" title="04. 常用命令"></a>04. 常用命令</h2><h3 id="命令线路图"><a href="#命令线路图" class="headerlink" title="命令线路图"></a>命令线路图</h3><ol start="0"><li>重复次数<ul><li>在命令模式下，<strong>先输入一个数字</strong>，<strong>再跟上一个命令</strong>，可以让该命令 <strong>重复执行指定次数</strong> </li></ul></li><li>移动和选择（<strong>多练</strong>）<ul><li><code>vi</code> 之所以快，关键在于 <strong>能够快速定位到要编辑的代码行</strong></li><li><strong>移动命令</strong> 能够 和 <strong>编辑操作</strong> 命令 <strong>组合使用</strong></li></ul></li><li>编辑操作<ul><li><strong>删除</strong>、<strong>复制</strong>、<strong>粘贴</strong>、<strong>替换</strong>、<strong>缩排</strong></li></ul></li><li>撤销和重复</li><li>查找替换</li><li>编辑</li></ol><h4 id="学习提示"><a href="#学习提示" class="headerlink" title="学习提示"></a>学习提示</h4><ol><li><code>vi</code> 的命令较多，<strong>不要期望一下子全部记住</strong>，个别命令忘记了，只是会影响编辑速度而已</li><li>在使用 <code>vi</code> 命令时，注意 <strong>关闭中文输入法</strong></li></ol><h3 id="4-1-移动（基本）"><a href="#4-1-移动（基本）" class="headerlink" title="4.1 移动（基本）"></a>4.1 移动（基本）</h3><ul><li>要熟练使用 <code>vi</code>，首先应该学会怎么在 <strong>命令模式</strong> 下样快速移动光标</li><li><strong>编辑操作命令</strong>，能够和 <strong>移动命令</strong> 结合在一起使用</li></ul><h4 id="1-上、下、左、右"><a href="#1-上、下、左、右" class="headerlink" title="1) 上、下、左、右"></a>1) 上、下、左、右</h4><table><thead><tr><th style="text-align:center">命令</th><th>功能</th><th style="text-align:center">手指</th></tr></thead><tbody><tr><td style="text-align:center">h</td><td>向左</td><td style="text-align:center">食指</td></tr><tr><td style="text-align:center">j</td><td>向下</td><td style="text-align:center">食指</td></tr><tr><td style="text-align:center">k</td><td>向上</td><td style="text-align:center">中指</td></tr><tr><td style="text-align:center">l</td><td>向右</td><td style="text-align:center">无名指</td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vi/005_%E7%A7%BB%E5%8A%A8%E5%85%89%E6%A0%87.png" alt="005_移动光标-w551"></p><h4 id="2-行内移动"><a href="#2-行内移动" class="headerlink" title="2) 行内移动"></a>2) 行内移动</h4><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">w</td><td style="text-align:center">word</td><td>向后移动一个单词</td></tr><tr><td style="text-align:center">b</td><td style="text-align:center">back</td><td>向前移动一个单词</td></tr><tr><td style="text-align:center">0</td><td style="text-align:center"></td><td>行首</td></tr><tr><td style="text-align:center">^</td><td style="text-align:center"></td><td>行首，第一个不是空白字符的位置</td></tr><tr><td style="text-align:center">$</td><td style="text-align:center"></td><td>行尾</td></tr></tbody></table><h4 id="3-行数移动"><a href="#3-行数移动" class="headerlink" title="3) 行数移动"></a>3) 行数移动</h4><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">gg</td><td style="text-align:center">go</td><td>文件顶部</td></tr><tr><td style="text-align:center">G</td><td style="text-align:center">go</td><td>文件末尾</td></tr><tr><td style="text-align:center">数字gg</td><td style="text-align:center">go</td><td>移动到 数字 对应行数</td></tr><tr><td style="text-align:center">数字G</td><td style="text-align:center">go</td><td>移动到 数字 对应行数</td></tr><tr><td style="text-align:center">:数字</td><td style="text-align:center"></td><td>移动到 数字 对应行数</td></tr></tbody></table><h4 id="4-屏幕移动"><a href="#4-屏幕移动" class="headerlink" title="4) 屏幕移动"></a>4) 屏幕移动</h4><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">Ctrl + b</td><td style="text-align:center">back</td><td>向上翻页</td></tr><tr><td style="text-align:center">Ctrl + f</td><td style="text-align:center">forward</td><td>向下翻页</td></tr><tr><td style="text-align:center">H</td><td style="text-align:center">Head</td><td>屏幕顶部</td></tr><tr><td style="text-align:center">M</td><td style="text-align:center">Middle</td><td>屏幕中间</td></tr><tr><td style="text-align:center">L</td><td style="text-align:center">Low</td><td>屏幕底部</td></tr></tbody></table><h3 id="4-2-移动（程序）"><a href="#4-2-移动（程序）" class="headerlink" title="4.2 移动（程序）"></a>4.2 移动（程序）</h3><h4 id="1-段落移动"><a href="#1-段落移动" class="headerlink" title="1) 段落移动"></a>1) 段落移动</h4><ul><li><code>vi</code> 中使用 空行 来区分段落</li><li>在程序开发时，通常 <strong>一段功能相关的代码会写在一起</strong> —— 之间没有空行</li></ul><table><thead><tr><th style="text-align:center">命令</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">{</td><td>上一段</td></tr><tr><td style="text-align:center">}</td><td>下一段</td></tr></tbody></table><h4 id="2-括号切换"><a href="#2-括号切换" class="headerlink" title="2) 括号切换"></a>2) 括号切换</h4><ul><li>在程序世界中，<code>()</code>、<code>[]</code>、<code>{}</code> 使用频率很高，而且 <strong>都是成对出现的</strong></li></ul><table><thead><tr><th style="text-align:center">命令</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">%</td><td>括号匹配及切换</td></tr></tbody></table><h4 id="3-标记"><a href="#3-标记" class="headerlink" title="3) 标记"></a>3) 标记</h4><ul><li>在开发时，某一块代码可能<strong>需要稍后处理</strong>，例如：编辑、查看</li><li>此时先使用 <code>m</code> 增加一个标记，这样可以 <strong>在需要时快速地跳转回来</strong> 或者 <strong>执行其他编辑操作</strong></li><li><strong>标记名称</strong> 可以是 <code>a~z</code> 或者 <code>A~Z</code> 之间的任意 <strong>一个</strong> 字母</li><li>添加了标记的 <strong>行如果被删除</strong>，<strong>标记同时被删除</strong></li><li>如果 <strong>在其他行添加了相同名称的标记</strong>，<strong>之前添加的标记也会被替换掉</strong></li></ul><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">mx</td><td style="text-align:center">mark</td><td>添加标记 x，x 是 a~z 或者 A~Z 之间的任意一个字母</td></tr><tr><td style="text-align:center">‘x</td><td style="text-align:center"></td><td>直接定位到标记 x 所在位置</td></tr></tbody></table><h3 id="4-3-选中文本（可视模式）"><a href="#4-3-选中文本（可视模式）" class="headerlink" title="4.3 选中文本（可视模式）"></a>4.3 选中文本（可视模式）</h3><ul><li>学习 <code>复制</code> 命令前，应该先学会 <strong>怎么样选中 要复制的代码</strong></li><li>在 <code>vi</code> 中要选择文本，需要先使用 <code>Visual</code> 命令切换到 <strong>可视模式</strong></li><li><code>vi</code> 中提供了 <strong>三种</strong> 可视模式，可以方便程序员选择 <strong>选中文本的方式</strong></li><li>按 <code>ESC</code> 可以放弃选中，返回到 <strong>命令模式</strong></li></ul><table><thead><tr><th style="text-align:center">命令</th><th>模式</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">v</td><td>可视模式</td><td>从光标位置开始按照正常模式选择文本</td></tr><tr><td style="text-align:center">V</td><td>可视行模式</td><td>选中光标经过的完整行</td></tr><tr><td style="text-align:center">Ctrl + v</td><td>可视块模式</td><td>垂直方向选中文本</td></tr></tbody></table><ul><li><strong>可视模式</strong>下，可以和 <strong>移动命令</strong> 连用，例如：<code>ggVG</code> 能够选中所有内容</li></ul><h3 id="4-4-撤销和恢复撤销"><a href="#4-4-撤销和恢复撤销" class="headerlink" title="4.4 撤销和恢复撤销"></a>4.4 撤销和恢复撤销</h3><ul><li>在学习编辑命令之前，先要知道怎样撤销之前一次 <strong>错误的</strong> 编辑动作！</li></ul><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">u</td><td style="text-align:center">undo</td><td>撤销上次命令</td></tr><tr><td style="text-align:center">CTRL + r</td><td style="text-align:center">redo</td><td>恢复撤销的命令</td></tr></tbody></table><h3 id="4-5-删除文本"><a href="#4-5-删除文本" class="headerlink" title="4.5 删除文本"></a>4.5 删除文本</h3><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">x</td><td style="text-align:center">cut</td><td>删除光标所在字符，或者选中文字</td></tr><tr><td style="text-align:center">d(移动命令)</td><td style="text-align:center">delete</td><td>删除移动命令对应的内容</td></tr><tr><td style="text-align:center">dd</td><td style="text-align:center">delete</td><td>删除光标所在行，可以 ndd 复制多行</td></tr><tr><td style="text-align:center">D</td><td style="text-align:center">delete</td><td>删除至行尾</td></tr></tbody></table><blockquote><p>提示：如果使用 <strong>可视模式</strong> 已经选中了一段文本，那么无论使用 <code>d</code> 还是 <code>x</code>，都可以删除选中文本</p></blockquote><ul><li>删除命令可以和 <strong>移动命令</strong> 连用，以下是常见的组合命令：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* dw        # 从光标位置删除到单词末尾</span><br><span class="line">* d0        # 从光标位置删除到一行的起始位置</span><br><span class="line">* d&#125;        # 从光标位置删除到段落结尾</span><br><span class="line">* ndd       # 从光标位置向下连续删除 n 行</span><br><span class="line">* d代码行G   # 从光标所在行 删除到 指定代码行 之间的所有代码</span><br><span class="line">* d&apos;a       # 从光标所在行 删除到 标记a 之间的所有代码</span><br></pre></td></tr></table></figure><h3 id="4-6-复制、粘贴"><a href="#4-6-复制、粘贴" class="headerlink" title="4.6 复制、粘贴"></a>4.6 复制、粘贴</h3><ul><li><code>vi</code> 中提供有一个 <strong>被复制文本的缓冲区</strong><ul><li><strong>复制</strong> 命令会将选中的文字保存在缓冲区 </li><li><strong>删除</strong> 命令删除的文字会被保存在缓冲区</li><li>在需要的位置，使用 <strong>粘贴</strong> 命令可以将缓冲区的文字插入到光标所在位置</li></ul></li></ul><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">y(移动命令)</td><td style="text-align:center">copy</td><td>复制</td></tr><tr><td style="text-align:center">yy</td><td style="text-align:center">copy</td><td>复制一行，可以 nyy 复制多行</td></tr><tr><td style="text-align:center">p</td><td style="text-align:center">paste</td><td>粘贴</td></tr></tbody></table><p><strong>提示</strong></p><ul><li>命令 <code>d</code>、<code>x</code> 类似于图形界面的 <strong>剪切操作</strong> —— <code>CTRL + X</code></li><li>命令 <code>y</code> 类似于图形界面的 <strong>复制操作</strong> —— <code>CTRL + C</code></li><li>命令 <code>p</code> 类似于图形界面的 <strong>粘贴操作</strong> —— <code>CTRL + V</code></li><li><code>vi</code> 中的 <strong>文本缓冲区同样只有一个</strong>，如果后续做过 <strong>复制、剪切</strong> 操作，之前缓冲区中的内容会被替换</li></ul><p><strong>注意</strong></p><ul><li><code>vi</code> 中的 <strong>文本缓冲区</strong> 和系统的 <strong>剪贴板</strong> 不是同一个</li><li>所以在其他软件中使用 <code>CTRL + C</code> 复制的内容，不能在 <code>vi</code> 中通过 <code>P</code> 命令粘贴</li><li>可以在 <strong>编辑模式</strong> 下使用 <strong>鼠标右键粘贴</strong></li></ul><h3 id="4-7-替换"><a href="#4-7-替换" class="headerlink" title="4.7 替换"></a>4.7 替换</h3><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th><th>工作模式</th></tr></thead><tbody><tr><td style="text-align:center">r</td><td style="text-align:center">replace</td><td>替换当前字符</td><td>命令模式</td></tr><tr><td style="text-align:center">R</td><td style="text-align:center">replace</td><td>替换当前行光标后的字符</td><td>替换模式</td></tr></tbody></table><ul><li><code>R</code> 命令可以进入 <strong>替换模式</strong>，替换完成后，按下 <code>ESC</code> 可以回到 <strong>命令模式</strong></li><li><strong>替换命令</strong> 的作用就是不用进入 <strong>编辑模式</strong>，对文件进行 <strong>轻量级的修改</strong></li></ul><h3 id="4-8-缩排和重复执行"><a href="#4-8-缩排和重复执行" class="headerlink" title="4.8 缩排和重复执行"></a>4.8 缩排和重复执行</h3><table><thead><tr><th style="text-align:center">命令</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">&gt;&gt;</td><td>向右增加缩进</td></tr><tr><td style="text-align:center">&lt;&lt;</td><td>向左减少缩进</td></tr><tr><td style="text-align:center">.</td><td>重复上次命令</td></tr></tbody></table><ul><li><strong>缩排命令</strong> 在开发程序时，<strong>统一增加代码的缩进</strong> 比较有用！<ul><li>一次性 <strong>在选中代码前增加 4 个空格</strong>，就叫做 <strong>增加缩进</strong></li><li>一次性 <strong>在选中代码前删除 4 个空格</strong>，就叫做 <strong>减少缩进</strong></li></ul></li><li>在 <strong>可视模式</strong> 下，缩排命令只需要使用 <strong>一个</strong> <code>&gt;</code> 或者 <code>&lt;</code> </li></ul><blockquote><p>在程序中，<strong>缩进</strong> 通常用来表示代码的归属关系</p><ul><li>前面空格越少，代码的级别越高</li><li>前面空格越多，代码的级别越低</li></ul></blockquote><h3 id="4-9-查找"><a href="#4-9-查找" class="headerlink" title="4.9 查找"></a>4.9 查找</h3><h4 id="常规查找"><a href="#常规查找" class="headerlink" title="常规查找"></a>常规查找</h4><table><thead><tr><th style="text-align:center">命令</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">/str</td><td>查找 str</td></tr></tbody></table><ul><li>查找到指定内容之后，使用 <code>Next</code> 查找下一个出现的位置：<ul><li><code>n</code>: 查找下一个</li><li><code>N</code>: 查找上一个</li></ul></li><li>如果不想看到高亮显示，可以随便查找一个文件中不存在的内容即可</li></ul><h4 id="单词快速匹配"><a href="#单词快速匹配" class="headerlink" title="单词快速匹配"></a>单词快速匹配</h4><table><thead><tr><th style="text-align:center">命令</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">*</td><td>向后查找当前光标所在单词</td></tr><tr><td style="text-align:center">#</td><td>向前查找当前光标所在单词</td></tr></tbody></table><ul><li>在开发中，通过单词快速匹配，可以快速看到这个单词在其他什么位置使用过</li></ul><h3 id="4-10-查找并替换"><a href="#4-10-查找并替换" class="headerlink" title="4.10 查找并替换"></a>4.10 查找并替换</h3><ul><li>在 <code>vi</code> 中查找和替换命令需要在 <strong>末行模式</strong> 下执行</li><li>记忆命令格式：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s///g</span><br></pre></td></tr></table></figure><h4 id="1-全局替换"><a href="#1-全局替换" class="headerlink" title="1) 全局替换"></a>1) 全局替换</h4><ul><li><strong>一次性</strong>替换文件中的 <strong>所有出现的旧文本</strong></li><li>命令格式如下：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s/旧文本/新文本/g</span><br></pre></td></tr></table></figure><h4 id="2-可视区域替换"><a href="#2-可视区域替换" class="headerlink" title="2) 可视区域替换"></a>2) 可视区域替换</h4><ul><li><strong>先选中</strong> 要替换文字的 <strong>范围</strong></li><li>命令格式如下：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:s/旧文本/新文本/g</span><br></pre></td></tr></table></figure><h4 id="3-确认替换"><a href="#3-确认替换" class="headerlink" title="3) 确认替换"></a>3) 确认替换</h4><ul><li>如果把末尾的 <code>g</code> 改成 <code>gc</code> 在替换的时候，会有提示！<strong>推荐使用！</strong></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s/旧文本/新文本/gc</span><br></pre></td></tr></table></figure><ol><li><code>y</code> - <code>yes</code> 替换</li><li><code>n</code> - <code>no</code> 不替换</li><li><code>a</code> - <code>all</code> 替换所有</li><li><code>q</code> - <code>quit</code> 退出替换</li><li><code>l</code> - <code>last</code> 最后一个，并把光标移动到行首</li><li><code>^E</code> 向下滚屏</li><li><code>^Y</code> 向上滚屏</li></ol><h3 id="4-11-插入命令"><a href="#4-11-插入命令" class="headerlink" title="4.11 插入命令"></a>4.11 插入命令</h3><ul><li>在 <code>vi</code> 中除了常用的 <code>i</code> 进入 <strong>编辑模式</strong> 外，还提供了以下命令同样可以进入编辑模式：</li></ul><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th><th style="text-align:center">常用</th></tr></thead><tbody><tr><td style="text-align:center">i</td><td style="text-align:center">insert</td><td>在当前字符前插入文本</td><td style="text-align:center">常用</td></tr><tr><td style="text-align:center">I</td><td style="text-align:center">insert</td><td>在行首插入文本</td><td style="text-align:center">较常用</td></tr><tr><td style="text-align:center">a</td><td style="text-align:center">append</td><td>在当前字符后添加文本</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">A</td><td style="text-align:center">append</td><td>在行末添加文本</td><td style="text-align:center">较常用</td></tr><tr><td style="text-align:center">o</td><td style="text-align:center"></td><td>在当前行后面插入一空行</td><td style="text-align:center">常用</td></tr><tr><td style="text-align:center">O</td><td style="text-align:center"></td><td>在当前行前面插入一空行</td><td style="text-align:center">常用</td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vi/004_%E6%8F%92%E5%85%A5%E5%91%BD%E4%BB%A4.png" alt="004_插入命令-w400"></p><h4 id="演练-1-——-编辑命令和数字连用"><a href="#演练-1-——-编辑命令和数字连用" class="headerlink" title="演练 1 —— 编辑命令和数字连用"></a>演练 1 —— 编辑命令和数字连用</h4><ul><li>在开发中，可能会遇到连续输入 <code>N</code> 个同样的字符</li></ul><blockquote><p>在 <code>Python</code> 中有简单的方法，但是其他语言中通常需要自己输入</p></blockquote><ul><li>例如：<code>**********</code> 连续 10 个星号</li></ul><p>要实现这个效果可以在 <strong>命令模式</strong> 下</p><ol><li>输入 <code>10</code>，表示要重复 10 次</li><li>输入 <code>i</code> 进入 <strong>编辑模式</strong></li><li>输入 <code>*</code> 也就是重复的文字</li><li>按下 <code>ESC</code> 返回到 <strong>命令模式</strong>，返回之后 <code>vi</code> 就会把第 <code>2、3</code> 两步的操作重复 <code>10</code> 次</li></ol><blockquote><p>提示：正常开发时，在 <strong>进入编辑模式之前，不要按数字</strong></p></blockquote><h4 id="演练-2-——-利用-可视块-给多行代码增加注释"><a href="#演练-2-——-利用-可视块-给多行代码增加注释" class="headerlink" title="演练 2 —— 利用 可视块 给多行代码增加注释"></a>演练 2 —— 利用 可视块 给多行代码增加注释</h4><ul><li>在开发中，可能会遇到一次性给多行代码 <strong>增加注释</strong> 的情况</li></ul><blockquote><p>在 <code>Python</code> 中，要给代码增加注释，可以在代码前增加一个 <code>#</code></p></blockquote><p>要实现这个效果可以在 <strong>命令模式</strong> 下</p><ol><li>移动到要添加注释的 <strong>第 1 行代码</strong>，按 <code>^</code> 来到行首</li><li>按 <code>CTRL + v</code> 进入 <strong>可视块</strong> 模式</li><li>使用 <code>j</code> 向下连续选中要添加的代码行</li><li>输入 <code>I</code> 进入 <strong>编辑模式</strong>，并在 <strong>行首插入</strong>，注意：一定要使用 <strong>I</strong></li><li>输入 <code>#</code> 也就是注释符号</li><li>按下 <code>ESC</code> 返回到 <strong>命令模式</strong>，返回之后 <code>vi</code> 会在之前选中的每一行代码 <strong>前</strong> 插入 <code>#</code></li></ol><h2 id="05-分屏命令"><a href="#05-分屏命令" class="headerlink" title="05. 分屏命令"></a>05. 分屏命令</h2><ul><li>属于 <code>vi</code> 的高级命令 —— 可以 <strong>同时编辑和查看多个文件</strong></li></ul><h3 id="5-1-末行命令扩展"><a href="#5-1-末行命令扩展" class="headerlink" title="5.1 末行命令扩展"></a>5.1 末行命令扩展</h3><p><strong>末行命令</strong> 主要是针对文件进行操作的：<strong>保存</strong>、<strong>退出</strong>、<strong>保存&amp;退出</strong>、<strong>搜索&amp;替换</strong>、<strong>另存</strong>、<strong>新建</strong>、<strong>浏览文件</strong></p><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">:e .</td><td style="text-align:center">edit</td><td>会打开内置的文件浏览器，浏览要当前目录下的文件</td></tr><tr><td style="text-align:center">:n 文件名</td><td style="text-align:center">new</td><td>新建文件</td></tr><tr><td style="text-align:center">:w 文件名</td><td style="text-align:center">write</td><td>另存为，但是仍然编辑当前文件，并不会切换文件</td></tr></tbody></table><blockquote><p>提示：切换文件之前，必须保证当前这个文件已经被保存！</p></blockquote><ul><li>已经学习过的 <strong>末行命令</strong>：</li></ul><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">:w</td><td style="text-align:center">write</td><td>保存</td></tr><tr><td style="text-align:center">:q</td><td style="text-align:center">quit</td><td>退出，如果没有保存，不允许退出</td></tr><tr><td style="text-align:center">:q!</td><td style="text-align:center">quit</td><td>强行退出，不保存退出</td></tr><tr><td style="text-align:center">:wq</td><td style="text-align:center">write &amp; quit</td><td>保存并退出</td></tr><tr><td style="text-align:center">:x</td><td style="text-align:center"></td><td>保存并退出</td></tr><tr><td style="text-align:center">:%s///gc</td><td style="text-align:center"></td><td>确认搜索并替换</td></tr></tbody></table><blockquote><p>在实际开发中，可以使用 <code>w</code> 命令 <strong>阶段性的备份代码</strong></p></blockquote><h3 id="5-2-分屏命令"><a href="#5-2-分屏命令" class="headerlink" title="5.2 分屏命令"></a>5.2 分屏命令</h3><ul><li>使用 <strong>分屏命令</strong>，可以 <strong>同时编辑和查看多个文件</strong></li></ul><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">:sp [文件名]</td><td style="text-align:center">split</td><td>横向增加分屏</td></tr><tr><td style="text-align:center">:vsp [文件名]</td><td style="text-align:center">vertical split</td><td>纵向增加分屏</td></tr></tbody></table><h4 id="1-切换分屏窗口"><a href="#1-切换分屏窗口" class="headerlink" title="1) 切换分屏窗口"></a>1) 切换分屏窗口</h4><blockquote><p>分屏窗口都是基于 <code>CTRL + W</code> 这个快捷键的，<code>w</code> 对应的英文单词是 <code>window</code></p></blockquote><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">w</td><td style="text-align:center">window</td><td>切换到下一个窗口</td></tr><tr><td style="text-align:center">r</td><td style="text-align:center">reverse</td><td>互换窗口</td></tr><tr><td style="text-align:center">c</td><td style="text-align:center">close</td><td>关闭当前窗口，但是不能关闭最后一个窗口</td></tr><tr><td style="text-align:center">q</td><td style="text-align:center">quit</td><td>退出当前窗口，如果是最后一个窗口，则关闭 vi</td></tr><tr><td style="text-align:center">o</td><td style="text-align:center">other</td><td>关闭其他窗口</td></tr></tbody></table><h4 id="2-调整窗口大小"><a href="#2-调整窗口大小" class="headerlink" title="2) 调整窗口大小"></a>2) 调整窗口大小</h4><blockquote><p>分屏窗口都是基于 <code>CTRL + W</code> 这个快捷键的，<code>w</code> 对应的英文单词是 <code>window</code></p></blockquote><table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">英文</th><th>功能</th></tr></thead><tbody><tr><td style="text-align:center">+</td><td style="text-align:center"></td><td>增加窗口高度</td></tr><tr><td style="text-align:center">-</td><td style="text-align:center"></td><td>减少窗口高度</td></tr><tr><td style="text-align:center">&gt;</td><td style="text-align:center"></td><td>增加窗口宽度</td></tr><tr><td style="text-align:center">&lt;</td><td style="text-align:center"></td><td>减少窗口宽度</td></tr><tr><td style="text-align:center">=</td><td style="text-align:center"></td><td>等分窗口大小</td></tr></tbody></table><blockquote><p>调整窗口宽高的命令可以和数字连用，例如：<code>5 CTRL + W +</code> 连续 5 次增加高度</p></blockquote><h2 id="06-常用命令速查图"><a href="#06-常用命令速查图" class="headerlink" title="06. 常用命令速查图"></a>06. 常用命令速查图</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vi/vim.png" alt="vi"></p><h3 id="vimrc"><a href="#vimrc" class="headerlink" title="vimrc"></a>vimrc</h3><ul><li><code>vimrc</code> 是 <code>vim</code> 的配置文件，可以设置 vim 的配置，包括：<strong>热键</strong>、<strong>配色</strong>、<strong>语法高亮</strong>、<strong>插件</strong> 等</li><li><code>Linux</code> 中 <code>vimrc</code> 有两个位置，<strong>家目录下的配置文件优先级更高</strong></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/vim/vimrc</span><br><span class="line">~/.vimrc</span><br></pre></td></tr></table></figure><ul><li>常用的插件有：<ul><li>代码补全</li><li>代码折叠</li><li>搜索</li><li>Git 集成</li><li>……</li></ul></li><li>网上有很多高手已经配置好的针对 <code>python</code> 开发的 <code>vimrc</code> 文件，可以下载过来直接使用，或者等大家多 <code>Linux</code> 比较熟悉后，再行学习！</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue音乐播放器(二)</title>
      <link href="/2019/06/05/02Vue%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8.html"/>
      <url>/2019/06/05/02Vue%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8.html</url>
      
        <content type="html"><![CDATA[<h1 id="推荐页面开发"><a href="#推荐页面开发" class="headerlink" title="推荐页面开发"></a>推荐页面开发</h1><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/Dunteng/Vue-Music-WebApp/tree/v3/vue-music" target="_blank" rel="noopener">完成轮播图时</a></p><p><a href="https://github.com/Dunteng/Vue-Music-WebApp/tree/v4/vue-music" target="_blank" rel="noopener">完成歌单列表时</a></p><p><br><br></p><h2 id="better-scroll插件"><a href="#better-scroll插件" class="headerlink" title="better-scroll插件"></a>better-scroll插件</h2><p><a href="https://github.com/ustbhuangyi/better-scroll/blob/master/README_zh-CN.md" target="_blank" rel="noopener">中文文档</a></p><p><a href="https://ustbhuangyi.github.io/better-scroll/#/" target="_blank" rel="noopener">1.x Docs</a></p><p><a href="https://better-scroll.github.io/docs/en-US/" target="_blank" rel="noopener">2.x Docs</a></p><p>之后的轮播图组件和列表滚动组件都会用到这个插件。这个插件还挺牛逼的，9400+stars。</p><p><br><br></p><h2 id="QQ音乐的api"><a href="#QQ音乐的api" class="headerlink" title="QQ音乐的api"></a>QQ音乐的api</h2><ul><li><p>jsonp用到的：</p><p><a href="https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg" target="_blank" rel="noopener">https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg</a></p></li><li><p>axios/Ajax用到的：</p><p>在webpack.dev.conf.js中配置，见下文</p></li></ul><p><br><br></p><h2 id="【重点难点一】recommend页面jsonp相关文件的编写"><a href="#【重点难点一】recommend页面jsonp相关文件的编写" class="headerlink" title="【重点难点一】recommend页面jsonp相关文件的编写"></a>【重点难点一】recommend页面jsonp相关文件的编写</h2><h3 id="src-common-js-jsonp-js-promise封装"><a href="#src-common-js-jsonp-js-promise封装" class="headerlink" title="src/common/js/jsonp.js  promise封装"></a>src/common/js/jsonp.js  promise封装</h3><p>本项目该部分使用jsonp技术获取数据，解决跨域问题。</p><p>这里使用一个封装好的<a href="https://github.com/webmodules/jsonp" target="_blank" rel="noopener">jsonp插件</a>。这是它的API :</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560407149676.png" alt="1560407149676"></p><p>利用这个插件里面提供的api进行<strong>Promise</strong>的改写—-&gt; jsonp.js的创建。</p><p>先<code>npm i jsonp</code>进行jsonp插件的安装。</p><p>之后会经常用到它，把他放在js文件夹下，然后编写src/common/js/jsonp.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> originJsonp <span class="keyword">from</span> <span class="string">'jsonp'</span></span><br><span class="line"><span class="comment">/* jsonp2这个函数的三个参数，url是一个干净的不带参数的url地址，data表示随同url传过去的参数，</span></span><br><span class="line"><span class="comment">  因为jsonp这个插件要求的url是不支持object类型的的data参数的，所以我们需要先将data里面的数据拼接到url上。</span></span><br><span class="line"><span class="comment">  第三个参数option对应jsonp插件api里的opts参数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">jsonp2</span>(<span class="params">url, data, option</span>) </span>&#123;</span><br><span class="line">  url += (url.indexOf(<span class="string">'?'</span>) &lt; <span class="number">0</span> ? <span class="string">'?'</span> : <span class="string">'&amp;'</span>) + param(data)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    originJsonp(url, option, (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">param</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> url = <span class="string">''</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> data) &#123;</span><br><span class="line">    <span class="keyword">let</span> value = data[k] !== <span class="literal">undefined</span> ? data[k] : <span class="string">''</span></span><br><span class="line">    url += <span class="string">'&amp;'</span> + k + <span class="string">'='</span> + <span class="built_in">encodeURIComponent</span>(value)<span class="comment">/* encodeURIComponent(value)进行字符转义，如encodeURIComponent('百度')转为"%E7%99%BE%E5%BA%A6" */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> url ? url.substring(<span class="number">1</span>) : <span class="string">''</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><p>我们把请求api数据相关的js放在<code>src/api</code>目录下</p><p><br></p><h3 id="src-api-config-js"><a href="#src-api-config-js" class="headerlink" title="src/api/config.js"></a>src/api/config.js</h3><p>这部分主要就是模拟qq音乐api的参数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> commonParams = &#123;</span><br><span class="line">  g_tk: <span class="number">5381</span>,</span><br><span class="line">  inCharset: <span class="string">'utf-8'</span>,</span><br><span class="line">  outCharset: <span class="string">'utf-8'</span>,</span><br><span class="line">  notice: <span class="number">0</span>,</span><br><span class="line">  format: <span class="string">'jsonp'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> options = &#123;</span><br><span class="line">  param: <span class="string">'jsonpCallback'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ERR_OK = <span class="number">0</span>  <span class="comment">/* 语义化一下 */</span></span><br></pre></td></tr></table></figure><p><br></p><h3 id="src-api-recommend-js"><a href="#src-api-recommend-js" class="headerlink" title="src/api/recommend.js:"></a>src/api/recommend.js:</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jsonp <span class="keyword">from</span> <span class="string">'common/js/jsonp'</span></span><br><span class="line"><span class="keyword">import</span> &#123;commonParams, options&#125; <span class="keyword">from</span> <span class="string">'./config'</span></span><br><span class="line"><span class="comment">// import axios from 'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getRecommend</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> url = <span class="string">'https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg'</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = <span class="built_in">Object</span>.assign(&#123;&#125;, commonParams, &#123;</span><br><span class="line">    platform: <span class="string">'h5'</span>,</span><br><span class="line">    uin: <span class="number">0</span>,</span><br><span class="line">    needNewCode: <span class="number">1</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> jsonp(url, data, options)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="webpack-base-conf-js"><a href="#webpack-base-conf-js" class="headerlink" title="webpack.base.conf.js"></a>webpack.base.conf.js</h3><p>添加多两个别名：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">alias: &#123;</span><br><span class="line">  &apos;@&apos;: resolve(&apos;src&apos;),</span><br><span class="line">  &apos;common&apos;: resolve(&apos;src/common&apos;),</span><br><span class="line">  &apos;components&apos;: resolve(&apos;src/components&apos;),</span><br><span class="line">  &apos;base&apos;: resolve(&apos;src/base&apos;),</span><br><span class="line">  &apos;api&apos;: resolve(&apos;src/api&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="recommend-vue"><a href="#recommend-vue" class="headerlink" title="recommend.vue"></a>recommend.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;recommend&quot; ref=&quot;recommend&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/ecmascript-6&quot;&gt;</span><br><span class="line">  import &#123;getRecommend&#125; from &apos;api/recommend&apos;</span><br><span class="line">  import &#123;ERR_OK&#125; from &apos;api/config&apos;</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        recommends: [],</span><br><span class="line">        discList: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created() &#123;</span><br><span class="line">      this._getRecommend()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      _getRecommend() &#123;</span><br><span class="line">        getRecommend().then((res) =&gt; &#123;</span><br><span class="line">          if (res.code === ERR_OK) &#123;</span><br><span class="line">            this.recommends = res.data.slider</span><br><span class="line">            console.log(res);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;</span><br></pre></td></tr></table></figure><p>看一下这时候有没有抓取到数据：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560411184376.png" alt="1560411184376"></p><p><br><br></p><h2 id="轮播图组件"><a href="#轮播图组件" class="headerlink" title="轮播图组件"></a>轮播图组件</h2><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>这里用到一个插件<a href="https://github.com/ustbhuangyi/better-scroll" target="_blank" rel="noopener">better-scroll</a></p><p><a href="https://ustbhuangyi.github.io/better-scroll/doc/zh-hans/#better-scroll%20%E6%98%AF%E4%BB%80%E4%B9%88" target="_blank" rel="noopener">better-scroll文档</a></p><p><br><br></p><h3 id="插播一个小技巧：抽出一个“添加类名”组件dom-js"><a href="#插播一个小技巧：抽出一个“添加类名”组件dom-js" class="headerlink" title="插播一个小技巧：抽出一个“添加类名”组件dom.js"></a>插播一个小技巧：抽出一个“添加类名”组件dom.js</h3><p>在轮播图组件的编写过程中，编写 _setSliderWidth() 方法的代码中，要遍历某个节点的子节点，给它加上一个类名，这是一个常见的操作。比起直接在 _setSliderWidth() 里面实现，最好的方法是把该操作抽离成为一个js文件。</p><p>于是新建了src/common/js/dom.js，在里面实现了添加类名的操作并暴露出去：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * dom操作相关的代码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">hasClass</span>(<span class="params">el, className</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'(^|\\s)'</span> + className + <span class="string">'(\\s|$)'</span>)</span><br><span class="line">    <span class="keyword">return</span> reg.test(el.className)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addClass</span>(<span class="params">el, className</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (hasClass(el, className)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> newClass = el.className.split(<span class="string">' '</span>)</span><br><span class="line">    newClass.push(className)</span><br><span class="line">    el.className = newClass.join(<span class="string">' '</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而这个dom.js以后就专门来存放常见的dom操作。</p><p><br><br></p><h3 id="踩坑记录"><a href="#踩坑记录" class="headerlink" title="踩坑记录"></a>踩坑记录</h3><ol><li><p>recommend.vue中引用slider组件，而slider.vue中的 <code>_setSliderWidth()</code>方法里面循环渲染dom节点。但是我一开始的recommend.vue的代码中没有实现判断是否成功获取到了数据并渲染了节点，因为获取的是真实数据存在异步过程，如果没有加上这句<code>v-if=&quot;recommends.length&quot;</code>的话，可能存在recommend.vue页面还没有成功获取数据渲染节点，而引用slider组件导致slider中 <code>_setSliderWidth()</code>方法里面循环渲染dom节点出错，最终导致页面报销的状况。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;recommend&quot; ref=&quot;recommend&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;recommend-content&quot;&gt;</span><br><span class="line">        &lt;div v-if=&quot;recommends.length&quot; class=&quot;slider-wrapper&quot;&gt;&lt;!-- 注意这里用了v-if来确保只有当成功获取到数据后才将slider组件添加上，从而保证slider中的循环渲染成功 --&gt;</span><br><span class="line">            &lt;slider&gt;</span><br><span class="line">                &lt;div v-for=&quot;item in recommends&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">                    &lt;a :href=&quot;item.linkUrl&quot;&gt;</span><br><span class="line">                        &lt;img :src=&quot;item.picUrl&quot; alt=&quot;&quot;&gt;</span><br><span class="line">                    &lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/slider&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p><br></p></li><li><p>better-scroll默认会复制轮播图的首尾两张图（这里说成“图”不太准确，姑且这么说），因此通过api获得的轮播图图片只有5张，但是在使用better-scroll的时候生成了7个节点。相应的在slider.vue的<code>_setSliderWidth</code>中要设置增加两张图的宽度：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">_setSliderWidth(isResize) &#123;</span><br><span class="line">  <span class="keyword">this</span>.children = <span class="keyword">this</span>.$refs.sliderGroup.children;</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">let</span> width = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> sliderWidth = <span class="keyword">this</span>.$refs.slider.clientWidth;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.children.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> child = <span class="keyword">this</span>.children[i];</span><br><span class="line">    addClass(child, <span class="string">"slider-item"</span>);</span><br><span class="line">   </span><br><span class="line">    child.style.width = sliderWidth + <span class="string">"px"</span>;</span><br><span class="line">    width += sliderWidth;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.loop &amp;&amp; !isResize) &#123;</span><br><span class="line">    width += <span class="number">2</span> * sliderWidth; <span class="comment">/* 加多左右两个轮播图的宽度，为了实现无缝流畅滚动，不会噌的一下跳过去 */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.$refs.sliderGroup.style.width = width + <span class="string">"px"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p></li><li><p>有个<strong>bug</strong></p><p>无法实现自动的无缝轮播，轮播到最后一张的时候就不动了，必须手动划一下才能无缝轮播。暂未解决，怀疑是better-scroll的问题。目前的妥协是最后一张直接跳转到第一张，就很难看。。。</p><p><br></p></li><li><p>实现窗口改变的时候自适应</p><p>在mounted钩子函数中监听一下窗口的改变事件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/* 监听窗口改变事件 */</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.slider) &#123;<span class="comment">/* 如果slider还未初始化，直接退出 */</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>._setSliderWidth()</span><br><span class="line">  <span class="keyword">this</span>.slider.refresh()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br></p></li><li><p>优化：减少重复的数据请求</p><p>打开项目的时候轮播图会发起数据请求，但是当从首页推荐页切换路由到其他页面，再从其他页面切换回轮播图所在的首页推荐页面时，它又重新刷新发起了数据请求，这是没必要的，而且降低了性能。</p><p>可以使用<code>&lt;keepalive&gt;</code>标签将<code>&lt;router-view&gt;</code>包裹起来，将其dom缓存到内存中。这就避免了上述的情况。</p><p><br></p></li><li><p>优化：beforeDestroy清除计时器释放内存</p><p>路由切换的时候会触发vue的destroy，那么最好时把slider的计算器清除了以释放内存</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">beforeDestroy() &#123;</span><br><span class="line">  clearTimeout(this.timer)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ol><p><br><br></p><h2 id="【重点难点二】axios与后端接口代理"><a href="#【重点难点二】axios与后端接口代理" class="headerlink" title="【重点难点二】axios与后端接口代理"></a>【重点难点二】axios与后端接口代理</h2><p>先安装axios依赖</p><h3 id="修改代理"><a href="#修改代理" class="headerlink" title="修改代理"></a>修改代理</h3><p>在使用QQ音乐推荐页歌单列表的api时，发现无法通过ajax获取到。关键点是QQ音乐设置了请求头中的Host和Referer进行了限制：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1561392420142.png" alt="1561392420142"></p><p>因此需要解决这个跨域的问题。方法是<strong>修改代理</strong>。</p><p><br></p><h3 id="修改webpack-dev-conf-js"><a href="#修改webpack-dev-conf-js" class="headerlink" title="修改webpack.dev.conf.js"></a>修改webpack.dev.conf.js</h3><p><a href="https://github.com/ustbhuangyi/vue-music/issues/82" target="_blank" rel="noopener">【相关参考】</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  devServer: &#123;</span><br><span class="line">    before(app) &#123;</span><br><span class="line">      app.get(<span class="string">'/api/getDiscList'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> url = <span class="string">'https://c.y.qq.com/splcloud/fcgi-bin/fcg_get_diss_by_tag.fcg'</span></span><br><span class="line">        axios.get(url, &#123;</span><br><span class="line">          headers: &#123;</span><br><span class="line">            referer: <span class="string">'https://c.y.qq.com/'</span>,</span><br><span class="line">            host: <span class="string">'c.y.qq.com'</span></span><br><span class="line">          &#125;,</span><br><span class="line">          params: req.query</span><br><span class="line">        &#125;).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">          res.json(response.data)</span><br><span class="line">        &#125;).catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(e)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">      </span><br><span class="line">      ...</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="src-api-recommend-js-1"><a href="#src-api-recommend-js-1" class="headerlink" title="src/api/recommend.js"></a>src/api/recommend.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jsonp <span class="keyword">from</span> <span class="string">'common/js/jsonp'</span></span><br><span class="line"><span class="keyword">import</span> &#123; commonParams, options &#125; <span class="keyword">from</span> <span class="string">'./config'</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getRecommend</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">'https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = <span class="built_in">Object</span>.assign(&#123;&#125;, commonParams, &#123;</span><br><span class="line">        platform: <span class="string">'h5'</span>,</span><br><span class="line">        uin: <span class="number">0</span>,</span><br><span class="line">        needNewCode: <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jsonp(url, data, options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getDiscList</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">'/api/getDiscList'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> data = <span class="built_in">Object</span>.assign(&#123;&#125;, commonParams, &#123;</span><br><span class="line">        platform: <span class="string">'yqq'</span>,</span><br><span class="line">        hostUin: <span class="number">0</span>,</span><br><span class="line">        sin: <span class="number">0</span>,</span><br><span class="line">        ein: <span class="number">29</span>,</span><br><span class="line">        sortId: <span class="number">5</span>,</span><br><span class="line">        needNewCode: <span class="number">0</span>,</span><br><span class="line">        categoryId: <span class="number">10000000</span>,</span><br><span class="line">        rnd: <span class="built_in">Math</span>.random(),</span><br><span class="line">        format: <span class="string">'json'</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> axios.get(url, &#123;</span><br><span class="line">        params: data</span><br><span class="line">    &#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(res.data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在recommend.vue中调用getDiscList()方法就能成功获取到数据了。</p><p><br></p><p>这时候启动项目，可以在chrome Network中看到发送了Ajax请求并成功获得了数据：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560566255358.png" alt="1560566255358"></p><p><br><br></p><h2 id="歌单列表组件开发"><a href="#歌单列表组件开发" class="headerlink" title="歌单列表组件开发"></a>歌单列表组件开发</h2><p>通过上一步改变qq音乐api的接口代理，在recommend.vue调用getDiscList方法获取到数据，并渲染到页面上。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560578229727.png" alt="1560578229727"></p><p>但是到这一步为止，页面尚无法上下滑动。还是需要better-scroll组件来创建一个歌单列表滚动组件。</p><p><br></p><h3 id="src-base-scroll-scroll-vue"><a href="#src-base-scroll-scroll-vue" class="headerlink" title="src/base/scroll/scroll.vue"></a>src/base/scroll/scroll.vue</h3><p>创建/src/base/scroll/scroll.vue:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div ref=&quot;wrapper&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/ecmascript-6&quot;&gt;</span><br><span class="line">  import BScroll from &apos;better-scroll&apos;</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">      probeType: &#123;</span><br><span class="line">        type: Number,</span><br><span class="line">        default: 1</span><br><span class="line">      &#125;,</span><br><span class="line">      click: &#123;</span><br><span class="line">        type: Boolean,</span><br><span class="line">        default: true</span><br><span class="line">      &#125;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        type: Array,</span><br><span class="line">        default: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        this._initScroll()</span><br><span class="line">      &#125;, 20)</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      _initScroll() &#123;</span><br><span class="line">        if (!this.$refs.wrapper) &#123;</span><br><span class="line">          return</span><br><span class="line">        &#125;</span><br><span class="line">        this.scroll = new BScroll(this.$refs.wrapper, &#123;</span><br><span class="line">          probeType: this.probeType,</span><br><span class="line">          click: this.click</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      enable() &#123;</span><br><span class="line">        this.scroll &amp;&amp; this.scroll.enable()/* better-scroll的api，启用 better-scroll, 默认 开启 */</span><br><span class="line">      &#125;,</span><br><span class="line">      disable() &#123;</span><br><span class="line">        this.scroll &amp;&amp; this.scroll.disable()/* better-scroll的api，禁用 better-scroll，DOM 事件（如 touchstart、touchmove、touchend）的回调函数不再响应。 */</span><br><span class="line">      &#125;,</span><br><span class="line">      refresh() &#123;</span><br><span class="line">        this.scroll &amp;&amp; this.scroll.refresh()/* 重新计算 better-scroll，当 DOM 结构发生变化的时候务必要调用确保滚动的效果正常。 */</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">      data() &#123;  /* 监听数据改变立即刷新 */</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">          this.refresh()</span><br><span class="line">        &#125;, 20)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="src-components-recommend-recommend-vue"><a href="#src-components-recommend-recommend-vue" class="headerlink" title="src/components/recommend/recommend.vue"></a>src/components/recommend/recommend.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;recommend&quot; ref=&quot;recommend&quot;&gt;</span><br><span class="line">    &lt;scroll ref=&quot;scroll&quot; class=&quot;recommend-content&quot; :data=&apos;discList&apos;&gt;&lt;!-- 注意这里的:data如果没有加的话依旧是不能上下滑动的，因为scroll是在mounted时候初始化，由于数据获取存在异步性，可能mounted的时候尚未取到数据，整个列表dom的高度是没有被撑开的以至于better-scroll无法正确初始化。所以需要传入一个discList数据（discList有说明数据已经获取到了）触发scroll的watch里面的refresh --&gt;</span><br><span class="line">      &lt;div&gt; &lt;!-- 注意，better-scroll的scroll标签下只能是一个div包裹全部，如果这个div不把轮播图和列表都包裹起来的话，效果是只有歌单列表滚动，轮播图是固定的，那就糟了 --&gt;</span><br><span class="line">      &lt;div v-if=&quot;recommends.length&quot; class=&quot;slider-wrapper&quot;&gt;</span><br><span class="line">        &lt;!-- 注意这里用了v-if来确保只有当成功获取到数据后才将slider组件添加上，从而保证slider中的循环渲染成功 --&gt;</span><br><span class="line">        &lt;slider&gt;</span><br><span class="line">          &lt;div v-for=&quot;item in recommends&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">            &lt;a :href=&quot;item.linkUrl&quot;&gt;</span><br><span class="line">              &lt;img  @load=&quot;loadImage&quot; :src=&quot;item.picUrl&quot;&gt;&lt;!-- 通过@load事件监听图片加载完成了没有，一旦获加载完就refresh scroll --&gt;</span><br><span class="line">            &lt;/a&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/slider&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;recommend-list&quot;&gt;</span><br><span class="line">        &lt;h1 class=&quot;list-title&quot;&gt;热门歌单推荐&lt;/h1&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &lt;li class=&quot;item&quot; v-for=&quot;item in discList&quot; :key=&quot;item.dissid&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;icon&quot;&gt;</span><br><span class="line">              &lt;img :src=&quot;item.imgurl&quot; width=&quot;60&quot; height=&quot;60&quot; alt&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;text&quot;&gt;</span><br><span class="line">                &lt;h2 class=&quot;name&quot; v-html=&quot;item.creator.name&quot;&gt;&lt;/h2&gt;</span><br><span class="line">                &lt;p class=&quot;desc&quot; v-html=&quot;item.dissname&quot;&gt;&lt;/p&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/scroll&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="这里遇到的坑"><a href="#这里遇到的坑" class="headerlink" title="这里遇到的坑"></a>这里遇到的坑</h3><ol><li><p>在上述recommend.vue中提到scroll标签中:data如果没有加的话依旧是不能上下滑动的，因为scroll是在mounted时候初始化，由于数据获取存在异步性，可能mounted的时候尚未取到数据，整个列表dom的高度是没有被撑开的。所以需要传入一个discList数据（discList有说明数据已经获取到了）触发scroll的refresh</p></li><li><p>那为什么传discList就行？传recommends行不行？答案是不行的。虽然他们都是异步获取数据，但是discList获取的速度比recommends的获取速度慢。如果传入的是recommends，虽然recommends已经获取到了，轮播图的高度也已经撑开了，但是下方的列表discList还没有完全获取到，所以scroll在初始化的时候页面的高度计算是有误的。</p></li><li><p>还有一个问题，拿到recommends就万事大吉了吗？不是。</p><p>对于discList歌单列表，里面的列表项是给定宽高的，所以一拿到discList就能确定宽高撑开dom。但是recommend部分的轮播图图片是没有给定宽高的，是按照百分比来设置的宽高，所以即使获得了recommends的数据，但是由于图片是通过链接引入的，这又是一个异步的过程，所以不能保证拿到了recommends的数据就能立刻加载出图片撑起宽高，在此完成之前就初始化scroll还是会出问题的。所以，可以给img标签监听load事件，一旦load就refresh scroll。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">loadImage() &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.checkloaded) &#123; <span class="comment">/* 无中生有搞个checkloaded变量来监测加载完成与否，一开始默认为undefined，只要有一张加载成功就改值为true，不用每张图都触发这个方法，加载得到一张图就可以确定宽高了 */</span></span><br><span class="line">    <span class="keyword">this</span>.checkloaded = <span class="literal">true</span> </span><br><span class="line">    <span class="keyword">this</span>.$refs.scroll.refresh()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ol><p>使用checkloaded也是<strong>常见的一种优化</strong>。</p><p><br></p><h3 id="这里总结一下better-scroll的渲染原理吧"><a href="#这里总结一下better-scroll的渲染原理吧" class="headerlink" title="这里总结一下better-scroll的渲染原理吧"></a>这里总结一下better-scroll的渲染原理吧</h3><p>它根据初始化的时机或者refresh的时机，那个时候scroll的父元素的高度和子元素的高度之差，算到scroll可以滚动的位置，所以我们去实例化或者refresh这个scroll的时候一定要保证dom是渲染完成的，才能正确计算他们的高度。一旦我们有数据变化引起dom变化或者其他dom结构变化，一定要重新refresh这个scroll。</p><p><br><br></p><h2 id="懒加载vue-lazyload"><a href="#懒加载vue-lazyload" class="headerlink" title="懒加载vue-lazyload"></a>懒加载vue-lazyload</h2><h3 id="vue-lazyload"><a href="#vue-lazyload" class="headerlink" title="vue-lazyload"></a><a href="https://github.com/hilongjw/vue-lazyload" target="_blank" rel="noopener">vue-lazyload</a></h3><p><br></p><h3 id="代码编写"><a href="#代码编写" class="headerlink" title="代码编写"></a>代码编写</h3><ol><li><p>main.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> VueLazyLoad <span class="keyword">from</span> <span class="string">'vue-lazyload'</span></span><br><span class="line"></span><br><span class="line">Vue.use(VueLazyLoad, &#123;</span><br><span class="line">    loading: <span class="built_in">require</span>(<span class="string">'./common/image/default-ldt.png'</span>)  <span class="comment">//loading时显示的图片</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>将recommend.vue中<code>img</code>标签的<code>:src</code>属性替换成<code>v-lazy</code>计即可</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1561427554510.png" alt="1561427554510"></p></li></ol><p><br></p><h2 id="loading组件"><a href="#loading组件" class="headerlink" title="loading组件"></a>loading组件</h2><p>效果：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1561428758666.png" alt="1561428758666"></p><p><br></p><p>要搞个这个东西，提升用户体验。</p><h3 id="src-base-loading-vue"><a href="#src-base-loading-vue" class="headerlink" title="src/base/loading.vue"></a>src/base/loading.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;loading&quot;&gt;</span><br><span class="line">    &lt;img width=&quot;24&quot; height=&quot;24&quot; src=&quot;./loading.gif&quot;&gt;</span><br><span class="line">    &lt;p class=&quot;desc&quot;&gt;&#123;&#123;title&#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script type=&quot;text/ecmascript-6&quot;&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">      title: &#123;</span><br><span class="line">        type: String,</span><br><span class="line">        default: &apos;正在载入...&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;</span><br><span class="line">  @import &quot;~common/stylus/variable&quot;</span><br><span class="line"></span><br><span class="line">  .loading</span><br><span class="line">    width: 100%</span><br><span class="line">    text-align: center</span><br><span class="line">    .desc</span><br><span class="line">      line-height: 20px</span><br><span class="line">      font-size: $font-size-small</span><br><span class="line">      color: $color-text-l</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>然后在recommend.vue中引用并嵌入即可。</p><p><br><br></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vuex笔记</title>
      <link href="/2019/06/03/Vuex%E7%AC%94%E8%AE%B0.html"/>
      <url>/2019/06/03/Vuex%E7%AC%94%E8%AE%B0.html</url>
      
        <content type="html"><![CDATA[<p>我这篇文章也放在我的GitHub上，里面还有相应的代码。建议移步<a href="https://github.com/Dunteng/learnVue/tree/master/%E5%AD%A6%E4%B9%A0Vuex#%E6%9C%AC%E6%96%87%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">GitHub</a>阅读本文章。</p><h1 id="本文代码"><a href="#本文代码" class="headerlink" title="本文代码"></a>本文代码</h1><ul><li>前导~state部分的全部代码： <a href="https://github.com/Dunteng/learnVue/tree/v1/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">点击</a></li><li>应用（一）代码： <a href="https://github.com/Dunteng/learnVue/tree/v2/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">点击</a></li><li>getters 应用（二）代码： <a href="https://github.com/Dunteng/learnVue/tree/v3/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">点击</a></li><li>mutations 应用（三）代码：<a href="https://github.com/Dunteng/learnVue/tree/v4/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">点击</a></li><li>actions 应用（四）代码：<a href="https://github.com/Dunteng/learnVue/tree/v5/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">点击</a></li></ul><p><br><br></p><h1 id="前导"><a href="#前导" class="headerlink" title="前导"></a>前导</h1><p>结合代码案例学习，本文的知识点会依附在这个代码里讲解，下面先来看一下这个代码的介绍，主要就是一个父组件Index.vue，两个子组件AddStudent.vue和StudentList.vue，之间有组件通讯。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562291573640.png" alt="1562291573640"></p><p><br></p><h2 id="父组件-Index-vue"><a href="#父组件-Index-vue" class="headerlink" title="父组件 Index.vue"></a>父组件 Index.vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;index&quot;&gt;</span><br><span class="line">    rock!我是index.vue</span><br><span class="line">    &lt;add-student @add=&quot;add&quot;&gt;&lt;/add-student&gt;</span><br><span class="line">    &lt;student-list :student=&quot;student&quot;&gt;&lt;/student-list&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import AddStudent from &quot;../components/AddStudent&quot;;</span><br><span class="line">import StudentList from &quot;../components/StudentList&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      student: []</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    add(name) &#123;</span><br><span class="line">      this.student.push(name);</span><br><span class="line">      console.log(this.student);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    AddStudent,</span><br><span class="line">    StudentList</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.index &#123;</span><br><span class="line">  background-color: rgb(72, 138, 182);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h2 id="子组件-AddStudent-vue"><a href="#子组件-AddStudent-vue" class="headerlink" title="子组件 AddStudent.vue"></a>子组件 AddStudent.vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;AddStudent&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是addStudent&lt;/h4&gt;</span><br><span class="line">    &lt;span&gt;添加学生&lt;/span&gt;</span><br><span class="line">    &lt;input id=&quot;input&quot; type=&quot;text&quot; v-model=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;添加&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &quot;&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    add() &#123;</span><br><span class="line">      this.$emit(&quot;add&quot;, this.name);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.AddStudent &#123;</span><br><span class="line">  border: 2px solid green;</span><br><span class="line">  background-color: green;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h2 id="子组件-Student-List-vue"><a href="#子组件-Student-List-vue" class="headerlink" title="子组件 Student List.vue"></a>子组件 Student List.vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;StudentList&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是StudentList&lt;/h4&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;(item, index) in student&quot; :key=&quot;index+item&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  props: [&quot;student&quot;]</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.StudentList &#123;</span><br><span class="line">  border: 2px solid red;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br><br></p><h1 id="state"><a href="#state" class="headerlink" title="state"></a>state</h1><h2 id="store-js"><a href="#store-js" class="headerlink" title="store.js"></a>store.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    name: <span class="string">'dunteng'</span>,</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    look: <span class="string">'handsome'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br></p><h2 id="store-state-xxx"><a href="#store-state-xxx" class="headerlink" title="$store.state.xxx"></a>$store.state.xxx</h2><p>vuex 里的 state 相当于一个公共数据池。</p><p>在 AddStudent.vue 中通过如下方式可以获取到：</p><ol><li><p>使用 $store.state.name 获取到</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562292413010.png" alt="1562292413010"></p><p>然后我修改一下add方法使得点击button按钮后修改 $store.state.name ，如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add() &#123;</span><br><span class="line">  <span class="comment">// this.$emit("add", this.name);</span></span><br><span class="line">  <span class="keyword">this</span>.$store.state.name += <span class="string">" lin"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是<code></code>显示的部分并没有成功修改只有<code></code>才有被修改，这是因为<code>storeName</code>是在data中被定义的，之后<code>$store.state.name</code>和它是没关系的，影响不到。所以应该用<code>computed</code>来获取 state 的数据。</p></li><li><p>computed 获取 this.$store.state.name</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562292792863.png" alt="1562292792863"></p><p>这样，只要 state 里的数据发生改变，通过 computed 获取到的就能相应其改变。</p></li></ol><p><br></p><h2 id="mapState"><a href="#mapState" class="headerlink" title="mapState"></a>mapState</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>像上述那样拿到 state 中的 name ，继续获取到 state 中的其他数据：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562293651685.png" alt="1562293651685"></p><p>如果同时另一个组件也要同样的这些数据，那么就要在 StudentList 组件中重复上述的操作，这样是可行的，但是如果还有七八九十个组件也要这些数据，那么这样的操作很繁琐，冗余很大。</p><p>这就需要用到 <strong>mapState方法</strong> 了。这个方法的返回是一个<strong>对象</strong>，对象的每个key对应的value都是一个函数，有一点点像下面这个：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562294928788.png" alt="1562294928788"></p><p><br></p><h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p>先引入才能使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapState&#125; <span class="keyword">from</span> <span class="string">'vuex'</span></span><br></pre></td></tr></table></figure><p>然后结合 computed ，将 state 中的数据作为参数传入，</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">computed: mapState([<span class="string">"name"</span>, <span class="string">"age"</span>, <span class="string">"look"</span>]),</span><br></pre></td></tr></table></figure><p>而在当前组件中获得的数据名称和 state 中的一样。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562295563445.png" alt="1562295563445"></p><p>但是结果只显示了 age 和 look ，没有显示 name ，因为在 data 中定义了一个 name 属性，而 data 的优先级比 computed 高，所以无法正常获取到。</p><p>所以需要我们在使用 mapState 的时候重命名，如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed: mapState(&#123;</span><br><span class="line">  mapStateName: <span class="function"><span class="params">state</span> =&gt;</span> state.name,</span><br><span class="line">  mapStateAge: <span class="function"><span class="params">state</span> =&gt;</span> state.age,</span><br><span class="line">  mapStateOther: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">"你好吗"</span> <span class="comment">//我们甚至可以定义与state无关的变量</span></span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure><p>但是除了 mapState ，我们在 computed 中也需要定义其他的计算属性，咋整？</p><p>像下面这样写是会报错的！</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562297668974.png" alt="1562297668974"></p><p>上面说了 mapState 返回的是一个<strong>对象</strong>，所以我们可以使用扩展运算符，如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ...mapState(&#123;</span><br><span class="line">    mapStateName: <span class="function"><span class="params">state</span> =&gt;</span> state.name,</span><br><span class="line">    mapStateAge: <span class="function"><span class="params">state</span> =&gt;</span> state.age,</span><br><span class="line">    mapStateOther: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">"你好吗"</span></span><br><span class="line">  &#125;),</span><br><span class="line">  a()&#123;</span><br><span class="line">    retrun <span class="keyword">this</span>.$store.state.age+<span class="number">666</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><br></p><h2 id="应用（一）"><a href="#应用（一）" class="headerlink" title="应用（一）"></a>应用（一）</h2><p><a href="https://github.com/Dunteng/learnVue/tree/v2/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">【代码】</a></p><p>原案例中的两个子组件之间的传值是通过父组件来实现的，下面我们利用 vuex 的 state 来存储他们的公共资源。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562307401416.png" alt="1562307401416"></p><p><br></p><h3 id="父组件-Index-vue-1"><a href="#父组件-Index-vue-1" class="headerlink" title="父组件 Index.vue"></a>父组件 Index.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;index&quot;&gt;</span><br><span class="line">    rock!我是index.vue</span><br><span class="line">    &lt;add-student&gt;&lt;/add-student&gt;</span><br><span class="line">    &lt;student-list&gt;&lt;/student-list&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import AddStudent from &quot;../components/AddStudent&quot;;</span><br><span class="line">import StudentList from &quot;../components/StudentList&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;&#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    AddStudent,</span><br><span class="line">    StudentList</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.index &#123;</span><br><span class="line">  background-color: rgb(72, 138, 182);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="子组件-AddStudent-vue-1"><a href="#子组件-AddStudent-vue-1" class="headerlink" title="子组件 AddStudent.vue"></a>子组件 AddStudent.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;AddStudent&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是addStudent&lt;/h4&gt;</span><br><span class="line">    &lt;span&gt;添加学生&lt;/span&gt;</span><br><span class="line">    &lt;input id=&quot;input&quot; type=&quot;text&quot; v-model=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;add&quot;&gt;添加&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState &#125; from &quot;vuex&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &quot;&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    add() &#123;</span><br><span class="line">      // this.$emit(&quot;add&quot;, this.name);</span><br><span class="line">      this.$store.state.studentlist.push(this.name);</span><br><span class="line">      console.log(this.$store.state.studentlist);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.AddStudent &#123;</span><br><span class="line">  border: 2px solid green;</span><br><span class="line">  background-color: green;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="子组件-StudentList-vue"><a href="#子组件-StudentList-vue" class="headerlink" title="子组件 StudentList.vue"></a>子组件 StudentList.vue</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;StudentList&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是StudentList&lt;/h4&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;(item, index) in studentlist&quot; :key=&quot;index+item&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState &#125; from &quot;vuex&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    ...mapState([&quot;studentlist&quot;]) //记得加引号。。。</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.StudentList &#123;</span><br><span class="line">  border: 2px solid red;</span><br><span class="line">  background-color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br><br></p><h1 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h1><h2 id="应用（二）"><a href="#应用（二）" class="headerlink" title="应用（二）"></a>应用（二）</h2><p>在应用（一）的基础上，要求输出：</p><blockquote><p>索引为0的： **姓名</p><p>索引为1和2的：姓名**</p><p>索引大于2的：++姓名++</p></blockquote><p>效果图：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562335007899.png" alt="1562335007899"></p><p><br></p><h3 id="不用getters的方案"><a href="#不用getters的方案" class="headerlink" title="不用getters的方案"></a>不用getters的方案</h3><p>在 StudentList.vue中的 <strong>computed</strong> 中进行数据处理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">// ...mapState(["studentlist"]) //记得加引号。。。</span></span><br><span class="line">  studentlist() &#123;</span><br><span class="line">    <span class="keyword">var</span> list = [];</span><br><span class="line">    <span class="keyword">this</span>.$store.state.studentlist.forEach(<span class="function">(<span class="params">element, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">        element = <span class="string">"**"</span> + element;</span><br><span class="line">        list.push(element);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index == <span class="number">1</span> || index == <span class="number">2</span>) &#123;</span><br><span class="line">        element = element + <span class="string">"**"</span>;</span><br><span class="line">        list.push(element);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        element = <span class="string">"++"</span> + element + <span class="string">"++"</span>;</span><br><span class="line">        list.push(element);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="使用getters的方案"><a href="#使用getters的方案" class="headerlink" title="使用getters的方案"></a>使用getters的方案</h3><p>现在 store.js 中写 getters 代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">getters: &#123;</span><br><span class="line">  <span class="comment">//相当于计算属性</span></span><br><span class="line">  newstudentlist(state) &#123;</span><br><span class="line">    <span class="keyword">return</span> state.studentlist.map(<span class="function">(<span class="params">ele, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'**'</span> + ele</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> ele + <span class="string">'**'</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'++'</span> + ele + <span class="string">'++'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>在 StudentList 中直接使用 newstudentlist：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;StudentList&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是StudentList&lt;/h4&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;(item, index) in newstudentlist&quot; :key=&quot;index+item&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState &#125; from &quot;vuex&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    newstudentlist() &#123;</span><br><span class="line">      return this.$store.getters.newstudentlist;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="mapGetters"><a href="#mapGetters" class="headerlink" title="mapGetters"></a>mapGetters</h3><p>和 mapState 类似的便捷方法</p><p>StudentList 中先引入 mapGetters ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState, mapGetters &#125; <span class="keyword">from</span> <span class="string">"vuex"</span>;</span><br><span class="line">。。。</span><br><span class="line">  computed: &#123;</span><br><span class="line">    <span class="comment">// newstudentlist() &#123;</span></span><br><span class="line">    <span class="comment">//   return this.$store.getters.newstudentlist;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    ...mapGetters([<span class="string">"newstudentlist"</span>])</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>也可以使用对象的方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState, mapGetters &#125; <span class="keyword">from</span> <span class="string">"vuex"</span>;</span><br><span class="line">。。。</span><br><span class="line">  computed: &#123;</span><br><span class="line">    <span class="comment">// newstudentlist() &#123;</span></span><br><span class="line">    <span class="comment">//   return this.$store.getters.newstudentlist;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//...mapGetters(["newstudentlist"])</span></span><br><span class="line">    </span><br><span class="line">    ...mapGetters(&#123;</span><br><span class="line">      newstudentlist: <span class="string">"newstudentlist"</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="补充一点：getters自身可以作为参数传入getters属性的方法中"><a href="#补充一点：getters自身可以作为参数传入getters属性的方法中" class="headerlink" title="补充一点：getters自身可以作为参数传入getters属性的方法中"></a>补充一点：getters自身可以作为参数传入getters属性的方法中</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">getters: &#123;</span><br><span class="line">  <span class="comment">//相当于计算属性</span></span><br><span class="line">  newstudentlist(state, getters) &#123;<span class="comment">//传入了getters作为参数</span></span><br><span class="line">    <span class="keyword">return</span> state.studentlist.map(<span class="function">(<span class="params">ele, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'**'</span> + ele + getters.aaa<span class="comment">//使用了getters中的aaa</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> ele + <span class="string">'**'</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'++'</span> + ele + <span class="string">'++'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  aaa() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">666</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><br><br></p><h1 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h1><h2 id="关于严格模式"><a href="#关于严格模式" class="headerlink" title="关于严格模式"></a>关于严格模式</h2><p>上述应用程序代码写的是不规范的，当我们开启严格模式时就会报警告了。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562337035921.png" alt="1562337035921"></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562337084677.png" alt="1562337084677"></p><p>报错信息提示不要在 <strong>mutation</strong> 处理程序之外对vuex存储状态<strong>state</strong>进行更改。而我们恰恰就在 Addstudent.vue 的 add 方法中对 $store.state.studentlist 进行了更改：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562337274020.png" alt="1562337274020"></p><p>【记住：凡是要修改 <strong>state</strong> 的都要通过 <strong>mutation</strong> 来修改。 】</p><p><br></p><h2 id="应用（三）"><a href="#应用（三）" class="headerlink" title="应用（三）"></a>应用（三）</h2><p><a href="https://github.com/Dunteng/learnVue/tree/v4/%E5%AD%A6%E4%B9%A0Vuex/app" target="_blank" rel="noopener">【这部分代码】</a></p><p>先在 store.js 中编写 mutations ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  changeStudent(state, param) &#123;</span><br><span class="line">    state.studentlist.push(param)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>第二个参数接受传入的外部参数。</p><p>在 AddStudent.vue 中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  add() &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">"changeStudent"</span>, <span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意写法，对象是 $store ，使用了 <strong>commit</strong>。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/dfagaha.GIF" alt="dfagaha"></p><p><br></p><p>在 mutation 属性中智能传递两个参数，如果我们想传递多个参数，可以把参数写进一个对象，然后这个对象作为参数写入 mutation 中。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  changeStudent(state, &#123; name, number &#125;) &#123;<span class="comment">//这里注意对象参数里面的元素命名形参和实参必须保持一致</span></span><br><span class="line">    state.studentlist.push(name + number)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>在 AddStudent.vue 中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  add() &#123;</span><br><span class="line">    <span class="keyword">this</span>.$store.commit(<span class="string">"changeStudent"</span>, &#123; <span class="attr">name</span>: <span class="keyword">this</span>.name, <span class="attr">number</span>: <span class="number">12</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>【注意：注意对象参数里面的元素命名形参和实参必须保持一致】</p><p><br></p><h2 id="mapMutations"><a href="#mapMutations" class="headerlink" title="mapMutations"></a>mapMutations</h2><p>和 mapGetters 一样， mutations 也有便捷操作。</p><p>在 AddStudent.vue 中，先引入 mapMutations</p><p>然后在 methods 定义：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  add() &#123;</span><br><span class="line">    <span class="comment">// this.$emit("add", this.name);</span></span><br><span class="line">    <span class="comment">// this.$store.state.studentlist.push(this.name);</span></span><br><span class="line">    <span class="comment">// console.log(this.$store.state.studentlist);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// this.$store.commit("changeStudent", &#123; name: this.name, number: 12 &#125;);//mutations</span></span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line">  ...mapMutations([<span class="string">'changeStudent'</span>])    <span class="comment">//mutations里的方法叫什么这里就填什么</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样在 AddStudent.vue 中就有了 changeStudent 这一方法，直接使用即可。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;AddStudent&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是addStudent&lt;/h4&gt;</span><br><span class="line">    &lt;span&gt;添加学生&lt;/span&gt;</span><br><span class="line">    &lt;input id=&quot;input&quot; type=&quot;text&quot; v-model=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;!-- &lt;button @click=&quot;add&quot;&gt;添加&lt;/button&gt; --&gt;</span><br><span class="line">    &lt;button @click=&quot;changeStudent(&#123;name,number:18&#125;)&quot;&gt;添加&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>如果想要<strong>重命名</strong>，如下操作：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  add() &#123;</span><br><span class="line">    <span class="comment">// this.$emit("add", this.name);</span></span><br><span class="line">    <span class="comment">// this.$store.state.studentlist.push(this.name);</span></span><br><span class="line">    <span class="comment">// console.log(this.$store.state.studentlist);</span></span><br><span class="line">    <span class="comment">// this.$store.commit("changeStudent", &#123; name: this.name, number: 12 &#125;);//mutations</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...mapMutations(['changeStudent'])    //mutations里的方法叫什么这里就填什么</span></span><br><span class="line">  ...mapMutations(&#123;</span><br><span class="line">    newChangeStudent: <span class="string">"changeStudent"</span> <span class="comment">//重命名</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在标签里触发这个 newChangeStudent 即可。</p><p><br><br></p><h1 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h1><h2 id="异步操作下的情况"><a href="#异步操作下的情况" class="headerlink" title="异步操作下的情况"></a>异步操作下的情况</h2><p>我们尝试在 mutations 中模拟一下异步操作，实现点击后过了1秒再执行 mutations 中的动作：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  changeStudent(state, &#123; name, number &#125;) &#123;<span class="comment">//这里注意对象参数里面的元素命名形参和实参必须保持一致</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      state.studentlist.push(name + number)</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>然后发现控制台报错：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/1562376986538.png" alt="1562376986538"></p><p>还是之前见过的报错信息，提示不要在 <strong>mutation</strong> 处理程序之外对vuex存储状态<strong>state</strong>进行更改。而我们在 mutations 里面的 setTimeout 下对 state 进行了修改，作用域不在 mutations 下，因此报错。</p><p>还有一点非常糟糕的是：如果我们这样写了，在点击按钮的时候用极端的时间点击了很多次，当后来我们想要调试的时候，回不到正确的 state 。我们通过 vue Devtool 调试，当我想要看第三次点击时的 state 时，结果左边跳到了初试的 state 状态，因为我的第三次点击时，第一次点击还不到1秒，state 还尚未被修改！如下图所示</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/faga.GIF" alt="faga"></p><p>于是我们可以使用 vuex 中的异步操作 <strong>actions</strong>。</p><p>mutations 是用来执行修改 state 中数据的操作，actions 也是，但是特别的是，actions 专门用来进行<strong>异步</strong>的修改操作。<br></p><h2 id="应用（四）"><a href="#应用（四）" class="headerlink" title="应用（四）"></a>应用（四）</h2><p>在 store.js 中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">  changeStudent(state, &#123; name, number &#125;) &#123;<span class="comment">//这里注意对象参数里面的元素命名形参和实参必须保持一致</span></span><br><span class="line">    state.studentlist.push(name + number)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">actions: &#123;</span><br><span class="line">  changeStudent(ctx, &#123; name, number &#125;) &#123;</span><br><span class="line">    <span class="comment">//这个参数ctx是上下文对象，相当于当前的$store</span></span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      ctx.commit(<span class="string">'changeStudent'</span>, &#123; name, number &#125;)<span class="comment">//这里调用了mutations 中的changeStudent方法</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 AddStudent.vue 中，通过 <strong>dispatch</strong> 来触发 actions ：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  add() &#123;</span><br><span class="line">    <span class="comment">// this.$emit("add", this.name);</span></span><br><span class="line">    <span class="comment">// this.$store.state.studentlist.push(this.name);</span></span><br><span class="line">    <span class="comment">// console.log(this.$store.state.studentlist);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// this.$store.commit("changeStudent", &#123; name: this.name, number: 12 &#125;);//mutations</span></span><br><span class="line">    <span class="keyword">this</span>.$store.dispatch(<span class="string">'changeStudent'</span>,&#123;<span class="attr">name</span>:<span class="keyword">this</span>.name,<span class="attr">number</span>:<span class="number">12</span>&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuex/dfagaga.GIF" alt="dfagaga"></p><p>在这个例子中，使用了 actions ，每次点击按钮的时候它都不是立即就执行 changeStudent 方法，而是每次都等候1秒再执行了，这就和用 mutations 内部 setTimeout 不一样，不是楞头地立即执行，导致 state 混乱。<br></p><h2 id="mapActions"><a href="#mapActions" class="headerlink" title="mapActions"></a>mapActions</h2><p>同样的，actions 也有便捷操作。mapActions 返回的也是一个对象，里面都是函数。</p><p>在 AddStudent.vue 的 methods 中创建 mapActions：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  ...mapActions([<span class="string">"changeStudent"</span>])<span class="comment">//actions里面的方法叫什么这里就写什么</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样 AddStudent.vue 中就有了 changeStudent 这样一个方法，可以像普通方法那样使用：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;AddStudent&quot;&gt;</span><br><span class="line">    &lt;h4&gt;我是addStudent&lt;/h4&gt;</span><br><span class="line">    &lt;span&gt;添加学生&lt;/span&gt;</span><br><span class="line">    &lt;input id=&quot;input&quot; type=&quot;text&quot; v-model=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;changeStudent(&#123;name,number:6&#125;)&quot;&gt;添加&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>如果要<strong>重命名</strong>，如下操作：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  ...mapActions(&#123;</span><br><span class="line">    newChangeStudent: <span class="string">"changeStudent"</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在标签中触发 newChangeStudent 方法即可。</p><p><br></p><p><br></p><h1 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h1><p>未完待续</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue音乐播放器（一）</title>
      <link href="/2019/06/01/01Vue%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8.html"/>
      <url>/2019/06/01/01Vue%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8.html</url>
      
        <content type="html"><![CDATA[<h1 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h1><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/djgalghl.jpg" alt=""></p><p><br><br></p><h1 id="vue-cli脚手架搭建"><a href="#vue-cli脚手架搭建" class="headerlink" title="vue cli脚手架搭建"></a>vue cli脚手架搭建</h1><h2 id="vue-init-webpack-vue-music-方式"><a href="#vue-init-webpack-vue-music-方式" class="headerlink" title="vue init webpack vue-music 方式"></a>vue init webpack vue-music 方式</h2><p>我之前安装的是vue cli3的版本，事实上<strong>cli3也能使用2.x模板</strong>：需要安装init模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli-init // 安装这个模块</span><br><span class="line">// 就可以使用2.x的模板：vue init webpack my-project</span><br></pre></td></tr></table></figure><p>然后执行<code>vue init webpack vue-music</code>指令生成项目，同时需要配置一下部分插件的安装，具体如下：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560070220037.png" alt=""></p><p>然后进入vue-music路径下执行<code>npm install</code>或者<code>cnpm install</code>进行安装，执行<code>npm run dev</code>运行项目，在<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a>打开项目。【我这样做的时候，在npm install时会有些报错，然后使用cnpm install才ok】</p><p><br><br></p><h2 id="vue-create-vue-music-方式"><a href="#vue-create-vue-music-方式" class="headerlink" title="vue create vue-music 方式"></a>vue create vue-music 方式</h2><p>使用Vue Cli 3 的方式创建项目。</p><p>在选择配置时，选择了</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560149666215.png" alt=""></p><p>其中css预处理器选择了stylus，没有选择路由的history模式，选择Eslint代码验证规则为&gt; ESLint with error prevention only，lint规则检测选择Lint on save （// 保存就检测）。</p><p>然后cd进入vue-music路径下，执行npm run serve,在localhost:8080打开项目</p><p><br><br></p><h1 id="项目目录准备"><a href="#项目目录准备" class="headerlink" title="项目目录准备"></a>项目目录准备</h1><p>把一开始src里面的文件夹删除了，然后构建如下目录。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560153149793.png" alt=""></p><h2 id="stylus"><a href="#stylus" class="headerlink" title="stylus"></a>stylus</h2><p>其中的variable.styl文件专门定义变量，<strong>实现样式的语义化</strong>写法：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560153216549.png" alt=""></p><p>reset.styl用于样式初始化</p><p>base.styl用于基础的样式，其中引用了variable.styl</p><p>icon.styl: 图标字体文件</p><p>index.styl: 里面按顺序一次引用了”./reset.styl”、 “./base.styl”、”./icon.styl”，注意顺序不能乱。</p><p>关于stylus还需要再安装stylus和stylus-loader，版本号见package.json</p><p><br><br></p><h2 id="初步的小demo"><a href="#初步的小demo" class="headerlink" title="初步的小demo"></a>初步的小demo</h2><p>此部分的<a href="https://github.com/Dunteng/Vue-Music-WebApp/tree/v1/vue-music" target="_blank" rel="noopener">代码</a></p><p>页面效果：</p><p><img src="https://github.com/Dunteng/images/blob/master/BlogImages/illustration/vuemusic/1560174717845.png?raw=true" alt=""></p><h3 id="App-vue"><a href="#App-vue" class="headerlink" title="App.vue"></a>App.vue</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">"stylus"</span> <span class="attr">rel</span>=<span class="string">"stylesheet/stylus"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">@<span class="keyword">import</span> <span class="string">'~common/stylus/variable'</span>;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-id">#app</span> &#123;</span></span><br><span class="line"><span class="undefined">  color: $color-theme;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="main-js"><a href="#main-js" class="headerlink" title="main.js"></a>main.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"><span class="comment">// import router from './router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'common/stylus/index.styl'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="修改-eslintrc-js"><a href="#修改-eslintrc-js" class="headerlink" title="修改.eslintrc.js"></a>修改.eslintrc.js</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560174225507.png" alt=""></p><h3 id="webpack-base-conf-js添加别名"><a href="#webpack-base-conf-js添加别名" class="headerlink" title="webpack.base.conf.js添加别名"></a>webpack.base.conf.js添加别名</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560174286025.png" alt=""></p><h3 id="其他的坑"><a href="#其他的坑" class="headerlink" title="其他的坑"></a>其他的坑</h3><ol><li></li><li></li></ol><p><br><br></p><h1 id="页面骨架开发"><a href="#页面骨架开发" class="headerlink" title="页面骨架开发"></a>页面骨架开发</h1><p><a href="https://github.com/Dunteng/Vue-Music-WebApp/tree/v2/vue-music" target="_blank" rel="noopener">此部分的代码</a></p><h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="index-html加meta标签"><a href="#index-html加meta标签" class="headerlink" title="index.html加meta标签"></a>index.html加meta标签</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560180906762.png" alt=""></p><p><br><br></p><h3 id="package-json添加新的依赖"><a href="#package-json添加新的依赖" class="headerlink" title="package.json添加新的依赖"></a>package.json添加新的依赖</h3><p>npm i babel-runtime –save   //ES6语法转义相关</p><p>npm i babel-polyfill –save-dev    //ES6一些api的转义</p><p>npm i fastclick –save   //解决移动端点击300毫秒延迟现象</p><p>【<a href="https://www.vanadis.cn/2017/04/28/difference-between-babel-polyfill-and-babel-runtime" target="_blank" rel="noopener">babel-polyfill和babel-runtime的区别</a>】</p><h3 id="改写main-js"><a href="#改写main-js" class="headerlink" title="改写main.js"></a>改写main.js</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYkAAAE0CAYAAADZic8WAAAgAElEQVR4nOzd%0Af1BUZ57o/zdiFIGGJvKjicgQBP0qKIhkNIMScbwDLIyT+41mnJGbVCLJrVWs%0AzE751azi1NZKMsabO3dTQW/tREzNfjVxJqZq1itX2Ouo64+JGREx/sg3gqQH%0AcQXB0NC0Iv7g+8c5/ZM+0A0Njfp5VWXG7nPOc341z+c8n+fpfgIWL17ch7Ax%0AmUx89913/j4MMUKefvpp9Hq9vw9DPCJMJtMT/3kZ5+8DEEIIMXZJkBBCCKEp%0AID4+XtJNQggh3JKWhBBCCE3j/X0AQjzOSrds9nqbsq3v+PwYPC1zsHVdl4+F%0A8xMjS9JNQowid5Wsu0rTl5WvN0FisGPyVbARjw4ftiQW8/PlS0kwn6ei+jNa%0AfVewn02gaHs0+toblO97YH87J5zShffZtdVCi9dlBpK3JZbIk83sOTqEQ0oO%0AoeSNCJSBeWYObuikbgjFDIlP9q2cf6ZOfdl0k7LyXtvS9JI4CuN7qPmonap6%0A+1aGlZEUZwS53cZ6nxIA6L+tcxn3Bj3u9FWbWXirgvIqx7trIG/dD2n5cO+o%0AXG9vK3bH/9darrUf1+WelOOroDQwD695bC4lxZGc3Do69+ZJ8vinm3QrWJMb%0Awan9v+W8v4/FV+otlG+wqBX2KN9CH+zbsDKCTDrYtcG7ANuyr52yfWpFH+m6%0AtJc9G5pRgkXYkI7LJjaXhYlGTu61Hp2BvHUvwf4dtHzn/LrqxuDFDVYBu6t4%0APWltOHK3nafbutvOG+4CilaQ8Xw/3l3z9CWZcKZCAsQI8GENc4xP9h/zXXFj%0AjKn1weArCY8YIoMw1XdoBoi68uaR/WM33x8wOBnSkuDM5w7H0ELVh5+Tt24z%0AhXpgy2qMle+wx4MAYWWtHAdKNw30tD9YS0BrG2+ChqcVu7syhnt+/XlzzdNJ%0AdQrqoyOMProIGNV9+oNPgkTMzLdZnRKqvGg+zLunjzkte4mrmFLSSKCJyi+g%0A4Pl4+3pT3mTT1CtUdC6wlWG6tJudXzeqJahpLGuBTumsRHJzX2fyxVIuTS2j%0AIA6gm7PV26g2O29XsLyMAhyXe3p21idU9xxTICaXlJRTesRtCsQxReKaunFc%0A1r/soZtA0fZJXPzoPgutaSNzh1PazPm4wXjIs7SYYWUkxcl3+pfl9F4ghgig%0A3U0Bo5BGa9nXTtmAa6Sz9Dlo2DVQhWOi3YsA4Qujld93FxCs/+/fPgbta27I%0AyyKh8RR7RuEoouijiF4mAO8xcRT26H8+CRKtX2/j3a/VYBHef7k+ZRpXq3dz%0A6wevU5B6norqDl7KnU4ax5QUUNxSVnOYd/cfU9NDL5PbvI1qcyK5uUvRX9rN%0Au183Yg0Kqxe0OQWihOfLlHVON5K2oIyClMVUn1ZbNiOZbtJFUBh5k7IN7bYK%0ALu+sGgiSQ1hKB2UblIrdsDKS4pUh1DlUoAn5YdR81MyeejUPX3KHuvJelJy9%0A0g9Stu8BSsUeS1HrEPsw+h84hW+YObihmTq1f2D5yh4lCOWEqzn7dqWCzgmn%0AND+SvGb3OX5HLWfvYMqYRHqyRV03kPRka6vBOeiREUtpBjgFT3+m0VS2Csep%0AQrKmOt7h4JJVsPdPGNatJc/DdBM4P0V7mv+3LhtK5TyUjm9f8c2+Pb3mSlCv%0A2TWyiaa5PGAVvazgHp/xFOuZNKL7G0tG5y+x+TTVZsgFjBc/o5UVzsvN56mw%0AVvrms1w1pzE5DAhbyjxdE5W2VkUj1X8+zzTHAAPQfNjW8jh/rYmC1ChiYOQ7%0Az80d7LJ2ntb30GCOIGleINQ/gHoLexwqVaUCHY8BbEHCeMhe8dZdMlOYP4l0%0AeqlLDiKJDvbbWg69HK7toThlAhx17Kwdqh5qPrI+pT+grr6HzMhAAPIW6jDV%0A3rA/wR/t5GBKHAut5zWQegsnmyLs6yYHkaQzc3LfA+CB2iJTglJSva9aRr5k%0AID1Zj/GUa4XTQtWHOwADeU9Di+21Z4baT+C4vjf7sJav1Zk9UOezLyr44Q6R%0AVXh4zTNSSDA1cHiEWnYruMcq7jGX+wBcJpD/+YS0IKzGbMe1PiwRugCzdu7a%0AynjNoS/k+m959/pIHpmWB7R0QJLttcsIHgAGyHE138dkvR1x49HrdBRvj3Be%0Ap6nLs0NxStso+x00dRPxFAaUSns4/S91l8wULgzCgAXmTYLajkenMzHjh2RS%0Aw65arRVaqPpwr1dFDnW0kbt/e7KPgfoLtJZrrTvYcY6Oga65gbysBIyn9g5h%0AhKE2a0ppFfeI4qHTslk84AjddBHAFwRSx3hqGcfpsVuVDtuYPTNTl9p60EVg%0AwKFVEOZY+Y0lSq7ddEmpYNNLYp1H8AyWQokbj96xQ9Wln8Ar1rSNNzru2fal%0AjwkErIFigD4Ed47ewZgfRnpyDyRDw5hrLWhLn5mAqf5PPq1wPGlF+DLfPxa+%0AmzBqgSU2jSS9kZOaQd07jimlwYTRRy73yVVbGACnA8ZT2xdIHYF8QeBj06k9%0A5oJEzMyXlRTTdYArGFlK1sxEzlv7JFLjMV3a7Xn/grkNE2mkTIHzI9nCyAkl%0AU2fmoGOfga3iDSRvZQR6zZZEoJLmqb+hrH/0Dsb8aHs/wUhKDmF5RhDGQ0oU%0AqKvvITMjlPR9asvDel4eH0cvh2uheGUEpo4uygfpxxgz+g179T2toaLD+TLd%0ASHw7e7h8k24anK+GvU7jIf+dHltKaagW9N1ngUMZVwmklnF8yXhqCeTqI/or%0ASD4IEkpn8jxbWmUpm5Yv7TfKaUC6NFYvT1NfNFFp62Q+xif74efLX2dTirq4%0A+bDaie2pY3zyxXQ2PV/GJsD70U0DHXeEQ0rIOaVTV93BwjeiKd2uvDbWdmDK%0AcL7cCflxlOYr/3YevdTLng03Kdpu7dxVy1BHGbmOPircrqPQq9FAQWS+EUem%0AS7mgjP7ZRSTF2+MoBKwdy9ZyPdm30v8Sgemkp80PT8p2Td8FKdfW+qW6nHBK%0A8+25vYQ34sgc4Et1/fadloS+8dSIpsbcDQXVquT91SLQSjeNhRaKs3RSE000%0AHBl+UL/KOP6JibzPw37ppeGYxgOm8cDWMnlUU1T+/1mOKW+yKbXjMfuW9lim%0AfNms3cPKc0jU1NrJ0fwm+LCkU7Qli/Zdno9WGgp3Fa4nAcOTcn3RGvE0FTac%0A32/yVbAx5K2lePIpyvb67hMWRh+/osejdJOmAKAvAPCsWn0UUlSPRigTjxAl%0AtYbjCKkxr449W0fmaAcLAt5+s9pd2d50RHtb9mDvebMfX6aeWqp2DPJ9F+91%0AEcB6JnGQCbzPnaG1Kvps/2PnGjiscaAvoF+KqpFAzjKO3UzgMoHe738ESEvi%0ACfMw6Cle+cdw2j9q57OnzHQs6GDCdxOIropmXI+SMzXPGsr73RRNe47sp7Cl%0AgIZWzsi9L4Sn3LUqzjGef/dBxR2nBp+ngWAeMhGIClCqYUNfH+Pp43TAeH7a%0AFzzsffmC/4OEGFVNrzcR90kclkQL5plmog9HY0m00Dm387F9P353vL8vu3hE%0ALeaBrVXRxjiyCOWuvw9qlEmQeMJ0zu2kc24nAM98/gzjO8c/9u+Hn3PzMwBC%0AeMixVfGPBFHBBH8f0qiSICGEEB5YzAM20sOLhDxRrQkJEkII4aEw+gijj+ZH%0A9DsPQyGjm4QQwkNdBIzJYaoj6ckJh0IIIbwm05eOcU5zdTh9G92f1G8/d7hO%0AIfq471uIJ8/jn24a0nwSecxeuwyOruHCZcf3Z5DwylvoalzfHyG6FbyUAmer%0AS33zMyJCCOElmb7UrSpari1jdlIeXK6yvx39A2J0jTSORoAA5RdvzVepG6MB%0AwtTuv1949ee+hXiSyPSlGtoaGiEnlSiqaFPfC5kxg5Brx5TXs9azJPMWX/7L%0Axyg/yp3H7LWLMX/2Nsab6vqLtjF/Tpi6dSMXdrxvK8uj6xr2NNDRf4H1W+p/%0Ahpdy05SfTne67trXbND74ZEHVG3tP6XroNOX5oRTuvC+w/L+vyPl/CN/7n60%0A0P2+hRAjQ6Yv1XL5Im05yzDMgrbLADOIejaMtpqqwbZUzFrP/DntXNjxNm2o%0AAeOV1xyCira0BdaAB2D/hVyn4KlLY3VuE5X7SzmvW8Ga3AXk6o55dM0GvR9D%0A1H/6UjBEWqcv9YDL1KmGlZEUbwmhZajzagghhm10Rjep05eCdfpSF/2mLw1V%0Api+dokxfespl+lJT3HTSHLd3mb6UcGX60uGpouUaRCXlKS/VVFOLh6mmqKRE%0A2o7aWw6WE8do080gKnrwbc+fLuXd/aVUXOpWrs1+5fVOp59I7+ZstRr4vL1m%0Ag92Poaq3cLIpSJnCFYAJpMZbpy8dXHqKDuMhh58c39eFUTeJ9GRfHaAQwltj%0AtuN6LExf6phyuu2YahrUDEL0EJWzkyU5ju93DTSBqXec+ioaqa4uVf45BY+u%0A2UhxnL60JWcSCU132OPRlsoMeI5zbCh6PJ4UTwjhe2M2SIyJ6UttKacZmL1J%0ANana+o2OGiX+vGa26UsttKToMF7q9GpzxwmQhBD+N+a+TGedvvTSdeD6FYzE%0AkzUzUV1qnb70sJfTl8aTMmUoR6OmnDJfc59q0k1G+THfGSS8sowo24JvaPu2%0Ai6ic9Q7vjRJfXLNh6eViUxCRcRNIjejgsGuFrxuPAVC+7xBt71znAXX1PSTk%0Ah5M+KscphPCETF86CCXllNg/1XT5fS4k7WT22p3KekcP0Jaz2LbYcuJtvmQb%0A89XlAJjPeNRxPTy+uGbDY526ldobzmmvo50cTIlTpyUF46GbGPPDbIv7T50K%0AmDucRksJIUaX/3/gTyYdEkKIMWvMpZuEEEKMHRIkhBBCaPJ/ukkIIcSYJS0J%0AIYQQmiRICCGE0CRBQgghhCYJEkIIITRJkBBCCKFJpi8d4x7r6UuTQyh5Yzwn%0A+80ZMXKU+SruuZmnQgjhzpj9gT+fGep8Elaz1rMkJxGuHeDIAe9+4G/YHvPp%0AS9NzI6D2hktlrQYgXQ81DpMRCSH8Q6YvHYQyL8SBfrPUjYrHevpSda6Jcpcy%0AkoNIooODtZNYOC8Q6kdgmlLzffktKCE8JNOXDigPw9QuzKersFxznKUOpYWR%0AdJEvOxbbpii1fPUBX574BlBmokvlYxoj3mL2VGUTb386/FGbvtQbhpVhJDR1%0A9ZtrwjBvEvqOLurOwsKV6rwUgNLCiIB9XUS+Yf31WIfpTXPCKU25w672MNv0%0Ap6baG5S7THjUsq+dsmEduRBPlsDw8PB/GG4hlvaTnLh8hCt93ycjqJkTzUbb%0AstCohfwg5WmuVu/hRsxiXog2UnGslcSMOHovn6U1bB6LUuaS0Xucd/9tNyeu%0ATea55xfx9LWTXO1NJDf3JZ5p2M1vjn/OictGgpPyKYh6qO4jgqSkucyatoTo%0Aa8o6XWF5vBD9kBPNx7hw+Qgnrk1mdlIvf9r/39h/+QgnLp/kqqdp9Fkvkhp5%0AjSt/ruNe9CKmTxnPt980KMuifsCzaQuI663myJ4P+Pav0cQtWcpTfz2MyQIT%0AvreUZ+e8QOhfP+Dk/n/hW8tMUnN+QPeZP3N7kN2mLShj9YIlZERPgIkGMmYt%0AYdGsJczuM3KmvQPC5rFo2gwyrOd1bTKzM+Z4dM0GvR9D+QB4bQIvvjKRhj+Y%0AafjO8f1AFv7nCHrPdvDV2QCmF4YSZrytrjOOpBciyHw+kIaPWtj9+y66ZkRR%0A+P0ejv/lATwbRHbm02Tc+46ydzo4bnzA9wt1PG3bXggxFDJ96QCikhKxfPtn%0ALIDlm2+wTE11nh/CfIYvrf0UN/9MqzkMXaTD8msHbC0LLl+kjUhCHufpSz2V%0AM4kE8x3qXPsbkoNI0pm5eBSs81LYp0JVGA/Z+ynqLpkh4il1fgqUnxW3dqTX%0A99BgDiIyDiHEMIzZIbD6MHXSnKFMX+qT0VVKqqn1G7WSv/lnWs2JGGYNvFXw%0A5BkDLHUJIsPhZvrST6zTtvpx+tLBBZK3UIfxZP85IgzzJqFvumPryK67ZEaf%0AHGQPAu7YJjFyTx8TOMBSIcRgxuzoJr9PXzorlSjCiFqxk0TH95Py4LL2KKfb%0At74ZoNAuzKMxYbM/py8djNpaONlvitJA0pODQBdE6XbH93tIT7Zoj3IapBPa%0A1DoCHd9CPEHGXJCwTl9aeR3gCkaWkjUzkfNfN2KfinO3l9OXppEyBc5fH3x1%0Aq5DJkf2Hvc5azxKNUU4hi14jUdeo2TEdtWwZUeYzNN70/BiG5PrA18wXabhB%0A5YRTmq+Dpv7fo3A/7BUgkMh+w16V4bBJ8wKhX5CYQFG+DpPr7Hcqw8oIMnVm%0ADsp82UIMi0xf6tYMop4No63GpcVw+SJtOeooJwDdc8xf+5y6sJELO953Dh5T%0Al7Fk7TLl36MydSmMhelLtU0gNb6Hhmo3T/dqP8Vhp2CgzHudmRyEgR4AEvLj%0AKM1XlvYbvaSLoHh7hPrCLF+YE8IH/D+fxKM6fems9SzJvKVZ8Ycs2sb8iGOj%0A/wW8McywMpLiyK4hfktbaVVEnmxmj7vWQU44pQvvy3zYQvjYmEs3iceXfEdB%0AiEfPmB3dJIQQwv/8n24SQggxZklLQgghhCYJEkIIITRJkBBCCKFJgoQQQghN%0AEiSEEEJo8slPhbtKX7WZ5VPq+UtDt5ulBvLWvcWC+yf46obHJVK0ZTXL0oK5%0A8peruCtVjC2GvLX84mc/IvuFbLJfiKfr+IUx8SU35bimD/N4hvIZHsMyVlFa%0AnE1w/Rnc/smKJ5rvv0wXm8vCRCMn92r8CWb8kExq2FXr8z2PvthcSoojObl1%0A75j7+Yf0VZtZeKuC8io/VM2xuSx/Dmp2vUPV41CJuhrtz/AY/pyJx5/Pg4Qh%0ALQnOfK75YU6fmYDx1F4vn+Lq2LNV/jweGbGR6E0N1I3VAGFqH1arZmif4bHO%0ARMtYvV/Cr3z8Zbp0irZk0b5rh/snyCE8ERny1lL8nPpD142VlO2tc1q2nAZM%0Az2WSgJGDlVBYkGBfL2MVpTMvsetWlq0M0xnnp+v0VZsptP0WuIkah2O3Po3v%0A5yXb9sbKd9hTm07RlgL79KC4334g2mU7XqtM+098O5y7IW8txZNP2a+Fw3Vt%0AcbxejpyunfPxO10TW1mXSLWuY6ph14fVHleKhry1FCc39N/Gg7I170fGKkpn%0AtlPzdCaZehM1lQ0kFWSi9/LYhs3dZ3g45+Xmb8beCjR49Dlz+hvByEGHYxv0%0AcybEIHzaJ2HIe4kld0+x+8/u/2TTf7KS+IbPOeBF4rO74QzHj5/gSvAcMoKv%0AcfyCvezQpO/zg+eepmHXXv4jcQmL4xvYtec/SPxhAr3HL9ASO4fs+d8n4+6f%0AKCv/jOP1wXz/xwt5Ws29GvLWsjLuIrv+28f87+MnuBL8fQp/bM9XG+ZkMyc1%0Aw7b9leA5LEl/mit/OcWfj5/geH0wczJ6Obx1B384foLjxz3P6WqXfZVu0in6%0Au8X0VL5D+e9PcPy4mfgXC8gOVvp5QpO+73wtdEl8PyOYpuMXaFCvV9fUbKIb%0AKnh/9yGOHz/hcN0M5K37Kc9csC4zM/1nP2VOt5pf1yXx/YxZzHkhmoZd/53d%0AlWbicxeT2D14/j191WaKX8wmY0oQBD1DxgvZZL+QzRz1uAcre8D7ETuH7Pmz%0A6P3TO5wc/yMWz+/l8NZTTMhNJ2wUc+luP8PDOS8MzHkhntu19nMwzMkm/s45%0A/tLQwFeDfc4yVvGLxT0cVJddCc5mZf7Ttr67gT9nQgzOh6ObDKQn6zF+rZlo%0AIjXRRMN5Hz/zNZ6yPVEZT7l5ojTVsMv6BH3jPA0mPZGxyvEsfU7vtE1L1efU%0AmBJIzXC/fcv5Bkz6yIFnSvOGRtmGvCwSTDUctj3t1bGn0og+OW34+45NI4ka%0A9ttaU3UcPmMiYWa602rGSuuTah0XG0EfPfie6/a+Q9nWd9h1xqSc21bltWu/%0AiPuyPbgfDtfEdOZPfsjPD/wZHvJ5DeeIZiZgrLS3HFqqTmHUJ5Ee67DSSH6G%0AxWPPd30Sg3TmGfKySGg8xZ4xkPe0V3gm2gc5HlP9eXvguVFN+VbfHYdW2QaA%0A71pHJoUSG4len0Dxlkzn952mmzBy0eE+1u19x4cVslbZBjy5H/408GfYH+dl%0AwPA0JBRsprTA8X0TjhMgjuRnWDz+fBYk0mcmYKr/k0bFprYyTo2NzmfTzRaU%0AP161VWH7AzYQOVbm+Xw6BgPYrqchWg/4aO7T0c7je2wM349hfYZH9rykj0GM%0AJN+km6zDXrWGW6qtjMN+/iAb8l4iU2994lNSAglZubamd/80zyButGLCN2kD%0AR0pKIJOltnL7pyysQQTSKXLs4LaWccvkPj1VewmjPpPleWMt4eCD+zFcsbmU%0AbNlM6brc/tdtyJ9hT87LmgJV+i8KE12K0PyctVBXbyKhYBXprouE8BGftCQM%0AaUnoG08NOOxVu5UxYMnkrVtNpq0GLKB0S0G/UU4D0mc6pFacR37U7X0HVm12%0AWe7NE3YdeypTKLU19z0f3TSgG9WU74KSYnsawXSmgnK1Ummp+pya5NXqcZuo%0AqaxBXxDpVITzOjhcszr2bIWiLaspfc6+/lh4Gh3+/Rg5Q/8MD3ZeLp+hxkoO%0ANhaw0LkEzc9ZS9UOdrGW4i2bKbSuPmZbiuJR5IMhsL4f9uozGasozWqXPxgx%0APPJlNvEEe7wnHZIgIYQQwyI/8CeEEELT492SEEIIMSzSkhBCCKFJgoQQQghN%0AEiSEEEJokiAhhBBCkwQJIYQQmnw46dBifr58KQnm81RUf0ar7wr2u5BF25g/%0AJ0x91ciFHe/T5s8Din6N+SueI2TA48lj9tplRJnP8OW/fIzF07JnrWdJDsM+%0Ax5iZb7M6JVR91UTl/t9yfhjl+YphZSTFGfc4uKHT/RfjcsIpzdepL3qo+aid%0AqvpRPMB+JlC0PVqdU0L7eNJL4iiM9/J4c8IpzUf7WqgGvWbiseb76UvHGt0K%0A1uRGcGqolVT0a6TOgcbP1mC86dtDi1q2k8SOD/jyxDfebXjzY77c8bEaLCb7%0A9qB8QbeCl1LgbHUp1WZ/H4w3JlCUr8N4qJk9R31bcnpJHAvbb1C+74GXW/ay%0AZ0OzcmzbwwZdWwhf82GQOMYn+4/5rrixInIyIeZvaPNxgBh5VVzYUeWfXYdF%0AoDdfpW6sBgjzffffwE9+Cj1mTvo4QIyGuvLmkX3K17pm4rHnkyDhlFpoPsy7%0Ap485LXuJq5hS0kigicovoOD5ePt6U95k09QrVHQusJVhurSbnV9bJzhQ01jW%0AAp3SWYnk5r7O5IulXJpaRkEcQDdnq7dRbXbermB5Gcpv5VmXe3ZuIZMjgVvu%0AF85az5Ic+092th1dw4XLDts6pansy53en/oWS+aoK1w7wJEDVYNuP+gxO27n%0AUqa3ZVvXs3zleYsnJuxpoKP/Alur7gop1nvjkp5MW2C9j+B0r6a8yaapHZwN%0AT2OerpuzX1xl2vNp6L1Mb7bsa6dMa2Hc+H6/pmvnmPYBmm5SVt5rW6qkZIJs%0Ar62tEaf342MpzfBu+0Elh1DyRoR63Ga3KSFPy7auZ6p1bvEMeM1GQRh9dBHg%0AxyN4svkkSLR+vY13v1aDRXj/5fqUaVyt3s2tH7xOQep5Kqo7eCl3OmkcU1JA%0AcUtZzWHe3X9MrUheJrd5G9XmRHJzl6K/tJt3v27EGhRWL2hzCkQJz5cp65xu%0AVCqZlMVUn1ZbNkNMN0Ut28nsqdZXzzF/rfKTqfbKMo/ZSRc5suN9ZZVZ61mS%0As56oy2ouP/o1Uue0c2HH2/1y+5YTb3PkxMDpJqVydr/9YKzlhyzaxvyI/ss9%0ALdvbY3Cu4NNYvTwNcA368RQsf5qz1aV8ogbyH075jE+uK5+fgvDzVOxXKv2Y%0AmW+zOvdNWqz3Li6NyV+UUjm1jILnI6jcf5iU5QtI1zGstJZrJVq4Xaf8oqpD%0ARZ5eMomLG5rZA1gDRlGOWtkmh7A84x4HN7T3q6Bb9rVTtm/gdJM9599/+0HV%0AWyjfYFGDRf8/Z0/LHtYxjJC5PGAVvWxmkr8P5Yk2On0SzaepNkMuYLz4Ga2s%0AcF5uPk+FtdI3n+WqOY3JYUDYUubpmqi0VTCNVP/5PNMcAwxA82FbJXT+WhMF%0AqVHEwLA6z9sOrOEIakX57DduOn+ruHDA4eXli7TlLCYkGofUVCKGWdDmwdO/%0AszwS54TRdtT7AOGrskMWbWP2nHavOrDPny7lPGrlHn9V8wnf+IW1JXeMS81L%0AyQpLhOvx/DAlFOMX9m1av/4DZ+NfJ2UKyr02n+dP18EwFUyXDnOeeFI8Pm9t%0A1op8oI7cuvJOh1e9XGyChTGBgLXS15Ga00md16mqCSzNCMJ4aCQqZ8/KNqyM%0ApHAMdUzH8ZCN3CWX++QTwl1/H9ATbsx2XOvDEqELMHcMmgs1XnPoC7n+W969%0APpJHZufc2gDowvZAe/Njvjw6mSU5O1mSA3gzyig6lmC6aPXRRHTel51I4hzg%0A2rERCFJNXHK4P9bAAvFAN7e6fL5D33Aa9aQwWa9hvYXyQ+MpzY+jNB8wd7Br%0Aq8WzHH7yU+jpoaHZx8frcdk6MjOApi6/B4gw+vhbellNLxPpYz2TuCqj9P1u%0AzAYJU5faetBFYMChVRAWMUDeePSELNrG7KmOw0/zmL12sfNKl9/niNqKiFq2%0Ak/mv4FmguHmD28zw+TF7XnYjF3ZcxLB2GfMXfev96KshC1VakLZIG89k3QCr%0Aj5bkEEpcRj2ll8Q5Twx0tJOyo522ZcVb8CxQ1N/DNFLpFI/KNnNwwx1St0dT%0AsnIoo698o4h7/IK7RPEQgHOM5xoBzOIBlwn0yzEJxZgL0zEzX2aeTn3avH4F%0AI/FkzbR2DieSmxqvpho8ZG7DRDwpU0bgYM23uK3+M2rZMqIGWPV2R/9H5Nsd%0AXYQ8+wP1+w6Oqmi5FkZi3mtulg2Xp2VXceGzMzDnLWbP8vlBuHGMS82QkLqC%0AGPWdmJkLSFBTTP7XQ7v1iTwnnMJ47TVb2nvcvqdPDuo/LSq9XGwKInNliAXZ%0AtEIAACAASURBVJtlw+Vp2b3s+agDMmIpyvH5QQxoMQ84goV3uGMLEABzuc/v%0Auc0hLPyVLv5KF78PuM3vA27zK3r4O+6ygnss4D6z8E9ge1L4oCWhdCbPsz3x%0ALWXT8qX9RjkNSGfv5HT+4tUxPtkPP1/+Opusyefmw2ontqeO8ckX09n0fBmb%0AAG9HN2mxnDhG25xlDh3aZ2iban9Cdx09pDydO7ciLCc+pvHZt2xlOI5Eajuw%0AhgvLdtqXoTE6Cpi9dif2L9XNIOGVt0i03Y9lLFm7zOOynTimzJLcj5LypfOn%0AS2FBmctnYQx8MbPewsmmCArfiCMTwNxBTRMkqYtdO76Vp3PnVkTLvg5qtsRS%0AvF0dSeDQKV5X3gwlcfZlOIxAcklzJbwRR6bDl+rcd7rbRzkNWLbLOdpSZinO%0AI69GwjQe8it6WMx9j7dZ0Kesu2CAdU4HKFXapb5xmAmgmXFcI4AuAqRFMkT+%0An09iyptsSu147L6lLYToL4o+fsFdihjZIDQQCSTeGbN9EkKIx8dEYDW9/C13%0ACcO/z6VDaZF8QSCnn9Dq8sk8aw88DHrIuB6ly8Y8y0zHgg4mfDeB6KroJ/b9%0Ax5Xc65G913E85PfcJs6hz8GnAsDXccc1kPw4YBxL+kK1N3iMBYaHh/+DX4/A%0AfJYTVy97/gN0o+TaK9fQfa2je3o35plmDJUG+sb10fajtif2/YltE/19W0aE%0A3OuRvdddBPDvjOd7PCRhpALFEFwmkKsBgXxBIP+Hp/g3nmInE9jPU6xnEv/E%0ARNt/v2OCvw/Xb/zfJzFGdc7tpHOuMqTxmc+fYXzn+Cf+/fjdAwzpeYSNhWs7%0A1t4fqXu9mAf8ih6mjfCIpMsE0hUQwLW+AK4zji4CuKQO5nxS00ZDJUFCCDHq%0AXL8X4Q0JAKNLgoQQwi9cv2Ht6DKB/BvjJQCMARIkhBB+Zf2tpmXcs713lwCy%0ACKVNfv3V7x7vYStCiDGvmXGsYxIvEsI5tbUwkT7e4Y6fj0yABAkhxBhxjkBe%0AJJh1BNPMOHK5z2L5yQ2/k3STEGLMsX757kfc56cEy8+F+5EECSHEmBVFHxPp%0Ao1mSHn4jwwWEEGOW0nEtndf+JOFZCCGEJgkSQgghNEmQEEIIoUmChBBCCE0S%0AJIQQQmiSICGEEEKTBAkhhBCaJEgIIYTQJEFCCCGEJgkSQgghNEmQEEIIoUmC%0AhBBCCE0SJIQQQmiSICGEEEKTBAkhhBCaAsPDw//BN0Ut5ufLi/nx1MlcuXoZ%0Ai28KHQMmULQ9luzJFv5y8XGcnymQvC1TWBDYxVfGkd6Xci2X/acwsv/TBIKN%0At2n4boR2lRxCydvB9P6fu7Q4vJ1eEkfx8uHuezSv2Ujy7H4YVkbyi1eeosvl%0AWoonw+PfktCtYM3yN0nz93GMVTmhZNLB4aPebBNO6ZYQDF7vrJc9G5op23CT%0Aka5b03MjoLabuhHez5jwCNwP8ejy4cx0x/hk/zHfFTfGmFofzwnZ01N0GE82%0AP2ZPiBNIjTdzsrz/Pasrb34yAoevme8/Zp8R4SmfBImYmW+zOiVUedF8mHdP%0AH3Na9hJXMaWkkUATlV9AwfPx9vWmvMmmqVeo6FxgK8N0aTc7v25US1jMz5cv%0AJcFaoPk8FdWf0QpAIrm5rzP5YimXppZREAfQzdnqbVSbnbcrWF5GAY7LPT07%0A5WnLvUDytsSSqbMdHAc3dNoqofSSOArjrct6qPmonap6lCe/lPvURESQqeuh%0A5tAdkvIj0Js72LXVAisjWc4dTBkRJGDm4CEozNdB003KynsHLptA8rZEwL4u%0AIt+IVs/f+bhskkNYGG/mZLnL+znhlObbTgpT7Q3K9z1QUjhvRKBX3y/eHuF0%0A3i0rIylOvsOurRZbhWJw854Ww8pIiiO7bOeo7G88J23HPvD1tpcTRkJTF3tc%0AztV+7K7beXLNJlC0Pdr+OQTnp2+na+ZwP9T9Yr2GWO+dxj1xZ4j3oy4nnNJ8%0AnPfj7r1BtOxrp8zDdcXjxydBovXrbbz7tRoswvsv16dM42r1bm794HUKUs9T%0AUd3BS7nTSeMY5wHilrKaw7y7/5iSHsp9mdzmbVSbE8nNXYr+0m7e/boRa1BY%0AvaDNKRAlPF+mrHO6kbQFZRSkLKb6tNqy0a1gTW4Ep/b/VtmXz6gVVsdNyrb2%0A9ltqWBlJYUQHuzYolaNhZSTFb4TTYv3jjI8g8lAzB1PiKMy/x8ENN0ndHkZ6%0AsoU6QJ8xiYaPbtC+MpbChR3s+qiD5W9MIp1eWgYrmyAy34Caj5rZU68c58KV%0A3dTtc36yVlIyN1wqiwkU5T9FzUfNatBxUG+hfINFqWgW3u9f8Z+9gyljEunJ%0AFlvASk8OwlTf4ZOnUMPKCM3r7Xj8SzOg5iOXdazHrgae/ga6ZoHkbYlGX3uD%0AMtvrWCKtmyaHUOJ4zXLCKbXej3oL5YfGU5ofQd7Zdqriwr0LEMO5H0fvYMyP%0AJjWnkzo1nZieojxsSGtKeGp0+iSaT9ue3I0Xra0AB+bzVFgrffNZrppDmRwG%0ATFnKPF0Tp2ytikaq/3weU9x05z6G5sO2lsf5a00QHkXMiJ2MKieUTJ2Zg+Xu%0AKqwJLM0IwnjS/kfbsq+DGrOO1Bz1DbO9H8DkLnfe1GWrFBzL8ahswHjI2rJ4%0AQF19D/rIwH7HmBrfQ8NZd2m0IJLmua7vgXoLJ5sctk0OIkln5uQ+H6bq4ieR%0APtDynEkkmO9Q51qhekDzmqn9Nvs1zsMwbxLUdtgr8aPdzvfjaCe7aiEzN4S8%0AhTqMhzx/ilcM8X7Qy+HaHhJSJqivlXteUz1QkBXCmQ/7JHxLH5YIXYB58KdQ%0A4zWHvpDrv+Xd6yN5ZApDzFNgvjPAsfXQrpWlGrbhl21LyfSrTHvZ81EHJW/E%0AUpoBmqkqDXWXzBQuDMKABdTK01dPrS372jkYGUfhdh2FOKRdbAKVSniU+1gM%0AkUHo463Xy84xHdWyr4Maa8vTm0ECw7wfLWfvYFJboHU5kzTuuRDaxmyQMHWp%0ArQddBAawtz7C7DlYf2ppvQfJA60RRGQcYPuDDCRSN8DqXhlu2UoayHiy3f1i%0AaxoDNZW1PRw8rZiO3sGYH0Z6cg8kQ4MvWxE4djwrwzdLcAgU1paLV5Wwb/QP%0AWM7SS2JJqr9JTXI0JSsHXref4dyP+h4azLGk5nRCig7jpU7P9ysEY3AIbMzM%0Al5mna+LSdeD6FYzEkzUzUV2aSG5qPKZLhz3vXzC3YSKelCk+PtCjdzDqIli+%0A0l0aoJeLTZCw0D4s0bAyjASzl0NN3fJB2V4Me21pvdf/zeb7mHSTSHcbJHs5%0AXAuZKyNI6ujqn0cfTMRT6nlNoOiNgR4IHtDuMvhgxIa9upxveolj57nSetJn%0ARJCn9dCQo/RDnNzXS9W+DnC3bk44pdvjKC2Z4LYIK+/vxwOqTppJWBjJwghf%0AfP7Ek8YHLQmlM3me7Y9mKZuWL+03ymlAujRWL7f2MjRRaetkPsYn++Hny19n%0AU4q6uPmw2ontqWN88sV0Nj1fxibA+9FNWnrZs+EmRdsd0wz2VEBdeTOUxLmM%0AOBl8hI8nhlt2eooOU/0N9+u7jKSxjtRxqnjrLeyvnUTxG3Fk2vZvf7JtOauM%0AzDK5tlRcyk54I45Mh5FA1pSMcl491BzqQJ9v/Yi6jmxCGe1leyJX+1iqNfoN%0AVkZSnBFke62krDxM3bicr6n2BgeJJdW6/GgnZYRTarseDtdEPWfjIbUFVG/h%0AZFMEhW9Egm1E2gB8cD+U1p0Ofa1L6naQ+yEEQEB8fLx/v0Y85U02pXY4DGsV%0AI6rfsNJHdB8u+g2fFQ4mULQ9jHap/MUQjNk+CTFC6i2UbxjJHQSSt9Ld0NqR%0AJWP5taWXRJPQdFM6rMWQSJAQPuKQDnJKA4nheBj0kHE9SteheZaZjgUdTPhu%0AAtFV0YO+/3/9P3EsjwLuGfnt1nFYuyA9KcfwR+9/5EM8nvyfbhJCaGp6vYm4%0AT+KwJFowzzQTfTgaS6KFzrmdI/p++Dk334oVTyQJEkKMYZ1zO+mcqwxbfebz%0AZxjfOX5U3hfCSoKEEEIITWPuexJCCCHGDgkSQgghNEmQEEIIoUmChBBCCE0S%0AJIQQQmiSICGEEEKTBAkhhBCaJEgIIYTQJEFCCCGEJgkSQgghNEmQEEIIoUmC%0AhBBCCE0SJIQQQmiSICGEEEKTBAkhhBCaJEgIIYTQJEFCCCGEJgkSQgghNEmQ%0AEEIIoUmChBBiVIXR5+9DEF6QICGEGBVzecD73OEuAf4+FOGF8f4+ACHE4y2O%0Ah2zkLrncJ58Q7vr7gIRXfNuSmLWeJWt3qv9tIyHap6UPQR6zPTieqGVDON5Z%0A61mydj1RPjnOMSSmiz9mW8j2aOUifv2HCjZqrjyDhFd2MnuWz47uEZRIbm4Z%0AP5/io+J0K1iz/E3SPF0/eyMVFRvJ8tHuvRFGHxu5yxEsLOMemwniqiQvHjk+%0AvGN5zM5JpO3oGo7sWMORHW9jvOmbkqOW7WT+ohlD2LKKCzvWcGTHAdp8cyij%0A6AFbspv4TYzGYq8q85GQxcaKQqLP7ua94347iFH0iAa84+9x9NZcSrYXjepu%0Ai7jHESys4S4T6eMc47lGAHN5MKrHIYbPd+mm6FiCaaTxss9KHDVtB9ZwxN8H%0A8YjJ2vg66Zyj/L1T/j4UMYg9Gz5kSsU6fv3qHv7+dyO7r8U84Ff0MM0lGMzl%0APr/nvtN75xjP3QC41hfAdcbRRQCX1OfWc4yXtNQY4bsgETmZEM2Fecxeu8ye%0Amrl2gCMHquyLZ61nSU6i7aXlqw/48sQ3hCzaxvw5YcqbU99iyRz32zutB7Qd%0AXcMFT4JV9GvMX/GcetyNXNjxfv8Wh8axubIeg9by/h6wJfs686wXzTKZ3xwP%0A4Tjw2twmfmJQ389o4o/WVeqnsOpGD3uzb9mu9S/zb/FLAPT866EwPh6kbKvs%0ApHZ+mXzb9rqxNp5fttqXT3NYbqmfwqqGQIetiyicB3Xl79E/RLjca3C6poPf%0AK5ftzWf48l8+xsIMEl55C12Nff2QRduYH3GMIwe+JeGV1+DbdhLnJMK1A1xg%0AGbOnOpfvvG/H+z1D2b7qGLoV1n3bl0ct28nsqepmOTtZkqNeVo/vNcBifr58%0AKQkANFG5/7ecty7SrWBNbhp66+vmw7x7+ph90ylvsun5eIeympzK5ItSPrnO%0AAO+d4r3jP+bT7I1k/c7dPRu+aTzkV/Sw2CUQDGQu96EPFgywzlUCaQsIoLMP%0Avkb5DH6h/v9VAmmTTvARN+wg4fpHP3vtTuUfDhV51LJUWnas4QJgrQRmz6pS%0A/3jzmJ0TSeNna/qlpywn3ubICeWPNLFjoMq5nQs73vY+pXTzY77c8bEaLCb3%0AXz5rPUs0jm24x5CdZIGz8bxoAWul/l+TgjjeEMjH5+L5WH0v4hvnyhtCWHUo%0AREk3zQjsV/kPVrayvJ1fJk/gXw9FqkHF9YRu8RNdDC8eilT2k2HhtYYw+7qv%0AppJgvkJ5vzTTDBJeWUbwVx9w5MQ36uu30FkXz1rvfJ1mrWdJzjYS2q2pSeWz%0AYd/eG2EkPvsNX352i9QVy0j86gO+7HiN+Ul5cLmq375DFm1j/iuvqQFI3X7F%0AYho/W8OFm8pxJy6aQduJb9SWZv8g5Y2E5xdwtrqUT8yQtqCMggWLOX/6GLCY%0An+emYfqilJ3XwVrJr5nZxM6vG5UA8vzTnK0updqMGlAi1FKPcal5KQVTF8N1%0ANahMmU4CTVRedzmA313EWJDDwmw45cP0YBR9/IK7FNHru0IdTOMB09QRs7lq%0AAPqFyzptjONqgNICOd2nfMYvE0indZn0gwzLsIOEtSJX/uBx+zTeduB9h1dV%0AtFxbRuLkGYC1IggjZsYMjDe9rRjySJwTRtvRIQSIQc0gITMRy1cfDBogZs9p%0Ad98KGcDxhjCHyj2Qf/+PYObp7gOB2hv5pOy7vJh8m8ZajQABSsvj3ETl360T%0AacRMXAiotSlZhii4dbH/E+msH5PIGY2na/v1tF2ny+9zIWknieq9D1m0mCiz%0A1vaDa6v5GAuvAY00nvgGFtmXRSUp/WXWfVtOHKNtzmKiosGi3t+2o9Zg9Q1t%0A33aRGPEs9s/o8Bi/2KZU8sD5a00UPD+dNI7RMnMBCebzVNgq9WN88sV0NqXO%0AI+brRgwpaXBpt21bV+cvnScrVynrPJA2NR7Tpd32VorNt5jMheifhX5PFUMw%0AEVhNL3/LXb9/7yGKh0T1PQRggUZL5i4BnAtQ/rYu9Y3DTABfEMhpGeA5qNG5%0AQi4pGwBLh/VfVVz4LJb5K6zpJI20jzvRsQTTRWu7T49W9Sw6Hdy+NVAlkUji%0AHODaMe+DVIjFKW0EQItOa23flR1ynxiC+f+6h178s5O1E4uDGeh6BkeEgemG%0ANRb50AxC9BDlkCpSdKFR946srg5MRNhfd7bRqr32wMxnuWp+nZQpcP76YlLi%0Amjh1utHNiqe4fmsd0w1ZMMyEUxwP+T23iePhsMoZUAD4MvZMpI8FfUoAsaa3%0AfhwwjiV9ob7byWNq5INE9GvMV0c9WZvpUct24hQyrGkf1DTA2vWeBYqbN7jN%0AUEY9eeJbzGYYuNpu5MKOixjWLmP+om+9eAK+y2+yb0H9FF50TAH5JEYMUrZl%0A/NArJNW3tyzgJjvniWCnFqRSeaM+MNzu6MKx7vQ1j/uqRlpYBHpzBy3W1+FR%0AxIDtvsSEPY3togyqkbqmblZPXQxMJ6H5Cp+4XS+LKZPh5qXh90g0M45XCPa6%0AD8IrQwwQpwOUKs3aWmhjHA0EKC0J11a6fPHbI6OUrOvCbH3an7Xe3gnohuVW%0A/2bB7Y4uQp79gZuO8SparoWRmPfaAJ3mQ6WkHKJyBvsuRBUXPjsDc95yMzwy%0Ai40V+/hU47sErWb1Qxti4b86dCIrAmk2Q+IzGmM8ugOxhNzhBY0T1y57Ihda%0AbjNv3tCHz55qaYPJU/qPvW+/hUU3gyj1+yZRy94i0Rb4lOsZMufH9us568ck%0A6tTUEGD55hssU5cNOMxUCTKofQxh2is68fReDlyGxQRRSXmaaxRt38enf9jH%0Ar18dqJxEclPjMTWdpRVobb6KSZfGD23fo1jMD1NCMV78jFagpbMbffw8YtRl%0AP3fs4Fa1fn0aY9wC1qQ+zdlLx3DvWfQ6C6ZvPTnXwV1lHK8SzKuEcNUHKdLB%0AdBHA6YDxnA4Yzz8xkX9iIusI5qcEs4RQvkcY3yOMn/YF89O+YP6RIP4HE9nD%0AU5xmfP8AITw28i2Jmx/TeG0ns1eorQfzGRqvJWIb/t8vFdVF42fOfQyWEx/T%0A+OxbzF/7nPKGQ6d424E1XFi2074MhydGl7KjVuwkUS3feFOr092e7rKceJsv%0A2cZ8a2c8GiNabn7Ml0cnsyRnJ0uSXEZuuTWRP9YH80vbyCU9Z+uDmefSkvj4%0AXAyz81v5Y766b8dRRpYQ/rn+Dr/MtpehjG4avOyPz8XD3CaHkVH9RzcN6HcX%0AMRYUUvgqnHIcUnnzYy5+tY356r22fPUBF3gL60Ct/tfT5V7f/JgvP4P5KxzS%0AQrbRTd9grDpDjDUtaT7Dha8ime1hy8PdvbSX7Zm2AwdoW7uMJWuXKWV6Mbop%0A4fkyNqn/Nl3arXRKA5g/Y2c1rMl1Wa72UbR+/QfOxr/O6uVpQDdnqw9D7nSX%0A0tUO7PDz1GnlzzQHGwzPMQI5RghF3OMX3CVqCCmoZsbRHDDOaQTTOcbTQ5/z%0ACCZ58veLgPj4eLn0wmtZGysomX6F8tUjM6RSeCdtQRlZnQ7Bx0kWGyvWoT++%0AckS/JxFGH39LL6vpZaJLjX6ZQP6N8dwlgFr5LsQjRcaGiSE59d5u6pjL6xv9%0A8YMPwsmUNymIa+KU2wABRdvXkX7r4Ih/ka6LAN5jIksI4QBPOS2bxkP2MIGd%0ATOA04zktAeKRERgeHv4PwyngYdBDAu4rzUHzLDOtP27lzvfuEGwMfmLffzJc%0A49SBIJ5/6/8ms/UAp/7q7+N5Ak15k025/5lFUwM5W/0Bp9x9VSF7I28938I/%0Ar/ufXBulw+oigEM8xb8znhn0EctDxgPf4yH/yyV4iLFv2OmmptebiPskDkui%0ABfNMM9GHo7EkWuic2/nEvq+77KOhrEI8BpZxn430EMdDXiWEY9KJ/EgZdpDo%0AnNtJ59xOAJ75/BnGd45/4t+P3+34EwpCCOuX737EfX5KsKSaHiHScS2EGDVR%0A9DGRPpqlO/SRId9JF0KMGmU465PUd/fok3AuhBBCkwQJIYQQmiRICCGE0CRB%0AQgghhCYJEkIIITRJkBBCCKFJgoQQQghNEiSEEEJokiAhhBBCkwQJIYQQmiRI%0ACCGE0CRBQgghhCYJEkIIITRJkBBCCKFJgoQQQghNEiSEEEJokiAhhBBCkwQJ%0AIYQQmiRICCGE0CRBQgghhCYJEkIIITQFhoeH/4OvC01ftZnlU+r5S0O3w7sG%0A8tb9hNC/XKDF1zvUPhKKtqxm2QvZZL8wh+D6MzgdksPxFr+ovXw0uL1msbmU%0A/N1KfjTVzPELvrpq6RRteYlnNM/Vs2sm3IjNpeQnOv4y2L3KWEXp8me48per%0AyKUVY53vWxKxuSxMNHKyyvqHYiBv3VryYlto+c7xtc/37EYde7a+Q9nWSowj%0AUXxsLiVbVpE+EmX7zQhfs8dRbC4l63Ix3GjF5Pja7coG8rISMJ6qHsWHJSGG%0AbryvCzSkJcGZz6mzvdNC1Yefk7duM4V6YMtqjJXvsOeGr/c8dHV733E43jHk%0ARjXlW6v9fRRiMDeqKd+fS8mWAvRAaaKRg1v3ug8CsWkkUcP+2lE+RiGGyMdB%0AIp2lz0HDroGekUy0exUgDOStW02mXn3ZWEnZXscqPZ2iLQUk2IqvYdeHHj6l%0AxeZSUpyJUrTyh20v2UDeupdg/ykii63lW9dx3mfhls0UqudWs2sHVR6dn8t5%0AAaZbDme1ajOFier7Zyoor3I+I0PeWoqfs29srHyHPbaKx6Vsd9fE8dy9uWb9%0A9u163QaQsYrSmZfYdSvLtr3ruTmet3fXM52iLSlc3NXOQo3z0jru9FWbWXjL%0A9Ror1zDylON19ZCpXfNapi/JhPoKaUWIR4ZPg4QhL4uExlMurQRrZfsOB5es%0Agr1/wrBuLXn7PfvjT1+1mszvKin7sA7rH25JXovtDzp9VQH6MxWUVQ3hz876%0ApB6bS0lxpJsV9GQWZ1Gz6x323FD2vTDPQF1VHXu21tm2O+lpJal5XmpF5bDc%0A2rpxfR+A2FyWP2fi4NYdbvdryPsh7H+HshtgvWbL8847VIJ6MgsiObj1Herc%0ALh9AxiqKHfZtyFtL8bpcWjwNMokFFFNJ2dY6JWgU/JD0qr22sgqfrmHXVqUs%0AQ95aiotX0eLx9U2gsBj1vJRAvjSjWqnkBzruWyb0kw0w1Ko7NpeS5bB/ayVL%0AV8GeIzGUrMtlv5vAvDDRyMm9EiLEo8OHfRIG0pP1GL92/XNuoerDHVTdMGB4%0A2vG1J2Wmk5po5KCt5dBC1Skj+uQ0p3yv62tfMlZaj7WFunprZTJMamVxcO9w%0AklwJpGa4X9JStdfh+ro7bhM1u6wVr7rcw2uYPjMBY6W90m6pOoVRn0S6p31M%0Aphp2Wc+79hJG9BhiQWmF6p1y9S1Vn1Nj0j5PN4U7nFcdFxtBH20Y9Lhbbprs%0A57dqMyV5BsBApN7DVu+Naso/rKYlNkZpwVhfu6xmSEtC33hpbKY2hdDgu5ZE%0Axg/JpIZdmk3zFqo+3OtdmbEx6ElwSOeoTO22f9btrcCwbjXFWzIB17SLP/VP%0AJ/ns2G5UU14ZSWnBZkoL6J8uckqjqRq1i2u5aYJkT3asBPoE635tTLRrbeKV%0AQSrlfuflaaprkOO+0Y4pKwYD6aRixGQLqCZavEmN3qimXPMjrqRia3ZJiBCP%0AFp8FifSZCZjq/zQCudbBKoIWqj58hypQK5HNFDEWAoXDcY2E2r2UqeeYvmoz%0AxetQA0U6RcWZ4JCCM+StpXiydlGGaD18d8njezdygVhPZCxgq5gNRDpGumF2%0A5GsfdysmfQqGjEj0t/7Eyck/JD22Hf0AfQtey0ghwdTA4TE0YEMIT/gm3dRv%0A2KuP3DhPgymBwlUeDjK1DkEcLTdaMQ2Q9vF0O0PeWofOWu+13Op/1qab6r2I%0AzWX5c/p+y+3UNE+/NKHbPVFXbyKhYCSG/SrpoYQs+9BRQ14WCaYaDg87IHl2%0A3IZoaDjfQsstPalLItF/1+qjICHDXsWjyyctCSXXemoEcq0tVH1YAetWU7rF%0Aniewj4hxGdlkXWatVDJWUVpgX5pQvJlMhxEzriOElLSWF6N1qGNPZYo97ePx%0AaByX7Ror2XUmi+W25S7nlbia0ufs5+163Epry1oB1XH4TBbFtmMyUnPGRKZT%0AS0JPZvFmMq1bOz5hD3LNWqp2sIu1FDumAL0cHaV5Vfa+A6s221KHzuc1PAMf%0AdwvtpgIyk2vYVQUtNKAvzsR05k8+2DPKsFe9kZN+b90K4b2A+Pj4vuEVkU7R%0AlizaPR6qKMSTxf0QWyEeDT4IEkIIIR5X8gN/QgghNEmQEEIIoUmChBBCCE0S%0AJIQQQmiSICGEEEKTBAkhhBCaJEgIIYTQJEHCQ1kbK/h0e5HbZUXb9/HpH/Zp%0ALhdCiEeVz2emGz13+S9NrRATz/870fH9B+S3XydS5/r+MLy6jZJ5bVS+vMft%0AsoIEI5Uvv42bpUII8Uh7hFsSE7kYDgk9d53fftBD0m09F30VICji1wUJGCvd%0AB4EsQxQYL0qAEEI8lnzQkghlWvZcqL1CeHYGMQC0Uvu/a2m1rRNDxt9Yl0H3%0AlROcaOiG0Gksyg7nitO6gCGD/OmdnDh+le4B9nwuSE9h613mhk/knHXTu3fQ%0Ah+uU13e72GIO5KPIEPVH4u7yX5rMtE+J5FCguv7tdt5ov61uredgfJitLICs%0AjTkkGA/ys98N5doIIcSjzUfpplCmZ0/nyvFD1HaHMi17EdOTQmlt6EYJIhmE%0AXDnBoYZulICxiIzupm4pFQAADXpJREFUQ9S2dGPhGUJDoXWgaKBl4kSMtJJ6%0AN4xzEwEeMPf2bYw6d1ORunG3izfaJ3AwPpJzWAOGhRu2oJLFwukhGI9LO0EI%0A8WTyWbqptfYEV7sBumn9j25CdSHKgtAYnuEK5xqsUaCVK1e6iYmNASx0Wt8O%0AncYitbURGhoC5u4BWxEKl5STl6mmuT0mjDH2lkNLsA7j7TvMfWBd41n0Ogum%0Ab7XLeHZyCLdvDbCCEEI8wka+4zo0nNDQGBb9zXTn928AdNNtDmVKKISGhmO5%0AAaGhYAG6zRaPindMOd1wTDUN6gGGe5DQ2cQWp/eD7VNxZk8hGtxOZJS1sYKS%0AeSEYK1eyWlJRQojH1OiMbuq+otm/YDF3ExIaQ8wzcL22kymGULp1oVhueJh/%0AsqWcQjB4k2pSGfuNjnJw/Do3S6a7XXTqvdWcQhn+WrHxQ1a/d8qr/QohxKNg%0A5Ec3tVynNXQ6c5NCB1gplHDzdVq7u+GZ6UzRddvTUINSU07mDvepptsPiAWU%0AobGtDrPYBXIuOJiE1i7mapb9LSZzCPpntff+7S0LwZMHWEEIIR5hozAEVhnp%0AZJm+iPy/ybf9l6FOZNzdbSF0+nS40Qq0ct0cQ0yohW4vOrLPBenh9m30DqOc%0AAJgYxsFwE4VNTWxpuk6kLgajw+KW4Eg+iuxVl6v/tVtscyzDKU5esZCQvZGs%0AYVwBIYR4VMnMdIMq4td/KITKlfy9m76HrI0VlEw+ys82yAgoIcTj5xH+Mt1o%0A2cPfVxpJKNiGux/dONXSBpOnSEtDCPFYkiDhid+9TfnZKArc/TbT796m8tZc%0ASuS3m4QQjyFJNwkhhNAkLQkhhBCahh0kMjJifXEcQgghxiBpSQghhNAkQUII%0AIYQmCRJCCCE0jfmZ6aw/pAeA8eCIfGnNsDKS4ox7HNzQSZ3PSx+OCRRtj0Zf%0Ae4PyfQ8GX10IIXxszLckTr23mp+9vJLys579KqxvBZK3JZK8ZCA5hJLt4aT7%0A4SiEEMJfxnyQGDXm++pEQ67u0VI/2Dojy9QqrQghhH+MjXTTq9v4tMD6+6wW%0A6spX895xL7bP3khFyVw4O7Sf7G7Z106Zy3tKCipIebFdR6H6fvH2CIyHmtlz%0AFMgJpzRfZ9vG9r66/XI6OBkZS2G86/JA8rZEwL4uIt+IVn+Z1uwm3dXLng3N%0AXp+PEEL4iv9bEtkbqSiIoq58JT97eSU/q2wjvcT97ySNppZ97ZR91IHJ3MGu%0ADc3squ2BppuUbbBW9BMoSrlD2YZm5b9DZhLyndNR+oxYFrbf0FgeROYbYbR/%0ApGx/sElHYcmE0T5NIYQYkN+DRNbz0+HsbnvL4Xf/izpzAimvelHI8fdY/fLK%0AEZ34xxAZhKndMe3Ty57yXvvLo3cw8hSGZIdVmm7aO5zdLDceaqdKTWXVXTJD%0AxFMOP1MuhBD+5/d007OTQwhOWMenf1jn9L5RY/3REUjellgy1UxS8fYI5R/x%0AsZQmd7Brq4UWIL0kzpZKUvTYpz51K4jIOKBeY7FuPAbwS7+HEEK44/cgAXB7%0AiH0JI+cBVVubqVsZSXFkF2XlD8jbEkvkSec+h8J4x36ECRRtDxuk3B7aB+pi%0A8FPHuBBCaPF7umnPJSPB815nY/YwCsneSMUf9lGx0fezOthTTG4qeIdKPb0k%0A2mFq1P7SS6JJMN+hzm0rYgJF+TpM9T1eBIksNlbs49M/VAzv2gkhxAD835L4%0A3dv8jG18WrKPT0usbxqpfPlt9pDFxop1pNsGEBXy6R8KR+xLda4MkUEo+aNA%0AInU4pZJa9nVh3B5tS0WZajswxk9yLiA+mtLt6r/N9jSVVUJ+HKX5qNt7+4W5%0AU5y88jrp89Q5uL0ZDSaEEB4a9nwSGRmx1Nbe8NXxPDYMtlRVr5ulgf3SV0Py%0A6jY+LYjyfsiwEEJ4yP8tCTEEyrzbCUP5TokQQnhBgsQjaQ9///LIp9uEEELS%0ATUIIITT5fXSTEEKIsUuChBBCCE0SJIQQQmiSICGEEEKTBAkhhBCanqwgEWJh%0Ab34Xr/n7OJhBwis7mT3L38fhRkwXf8y24NEvfby6jU8rNuL7H0PRkL2RitHc%0AnxDiCQsSwnes84D87j36/TTjrPUsWbuTJcvyfLvP4+9x9NZcSrb7e7YRIZ4c%0AEiQeR1PeZNOCxSO4gyw2vjrXeR4QB1FJibQdPUDb1FSifLznPRs+pG5yIb/2%0AZr4RIcSQ+f8b1yEW9mY/4PChiczObyURwDKZ3xwPUX+z7gFbsq8zL0RdvyWG%0AF89NVF/c5Tf5d7lwPJCl2bcI6bctSvokw+SwQ73T7rOT2vll8m3bsn89FMbH%0A6qvX5jax1DyFf6bDtk5jbTy/bLVvn7WxgpJ5DPHnMfKYvXaZWpE2cmHH+7R5%0AW4Q71w9zNvV1NuVGUVH9Ga2Db9HPNIfrYqmfwqqGQPvCV39MOucod/vz7nkY%0ApnZhPl2F5doyDLOg7bK6aNZ6liRd5MuOxcyfo/ysuuWrD/jyxDcAhCzaRiof%0A0xjxFrOnKpu0HV3DhcuO5Z/iveM/5tPsjWS5a8UIIXxqjLQkTPwk30zH8Xhe%0APBRDY8gtXoxRlrw29zrzzDG8eCieFw9N4ayulb1JD5y3zX7A4UP9tyXEwt6M%0AXs4ej1e2Pz4Zi+NuY7r4ZfIE/vWQsvw39b38xCUfH5J8nV/qdOryYBJneJiv%0A90BUzmLMn63hyI4PaDQnkrhoho9KbqS6upTKzjRWL3+TNG83D7nFT9RzfrFW%0AT0iyxakfpyglgdtXTrqvoGelEmX+hrabcLuji6gkl5TT1GXMjzjGkR1rOPLZ%0AGZjzGgnRDrue8xaJHR8oy482EpWzvn9r5HcXMeqms1B+Il2IEef/loSqsTaS%0ArRaAiVxogaW6B9B6n9kGPf96yNpyCGTrN3r+OKOH7AZrayGYs8etT/+O2wby%0A2vRbUD9FLbe/154x0Vgbb2s5HG/Q8WKymRdCQjhu3cYymd+oLZfjNyb9/+3d%0AX0hbZxzG8Wf0osVMp2haqa6o61pmhf5x0oLMVa8mbgpjLY4J0ga2i65sSKkO%0AuquVYXaxm8nuSmkpWEoviptMYWwuLMXiisiqzLIZsVhmsqB4FlkvynaRaGLM%0Am1ZzluWM7+cqnPfEkyCcJ+/7ezk/vffiY72g+JO5/V7Pln/Nhr7v0WxQkqYV%0ACiyrqqhS0vQT33fw2EW1lCcf/VN3h3s1bMWPTIxe0O8v9cjzVo9Kk8bSSvjO%0AWtiuGVkqd0nRhK1XWbEUnEz9rd17qxQJfBU9dXpakRM1cmsoPkOyxnRnYCj6%0AOnhbC1ad8kskBWPjDwbWZhaauqdQ43G5dkqhYOJVAlqyXucR6UAW5EhIFOrn%0AhDWRy+OxG7frL+3Skqqal9SWeHqk2IZrPlZ5vlR1ZE631h3P093ESz3cEb8P%0ARVx65xsbLp2hidELmtjUO55V7YHjGh4dseHqlSrMN41Fl5oWRmM3+eBtLVgf%0ArF9ySiGveL/M4ViwPkQkSX7Nh89qX2m9xIIT8K/KkZBIZ32dwG7JNQYneNqZ%0ARPS8OQ3e7N1kqKQT0JKVXNmJqa6RWwVyn/gyWltatfc1aWrI+BdXwulmT8uy%0ANjQOTz+bAWCf3A6JyA79EplX2+HturxWrH56v1l5atu9ujT1SJ83hOVau71t%0A0w8P89R1ZFmnMgihzArXW/M0M4mDxy6q5bkJXbq5tcK1mflXvKu4RHowoO8G%0AEgKh+pyaGpOWnFbPf+WUqvJnkgrTce7WVrmtMc0Ek0cqVZgf0VIgw68C4Ily%0AOyS0TZ/4yvRxw7xuNcePbthtY+D7tUiv7p5XV3NYXcrTXd8uzTQ8ShgvkfSH%0Auprn4stZybujnKjsXbXoW306bMfy0kbXJmfV0vKGOuRXvKvFfrkrCxT6KWnG%0AMHVPocbYLidJyq/T0TN1scEUO7qeb1XTmdboa2tMd65e1oaSUmeNKqz76nP0%0APwlwBvpJYAuivcf33f9CnpTbYA2qz6np5XDqG7+iW2CPFo2sn4kYrl3oa9dH%0AVzb7uQFsVo5sgYWz+OW9Mi7VnlZ3lrehdnx2VofCXxMQQJYQEtgan1eewZAO%0AdWb32U2NxePqO0/rViBbWG4CABgxkwAAGGU8kwAA/H8xkwAAGBESAAAjQgIA%0AYGRLSNR3X1L/jevmVpa0nQQAR7IlJPxej94+2a7B8GGd7k4RBbSdBABHsnW5%0A6drkrPKKK1OP0XYSABwnizUJv7y+WVU0sOwEAE6R3cI1bScBwFHsDYnAolYq%0AamSuPAS0ZLmibScBADnP3pDweeXpW1TjjevqT1mk9ms+LO0sZcEJAJzA3qZD%0Anb3qb1hU38l2Q+dh2k4CgJPYX5MIz6dpTU/bSQBwkuwWrmNtJ3+k7SQAOEIW%0AQ6Je3Q0VmvV508w0AAC5xNaQ6DhQoZVw6rUk2k4CgPPYUriu776k92tdkmY1%0AeD7FPGG17aSHtpMA4CQ0HQIAGPGocACAUcbLTVffjObMhyOFGX8YAEBuYSYB%0AADAiJAAARoQEAMCIkAAAGBESAAAjQgIAYERIAACMCAkAgBEhAQAwIiQAAEaE%0ABADAiJAAABgREgAAI0ICAGBESAAAjAgJAIARIQEAMCIkAABGz+zZs+fv//pD%0AAABy0z+zU1TRYZj17QAAAABJRU5ErkJggg" alt=""></p><h2 id="页面入口"><a href="#页面入口" class="headerlink" title="页面入口"></a>页面入口</h2><h3 id="m-header组件"><a href="#m-header组件" class="headerlink" title="m-header组件"></a>m-header组件</h3><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560241111052.png" alt=""></p><h4 id="m-header-vue"><a href="#m-header-vue" class="headerlink" title="m-header.vue"></a>m-header.vue</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;m-header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;icon&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;h1 class=&quot;text&quot;&gt;Dunteng Music&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/ecmascript-6&quot;&gt;</span><br><span class="line">  export default &#123;&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;</span><br><span class="line">  @import &quot;~common/stylus/variable&quot;</span><br><span class="line">  @import &quot;~common/stylus/mixin&quot;</span><br><span class="line"></span><br><span class="line">  .m-header</span><br><span class="line">    position: relative</span><br><span class="line">    height: 44px</span><br><span class="line">    text-align: center</span><br><span class="line">    color: $color-theme</span><br><span class="line">    font-size: 0</span><br><span class="line">    .icon</span><br><span class="line">      display: inline-block</span><br><span class="line">      vertical-align: top</span><br><span class="line">      margin-top: 6px</span><br><span class="line">      width: 30px</span><br><span class="line">      height: 32px</span><br><span class="line">      margin-right: 9px</span><br><span class="line">      bg-image(&apos;logo&apos;)</span><br><span class="line">      background-size: 30px 32px</span><br><span class="line">    .text</span><br><span class="line">      display: inline-block</span><br><span class="line">      vertical-align: top</span><br><span class="line">      line-height: 44px</span><br><span class="line">      font-size: $font-size-large</span><br><span class="line">    .mine</span><br><span class="line">      position: absolute</span><br><span class="line">      top: 0</span><br><span class="line">      right: 0</span><br><span class="line">      .icon-mine</span><br><span class="line">        display: block</span><br><span class="line">        padding: 12px</span><br><span class="line">        font-size: 20px</span><br><span class="line">        color: $color-theme</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h4 id="App-vue-1"><a href="#App-vue-1" class="headerlink" title="App.vue"></a>App.vue</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">      &lt;m-header&gt;&lt;/m-header&gt;</span><br><span class="line">      &lt;!-- &lt;MHeader&gt;&lt;/MHeader&gt;这样写也可以 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/ecmascript-6&quot;&gt;</span><br><span class="line">  import MHeader from &apos;components/m-header/m-header&apos; /*这里webpack.base.config.js配置components别名*/</span><br><span class="line">    </span><br><span class="line">    export default&#123;</span><br><span class="line">        components:&#123;</span><br><span class="line">            MHeader</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h4 id="webpack-base-config-js中添加别名："><a href="#webpack-base-config-js中添加别名：" class="headerlink" title="webpack.base.config.js中添加别名："></a>webpack.base.config.js中添加别名：</h4><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560241171207.png" alt=""></p><h4 id="这部分的效果图"><a href="#这部分的效果图" class="headerlink" title="这部分的效果图"></a>这部分的效果图</h4><p><img src="https://github.com/Dunteng/images/blob/master/BlogImages/illustration/vuemusic/1560241751607.png?raw=true" alt=""></p><p><br><br></p><h2 id="路由配置-顶部tab组件"><a href="#路由配置-顶部tab组件" class="headerlink" title="路由配置+顶部tab组件"></a>路由配置+顶部tab组件</h2><p>效果图：</p><p><img src="https://gitee.com/dunteng/imagebed/raw/4745c333848490b8cf05ce9b4e1c95a52fa1905f/images/2019-06-12_15-50-17.gif" alt=""></p><p>这部分的目录树：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/vuemusic/1560325443000.png" alt=""></p><p>这部分开始建立起了路由。</p><p>以下是router/index.js的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="keyword">import</span> Recommend <span class="keyword">from</span> <span class="string">'components/recommend/recommend'</span></span><br><span class="line"><span class="keyword">import</span> Singer <span class="keyword">from</span> <span class="string">'components/singer/singer'</span></span><br><span class="line"><span class="keyword">import</span> Rank <span class="keyword">from</span> <span class="string">'components/rank/rank'</span></span><br><span class="line"><span class="keyword">import</span> Search <span class="keyword">from</span> <span class="string">'components/search/search'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      redirect: <span class="string">'/recommend'</span> <span class="comment">/* 重定向到推荐页面，默认为首页 */</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/recommend'</span>,</span><br><span class="line">      component: Recommend</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/singer'</span>,</span><br><span class="line">      component: Singer</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/rank'</span>,</span><br><span class="line">      component: Rank</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/search'</span>,</span><br><span class="line">      component: Search</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br></p><p>另外这里我给路由切换加了一个动画效果：</p><p>App.vue代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;m-header&gt;&lt;/m-header&gt;</span><br><span class="line">    &lt;!-- &lt;MHeader&gt;&lt;/MHeader&gt;这样写也可以,但是不推荐，应尽量符合代码规范 --&gt;</span><br><span class="line">    &lt;tab&gt;&lt;/tab&gt;</span><br><span class="line">    &lt;transition&gt;</span><br><span class="line">      &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">    &lt;/transition&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=&quot;text/ecmascript-6&quot;&gt;</span><br><span class="line">import MHeader from &quot;components/m-header/m-header&quot;;</span><br><span class="line">import Tab from &quot;./components/tab/tab&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    MHeader,</span><br><span class="line">    Tab</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;stylus&quot; rel=&quot;stylesheet/stylus&quot;&gt;</span><br><span class="line">// 实现路由切换动画效果</span><br><span class="line">.v-enter &#123;</span><br><span class="line">  opacity: 0;</span><br><span class="line">  transform: translateX(100%);</span><br><span class="line">&#125;</span><br><span class="line">.v-leave-to &#123;</span><br><span class="line">  opacity: 0;</span><br><span class="line">  transform: translateX(-100%);</span><br><span class="line">  position: absolute;</span><br><span class="line">&#125;</span><br><span class="line">.v-enter-active,</span><br><span class="line">.v-leave-active &#123;</span><br><span class="line">  transition: all 0.5s ease;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br><br></p><h1 id="插播一条eslint的配置"><a href="#插播一条eslint的配置" class="headerlink" title="插播一条eslint的配置"></a>插播一条eslint的配置</h1><p>eslint默认缩进是2格，我用4格的他就报错，真的是烦死了。在网上看到有人说现在Google等大公司都提倡缩进2格，优点是可以节省行空间，一行可写的内容更多，但是视觉反馈没那么强烈，即缩进不明显而且复杂度警告能力减弱，多层嵌套的代码往往更难理解。所以我还是习惯使用4格缩进。</p><p>遂改之：<a href="https://segmentfault.com/q/1010000013682009" target="_blank" rel="noopener">https://segmentfault.com/q/1010000013682009</a></p><p><br><br></p><p>(未完待续)</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Vue </tag>
            
            <tag> 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue父子组件传值和非父子组件传值</title>
      <link href="/2019/05/12/Vue%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC%E5%92%8C%E9%9D%9E%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC.html"/>
      <url>/2019/05/12/Vue%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC%E5%92%8C%E9%9D%9E%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/Dunteng/demo/tree/master/Vue/%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC%E5%92%8C%E9%9D%9E%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC" target="_blank" rel="noopener">案例代码</a></p><p>实现如下的一个案例：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/demo/comp46546.GIF" alt=""></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>该页面是一个<strong>父组件Form.vue</strong>，添加学生的这个input框部分是一个<strong>子组件addStudent.vue</strong>，下面的 li 显示学生的这部分是另一个<strong>子组件StudentList.vue</strong>。我们需要把addStudent.vue的数据传给StudentList.vue，但是他们是<strong>非父子组件关系</strong>。</p><p>因此需要先让 addStudent.vue 把数据传给它的父组件 Form.vue<strong>（子组件传值给父组件）</strong>，然后父组件 Form.vue 再将从子组件 addStudent.vue 获得的数据传给另一个子组件 StudentList.vue<strong>（父组件传值给子组件）</strong>。从而间接地实现<strong>非父子组件传值</strong>。</p><p><br></p><h3 id="子组件传值给父组件"><a href="#子组件传值给父组件" class="headerlink" title="子组件传值给父组件"></a>子组件传值给父组件</h3><p>通过子组件的一个事件触发一个方法，在 addStudent.vue 中是 addStu() 方法，<code>this.$emit(&quot;add&quot;, this.name);</code>  子组件向父组件派发一个方法，子组件将自身的数据作为参数向父组件传值，在另一头父组件 Form.vue 中引用的 add-student 标签里需要监听 “add” 事件，触发一个自身定义的方法 addFunc()，在这个方法内部实现获取数据并保存。</p><p><br></p><h3 id="父组件传值给子组件"><a href="#父组件传值给子组件" class="headerlink" title="父组件传值给子组件"></a>父组件传值给子组件</h3><p>父组件中引用的 student-list 标签绑定一个属性，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;student-list :student=&quot;studentList&quot;&gt;&lt;/student-list&gt;</span><br></pre></td></tr></table></figure><p>其中的 studentList 就是这个父组件自身的数据。而另一方面，子组件 StudentList.vue 中，需要有 props属性来接受父组件传来的数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//   props: ["student"]  //简易写法</span></span><br><span class="line">props: &#123;</span><br><span class="line">  student: &#123;</span><br><span class="line">    type: <span class="built_in">Array</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">""</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>之后就拿着 props 中的数据进行数据渲染即可。</p><p><br></p><h2 id="父组件Form-vue"><a href="#父组件Form-vue" class="headerlink" title="父组件Form.vue"></a>父组件Form.vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;form&quot;&gt;</span><br><span class="line">    &lt;h3&gt;我是addStudent组件和StudentList组件的父组件&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">    &lt;add-student @add=&quot;addFunc&quot;&gt;&lt;/add-student&gt;</span><br><span class="line">    &lt;hr /&gt;</span><br><span class="line">    &lt;student-list :student=&quot;studentList&quot;&gt;&lt;/student-list&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import StudentList from &quot;./StudentList&quot;;</span><br><span class="line">import addStudent from &quot;./addStudent&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      studentList: []</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addFunc(param) &#123;</span><br><span class="line">      console.log(param);</span><br><span class="line">      this.studentList.push(param);</span><br><span class="line">      //   console.log(this.studentList);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    StudentList,</span><br><span class="line">    addStudent</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h2 id="子组件addStudent-vue"><a href="#子组件addStudent-vue" class="headerlink" title="子组件addStudent.vue"></a>子组件addStudent.vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;addStudent&quot;&gt;</span><br><span class="line">    添加学生：</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&quot;name&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;addStu&quot;&gt;添加&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &quot;&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addStu() &#123;</span><br><span class="line">      this.$emit(&quot;add&quot;, this.name); //子组件向父组件派发一个方法，子组件向父组件传值</span><br><span class="line">      //注意这个this.$emit的this不能没写</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;   </span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><h2 id="子组件StudentList-vue"><a href="#子组件StudentList-vue" class="headerlink" title="子组件StudentList.vue"></a>子组件StudentList.vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;StudentList&quot;&gt;</span><br><span class="line">    学生列表：</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li v-for=&quot;(item,index) in student&quot; :key=&quot;index+item&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  //   props: [&quot;student&quot;]  //简易写法</span><br><span class="line">  props: &#123;</span><br><span class="line">    student: &#123;</span><br><span class="line">      type: Array,</span><br><span class="line">      default: &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><br></p><p>这种子组件比较少的还好说，如果是很多个子组件公用一个公共数据，这样的非父子组件传值方式就比较麻烦。可以采用Vuex。</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue写个日历组件</title>
      <link href="/2019/05/11/vue%E5%86%99%E4%B8%AA%E6%97%A5%E5%8E%86%E7%BB%84%E4%BB%B6.html"/>
      <url>/2019/05/11/vue%E5%86%99%E4%B8%AA%E6%97%A5%E5%8E%86%E7%BB%84%E4%BB%B6.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/calendar.jpg" alt=""></p><p><br></p><p>样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"><span class="selector-class">.calendar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.date-header</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.prev-month</span>,</span><br><span class="line"><span class="selector-class">.next-month</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">15px</span> solid transparent;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.prev-month</span> &#123;</span><br><span class="line">  <span class="attribute">border-right-color</span>: <span class="number">#007fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.next-month</span> &#123;</span><br><span class="line">  <span class="attribute">border-left-color</span>: <span class="number">#007fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.show-date</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#007fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.week-header</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.week-header</span> &gt; <span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#007fff</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.week-day</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.every-day</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">14.28%</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.other-day</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.now-day</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#007fff</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.active-day</span><span class="selector-pseudo">:not(.now-day)</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#007fff</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#007fff</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">46px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><p>html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"calendar"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"date-header"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"prev-month"</span> @<span class="attr">click</span>=<span class="string">"handlePrev"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"show-date"</span>&gt;</span>&#123;&#123; `$&#123;year&#125;年$&#123;month&#125;月$&#123;day&#125;日` &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"next-month"</span> @<span class="attr">click</span>=<span class="string">"handleNext"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"date-content"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"week-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>日<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>一<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>二<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>三<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>四<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>五<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>六<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"week-day"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"every-day"</span> <span class="attr">v-for</span>=<span class="string">"item in 42"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"item - beginDay &gt; 0 &amp;&amp; item - beginDay &lt;= curDays"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:class</span>=<span class="string">"&#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">                 'now-day': `$&#123;year&#125;-$&#123;month&#125;-$&#123;item - beginDay&#125;` === curDate,</span></span></span><br><span class="line"><span class="tag"><span class="string">                 'active-day': `$&#123;year&#125;-$&#123;month&#125;-$&#123;item - beginDay&#125;` === `$&#123;year&#125;-$&#123;month&#125;-$&#123;day&#125;`</span></span></span><br><span class="line"><span class="tag"><span class="string">               &#125;"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:data-day</span>=<span class="string">"item - beginDay"</span></span></span><br><span class="line"><span class="tag">               @<span class="attr">click</span>=<span class="string">"handleChooseDay"</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            &#123;&#123; item - beginDay &#125;&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">"item - beginDay &lt;= 0"</span> <span class="attr">class</span>=<span class="string">"other-day"</span>&gt;</span>&#123;&#123; prevDays - beginDay + item&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">"other-day"</span>&gt;</span>&#123;&#123; item - beginDay - curDays &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><p>JavaScript部分：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">      year: <span class="literal">null</span>,</span><br><span class="line">      month: <span class="literal">null</span>,</span><br><span class="line">      day: <span class="literal">null</span>,</span><br><span class="line">      curDate: <span class="literal">null</span>,</span><br><span class="line">      activeDay: <span class="literal">null</span></span><br><span class="line">    &#125;,</span><br><span class="line">    created () &#123;</span><br><span class="line">      <span class="keyword">this</span>.getInitTime();</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      getInitTime () &#123;</span><br><span class="line">        <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">        <span class="keyword">this</span>.year = date.getFullYear();</span><br><span class="line">        <span class="keyword">this</span>.month = date.getMonth() + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>.day = date.getDate();</span><br><span class="line">        <span class="keyword">this</span>.curDate = <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.year&#125;</span>-<span class="subst">$&#123;<span class="keyword">this</span>.month&#125;</span>-<span class="subst">$&#123;<span class="keyword">this</span>.day&#125;</span>`</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">      computedDay (month) &#123;</span><br><span class="line">        <span class="keyword">const</span> day = <span class="keyword">this</span>.day;</span><br><span class="line">        <span class="keyword">const</span> year = <span class="keyword">this</span>.year;</span><br><span class="line">        <span class="keyword">const</span> allDay = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, <span class="number">0</span>).getDate();</span><br><span class="line">        <span class="keyword">if</span>(day &gt; allDay) &#123;</span><br><span class="line">          <span class="keyword">this</span>.day = allDay;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      handlePrev () &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.month === <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="keyword">this</span>.month = <span class="number">12</span>;</span><br><span class="line">          <span class="keyword">this</span>.year --;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">this</span>.month --;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.computedDay(<span class="keyword">this</span>.month);</span><br><span class="line">      &#125;,</span><br><span class="line">      handleNext () &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.month === <span class="number">12</span>) &#123;</span><br><span class="line">          <span class="keyword">this</span>.month = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">this</span>.year ++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">this</span>.month ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.computedDay(<span class="keyword">this</span>.month);</span><br><span class="line">      &#125;,</span><br><span class="line">      handleChooseDay (e) &#123;</span><br><span class="line">        <span class="keyword">this</span>.day = e.target.dataset.day;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">      beginDay () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">this</span>.year, <span class="keyword">this</span>.month - <span class="number">1</span>, <span class="number">1</span>).getDay();</span><br><span class="line">      &#125;,</span><br><span class="line">      curDays () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">this</span>.year, <span class="keyword">this</span>.month, <span class="number">0</span>).getDate();</span><br><span class="line">      &#125;,</span><br><span class="line">      prevDays () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="keyword">this</span>.year, <span class="keyword">this</span>.month - <span class="number">1</span>, <span class="number">0</span>).getDate();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> 小案例 </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>啥是前端工程化、模块化、组件化？</title>
      <link href="/2019/05/10/%E5%95%A5%E6%98%AF%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BB%84%E4%BB%B6%E5%8C%96.html"/>
      <url>/2019/05/10/%E5%95%A5%E6%98%AF%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BB%84%E4%BB%B6%E5%8C%96.html</url>
      
        <content type="html"><![CDATA[<h3 id="工程化"><a href="#工程化" class="headerlink" title="工程化"></a>工程化</h3><p><strong>前端工程化</strong>是根据业务特点，将前端开发流程规范化，标准化，它包括了开发流程，技术选型，代码规范，构建发布等，用于提升前端工程师的<strong>开发效率和代码质量</strong>。前端工程化是一种思想，模块化和组件化可以看作是工程化的具体体现。</p><h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><p>模块化最直观的一点就是<strong>封装模块，代码复用</strong>，比如封装轮播图的模块。</p><h3 id="组件化"><a href="#组件化" class="headerlink" title="组件化"></a>组件化</h3><p>组件化可以看作是页面上 UI 的拆分，比如一个导航条、下拉列表、侧边栏等等，都可以看作是组件化。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/1558253536.jpg" alt=""></p><p>模块化和组件化都有一个特点：<strong>高内聚，低耦合</strong>    </p><p>（完）</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>webpack4复习笔记</title>
      <link href="/2019/05/10/webpack%E7%AC%94%E8%AE%B0.html"/>
      <url>/2019/05/10/webpack%E7%AC%94%E8%AE%B0.html</url>
      
        <content type="html"><![CDATA[<p><br><br></p><h2 id="webpack的卸载"><a href="#webpack的卸载" class="headerlink" title="webpack的卸载"></a>webpack的卸载</h2><p>webpack4.x开始官方文档是说要单独安装webpack-cli所以如果是用4.+就需要卸载cli</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//删除全局webpack-cli  卸载uninstall可以简写成un，全局-g的完整写法是--global</span><br><span class="line">npm uninstall -g webpack-cli</span><br><span class="line">//删除本地（局部）webpack-cli</span><br><span class="line">npm uninstall webpack-cli</span><br><span class="line">//删除全局webpack</span><br><span class="line">npm uninstall -g webpack</span><br><span class="line">//删除本地webpack</span><br><span class="line">npm un webpack</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="webpack的安装与使用"><a href="#webpack的安装与使用" class="headerlink" title="webpack的安装与使用"></a>webpack的安装与使用</h2><p>在空文件夹pratice下执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//全局安装，默认最新版本，可以使用@指定版本</span><br><span class="line">npm install webpack -g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//可以使用cnpm淘宝镜像，这样速度更快</span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line">//用cnpm来安装。速度较快</span><br><span class="line">cnpm install webpack -g</span><br><span class="line"></span><br><span class="line">//在3版本及之前安装webpack的时候就一同把webpack-cli也下载了，但是webpack4开始需要手动安装webpack-cli</span><br><span class="line">//安装webpack-cli</span><br><span class="line">cnpm install webpack-cli -g</span><br><span class="line">//查看版本号</span><br><span class="line">webpack -v</span><br></pre></td></tr></table></figure><p>至此webpack安装成功。</p><p>然后执行webpack命令，结果报错：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/webpack4.jpg" alt=""></p><p>原因是webpack命令会默认打包<strong>该路径下src文件夹下的index.js文件</strong>，但是我们这个pratice是个空文件夹。我们可以新建一下src/index.js，然后再执行webpack就不会报错了。执行webpack后会自动生成一个dist文件夹，里面有将index.js打包好的main.js文件，默认是production压缩形式，可以执行<code>webpack --mode development</code>打包成未压缩的格式，方便阅读。</p><p>因为浏览器不支持require、import等那几个模块化变量，所以如果在src的js代码中使用了模块化，直接引用这样的js文件，浏览器是会报错的，所以需要通过webpack解析打包生成新的js文件，如上述的dist/main.js，然后引用这个js文件才ok。<br><br></p><h2 id="引入模块化的简单打包"><a href="#引入模块化的简单打包" class="headerlink" title="引入模块化的简单打包"></a>引入模块化的简单打包</h2><p>新建sum.js：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a+b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>新建minus.js：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a -b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>项目pratice中新建demo.js：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sum <span class="keyword">from</span> <span class="string">'./sum.js'</span><span class="comment">/* 使用ES Module规范 */</span></span><br><span class="line"><span class="keyword">var</span> minus = <span class="built_in">require</span>(<span class="string">'./minus.js'</span>)<span class="comment">/* 使用commonjs规范 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = sum(<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = minus(<span class="number">100</span>,<span class="number">9</span>);</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure><p>引入了ES Module和commonJS的模块化代码，浏览器是不支持的，所以要使用webpack来打包生成目标js文件，但是这次我不想被默认地打包到dist/main.js中，故可以使用命令<code>webpack demo.js -o ./hh/bundle.js</code>将模块化代码打包到指定的路径下。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/webpack0.jpg" alt=""></p><p><br><br></p><h2 id="关于安装本地局部webpack"><a href="#关于安装本地局部webpack" class="headerlink" title="关于安装本地局部webpack"></a>关于安装本地局部webpack</h2><p>在此之前，我已经安装了<strong>全局的webpack</strong>，因此除了上述的项目路径下可以使用webpack指令，其他的路径也是可以使用的。但是最好再当前的项目路径下再安装一个<strong>本地局部的webpack</strong>。</p><p><strong>先在项目根路径下执行<code>npm init</code>指令进行项目初始化</strong>，该过程中可以一路回车。会生成一个package.json文件，里面会记录你的各种加载器loader、插件、webpack或者jQuery等等相关信息。这是非常方便的一个事情，举个例子：比如我拿到了别人给我的一个项目，package.json里面就记录了该项目所依赖的各种东西，比如webpack是3.0版本的，而我的全局webpack是4.0版本的，那么不用慌，我可以查看package.json里记录的信息，手动安装一次本地的webpack3.0。更方便的是我可以直接执行<code>npm install</code>指令自动下载package.json里面的所有依赖。</p><p>项目初始化完成后，执行<code>npm install webpack --save-dev</code>安装本地开发版本的webpack。之后会生成一个node modules的文件夹，里面都是安装下来的包。webpack-cli也是一样本地安装一次。</p><p><br><br></p><h2 id="关于webpack-config-js"><a href="#关于webpack-config-js" class="headerlink" title="关于webpack.config.js"></a>关于webpack.config.js</h2><p>webpack.config.js是webpack的默认配置文件，它的书写必须遵循CommonJs规范。它不是唯一的，一个项目可以有多个配置文件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);<span class="comment">/* path是node里面的变量 */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),<span class="comment">/* __dirname表示当前路径文件夹 */</span></span><br><span class="line">        filename: <span class="string">'my-first-webpack.bundle.js'</span><span class="comment">/* 打包文件的名字 */</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mode: <span class="string">'development'</span>,<span class="comment">/* 设置打包出来的文件是未压缩的格式 */</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="配置多个入口文件"><a href="#配置多个入口文件" class="headerlink" title="配置多个入口文件"></a>配置多个入口文件</h3><p>可以使用对象的方式</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);<span class="comment">/* path是node里面的变量 */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: <span class="string">'./src/index.js'</span>,</span><br><span class="line">        app: <span class="string">'./src/app.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),<span class="comment">/* __dirname表示当前路径文件夹 */</span></span><br><span class="line">        filename: <span class="string">'[name].bundle.js'</span> <span class="comment">/* 注意这里用了[name] */</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mode: <span class="string">'development'</span>,<span class="comment">/* 设置打包出来的文件是未压缩的格式 */</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>执行<code>webpack</code>指令后会在dist文件夹下生成对应的app.bundle.js和index.bundle.js。注意<code>filename: &#39;[name].bundle.js&#39;</code></p><p><br></p><h3 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h3><p>loader用于处理非js文件。在webpack中写相应的配置规则，并且安装相应的插件。下面以less-loader为例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//安装less-loader之前先安装less</span><br><span class="line">cnpm i style-loader less-loader css-loader less --save-dev</span><br></pre></td></tr></table></figure><p>修改webpack.config.js：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);<span class="comment">/* path是node里面的变量 */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: <span class="string">'./src/index.js'</span>,</span><br><span class="line">        app: <span class="string">'./src/app.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),<span class="comment">/* __dirname表示当前路径文件夹 */</span></span><br><span class="line">        filename: <span class="string">'[name].bundle.js'</span> <span class="comment">/* 注意这里用了[name] */</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'less-loader'</span>] &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: <span class="string">'development'</span>,<span class="comment">/* 设置打包出来的文件是未压缩的格式 */</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>以下是常见的几个loader：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 配置所有第三方loader 模块的</span></span><br><span class="line">  rules: [ <span class="comment">// 第三方模块的匹配规则</span></span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;, </span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;, </span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;, </span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif|bmp|jpeg)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader?limit=7631&amp;name=[hash:8]-[name].[ext]'</span> &#125;, <span class="comment">// 处理图片路径的loader</span></span><br><span class="line">    <span class="comment">// limit给定的值，是图片的大小，单位是byte， 如果我们引用的图片，大于或等于给定的limit值，则不会被转为base64格式的字符串， 如果图片小于给定的limit值，则会被转为base64的字符串</span></span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;, <span class="comment">//处理字体文件的 loader </span></span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;, <span class="comment">//配置Babel来转换ES6语法</span></span><br><span class="line">    &#123; <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>, <span class="attr">use</span>: <span class="string">'vue-loader'</span> &#125; <span class="comment">// 处理 .vue 文件的 loader</span></span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><br></p><h3 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h3><p>loader被用于转换某些非js类型的模块，而插件则可以执行范围更广的任务，包括：从打包优化和压缩，一直到重新定义环境中的变量等等。</p><p>想要使用一个插件，先安装下载，然后需要require()它，然后把它添加到<strong>plugins数组</strong>中。</p><p><code>cnpm i html-webpack-plugin -D</code>执行该指令安装插件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);<span class="comment">/* path是node里面的变量 */</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>); <span class="comment">//通过 npm 安装</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: <span class="string">'./src/index.js'</span>,</span><br><span class="line">        app: <span class="string">'./src/app.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),<span class="comment">/* __dirname表示当前路径文件夹 */</span></span><br><span class="line">        filename: <span class="string">'[name].bundle.js'</span> <span class="comment">/* 注意这里用了[name] */</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.ts$/</span>, <span class="attr">use</span>: <span class="string">'ts-loader'</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin()<span class="comment">/* 这里可传参也可不传参 */</span></span><br><span class="line">    ],</span><br><span class="line">    mode: <span class="string">'development'</span>,<span class="comment">/* 设置打包出来的文件是未压缩的格式 */</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>然后会在dist文件中生成index.html文件，里面自动引入了我们配置的js文件。</p><p><br><br></p><h2 id="JS-tree-shaking"><a href="#JS-tree-shaking" class="headerlink" title="JS tree shaking"></a><a href="https://webpack.docschina.org/guides/tree-shaking" target="_blank" rel="noopener">JS tree shaking</a></h2><p>项目文件 treeShaking，先项目初始化<code>npm init -y</code>，然后在生成的package.json里面添加<code>&quot;dev&quot;: &quot;webpack --mode development&quot;</code> ，之后就不用每次都执行那么长的指令了，直接<code>npm run dev</code>即可。同理也可以配置以下生产环境的指令<code>&quot;prod&quot;: &quot;webpack --mode production&quot;</code></p><p>js tree shaking通常用于描述移除 JavaScript 上下文中的未引用代码(dead-code)，就是把未使用到的js代码去掉，精简js代码。它依赖于 ES2015 模块语法的 <a href="http://exploringjs.com/es6/ch_modules.html#static-module-structure" target="_blank" rel="noopener">静态结构</a> 特性，例如 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" target="_blank" rel="noopener"><code>import</code></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export" target="_blank" rel="noopener"><code>export</code></a>。</p><p><br></p><h4 id="development-VS-production"><a href="#development-VS-production" class="headerlink" title="development VS production"></a>development VS production</h4><p>举个例子：</p><p>index.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;abc&#125; <span class="keyword">from</span> <span class="string">'../sum.js'</span>;</span><br><span class="line">abc();</span><br></pre></td></tr></table></figure><p>sum.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abc = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'这是abc'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> heihei = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'这是heihei'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">    abc,</span><br><span class="line">    heihei</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行npm run dev后生成main.js，事实上我们只引用到了sum.js中的abc，并没有使用heihei，但是在webpack生成的main.js中搜索heihei关键字，发现依旧生成了关于heihei的代码，这造成了不必要的冗余。</p><p>如果我们执行npm run prod生成main.js，我们发现没有生成关于heihei的代码，因为production模式下会自动去掉未使用的js代码，实现了tree shaking。</p><p><br></p><h4 id="webpack-deep-scope-plugin"><a href="#webpack-deep-scope-plugin" class="headerlink" title="webpack-deep-scope-plugin"></a>webpack-deep-scope-plugin</h4><p><code>Loadsh</code> 是一个一致性、模块化、高性能的 JavaScript 实用工具库。在数据操作时，我们经常会用的 loadsh 封装好的一些工具方法，但是并不想把整个包打包进项目里面。要用到 tree-shaking，必然要保证引用的模块都是 ES6 规范的。lodash-es 是着具备 ES6 模块化的版本，只需要直接引入就可以。 </p><p>先安装lodash-es： <code>cnpm i lodash-es -D</code></p><p>sum.js中引入lodash-es库：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lodash <span class="keyword">from</span> <span class="string">'lodash-es'</span></span><br><span class="line"><span class="keyword">var</span> abc = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'这是abc'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isArray = <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(lodash.isArray(arg)); <span class="comment">/* 判断传入的参数是否为数组 */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">    abc,</span><br><span class="line">    isArray</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是index.js中仍然只使用abc：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;abc&#125; <span class="keyword">from</span> <span class="string">'../sum.js'</span>;</span><br><span class="line">abc();</span><br></pre></td></tr></table></figure><p>执行npm run dev，发现打包后的文件大小多达1.5Mb，相比于npm run prod生成的只有86Kb大小，因为它把lodash-es也打包进去了尽管我们index.js中并没有真正使用到lodash-es。但是尽管npm run prod生成的main.js确实比development的小，<strong>事实上它也打包了lodash-es里的代码了</strong>，只是比前者少了一点。因为npm run prod只能进行词法语法层面上的分析（sum.js中确实写了些关于lodash-es的代码），无法进行<strong>scope作用域</strong>上的分析，到底真正用没用它是不知道的。因此，<strong>npm run prod并不是最佳的tree shaking</strong>。</p><p>这里 就需要用到一个插件： <a href="https://github.com/vincentdchan/webpack-deep-scope-analysis-plugin" target="_blank" rel="noopener">webpack-deep-scope-plugin</a>。 先安装<code>npm i  webpack-deep-scope-plugin -D</code></p><p>在webpack.config.js中进行配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> WebpackDeepScopeAnalysisPlugin = <span class="built_in">require</span>(<span class="string">'webpack-deep-scope-plugin'</span>).default;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> WebpackDeepScopeAnalysisPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后，执行<code>npm run prod</code>，我们发现打包出来的main.js大小不到1Kb。js tree shaking得到了较好的结果。</p><p><br><br></p><h2 id="CSS-tree-shaking"><a href="#CSS-tree-shaking" class="headerlink" title="CSS tree shaking"></a>CSS tree shaking</h2><p>首先关于css的，就一定要先安装好style-loader和css-loader，以及写好配置规则。<br></p><h3 id="单独抽离出css"><a href="#单独抽离出css" class="headerlink" title="单独抽离出css"></a>单独抽离出css</h3><p>然后需要安装一个插件<a href="https://github.com/webpack-contrib/mini-css-extract-plugin" target="_blank" rel="noopener">mini-css-extract-plugin</a>，用于单独抽离出css文件而非被写进main.js中。</p><p>写好配置规则：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> WebpackDeepScopeAnalysisPlugin = <span class="built_in">require</span>(<span class="string">'webpack-deep-scope-plugin'</span>).default;</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [MiniCssExtractPlugin.loader, <span class="string">'css-loader'</span>] &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> WebpackDeepScopeAnalysisPlugin(),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'[name].css'</span>,</span><br><span class="line">            <span class="comment">// chunkFilename: '[id].css',</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意的是，这里用MiniCssExtractPlugin.loader代替了之前的style-loader，style-loader是生成行间样式的，这个mini-css-extract-plugin插件可以生成一个main.css文件，然后我们就可以使用<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;../dist//main.css&quot;&gt;</code>来引入css。在生成的dist/main.js中是没有关于demo.css的代码的，做到了单独抽离出css文件。</p><p><br></p><h3 id="css抖动"><a href="#css抖动" class="headerlink" title="css抖动"></a>css抖动</h3><p>渡一视频这里用到了一个新的插件<a href="https://github.com/webpack-contrib/purifycss-webpack" target="_blank" rel="noopener">purifycss-webpack</a>。但是这个插件已经被弃用了，用起来也有些bug，有些有被使用到的css没有被打包。我这里就不写了。</p><p><br><br></p><h2 id="复习一下处理css-less和postcss"><a href="#复习一下处理css-less和postcss" class="headerlink" title="复习一下处理css/less和postcss"></a>复习一下处理css/less和postcss</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm i webpack -D</span><br><span class="line">npm i webpack-cli -D</span><br><span class="line">npm i css-loader -D</span><br><span class="line">npm i style-loader -D</span><br><span class="line">npm i less -D</span><br><span class="line">npm i less-loader -D</span><br><span class="line">npm i mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//demo.css</span><br><span class="line">*&#123;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(45deg);</span><br><span class="line">    .box &#123;</span><br><span class="line">        <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">        <span class="selector-tag">width</span>: 300<span class="selector-tag">px</span>;</span><br><span class="line">        <span class="selector-tag">height</span>: 300<span class="selector-tag">px</span>;</span><br><span class="line">        <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#000</span>;</span><br><span class="line">        <span class="selector-tag">top</span>: 40%;</span><br><span class="line">        <span class="selector-tag">left</span>: 40%;</span><br><span class="line">        <span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>;</span><br><span class="line">        <span class="selector-tag">a</span>&#123;</span><br><span class="line">            <span class="attribute">color</span>: pink;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">            <span class="attribute">line-height</span>: <span class="number">300px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo.less</span></span><br><span class="line">*&#123;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line">    <span class="attribute">transform</span>: rotate(<span class="number">45deg</span>);</span><br><span class="line">    <span class="selector-class">.box</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">40%</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">40%</span>;</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line">        <span class="selector-tag">a</span>&#123;</span><br><span class="line">            <span class="attribute">color</span>: pink;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">            <span class="attribute">line-height</span>: <span class="number">300px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"> <span class="keyword">import</span> <span class="string">'./demo.css'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//index.html</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./dist/index.bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>); <span class="comment">//单独抽离出css文件</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry:&#123;</span><br><span class="line">        index: <span class="string">'./index.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'[name].bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: MiniCssExtractPlugin.loader,</span><br><span class="line">                        <span class="comment">// options:&#123;  &#125;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: MiniCssExtractPlugin.loader,</span><br><span class="line">                        <span class="comment">// options:&#123;  &#125;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line"></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'less-loader'</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'[name].css'</span>,</span><br><span class="line">            <span class="comment">// chunkFilename: '[id].css',</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="postcss"><a href="#postcss" class="headerlink" title="postcss"></a>postcss</h3><p>有个问题就是关于css3的兼容代码，像demo.less里面的<code>transform: rotate(45deg);</code>，需要写：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(45<span class="selector-tag">deg</span>);</span><br><span class="line"><span class="selector-tag">-ms-transform</span>: <span class="selector-tag">rotate</span>(45<span class="selector-tag">deg</span>);        <span class="comment">/* IE 9 */</span></span><br><span class="line"><span class="selector-tag">-webkit-transform</span>: <span class="selector-tag">rotate</span>(45<span class="selector-tag">deg</span>);    <span class="comment">/* Safari and Chrome */</span></span><br><span class="line"><span class="selector-tag">-o-transform</span>: <span class="selector-tag">rotate</span>(45<span class="selector-tag">deg</span>);        <span class="comment">/* Opera */</span></span><br><span class="line"><span class="selector-tag">-moz-transform</span>: <span class="selector-tag">rotate</span>(45<span class="selector-tag">deg</span>);        <span class="comment">/* Firefox */</span></span><br></pre></td></tr></table></figure><p>基于postcss可以自动帮我们加上这些兼容的前缀。</p><p>另一个问题就是基于postcss可以解析cssnext的代码：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//带有cssnext代码的demo.less</span></span><br><span class="line">*&#123;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line">    <span class="attribute">transform</span>: rotate(<span class="number">45deg</span>);</span><br><span class="line">    <span class="selector-class">.box</span> &#123;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">40%</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">40%</span>;</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line">        <span class="selector-tag">a</span>&#123;</span><br><span class="line">            <span class="attribute">color</span>: pink;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">            <span class="attribute">line-height</span>: <span class="number">300px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    <span class="attribute">--color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: var(--color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="安装与配置"><a href="#安装与配置" class="headerlink" title="安装与配置"></a>安装与配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i postcss postcss-loader autoprefixer cssnano postcss-cssnext -D</span><br></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry:&#123;</span><br><span class="line">        index: <span class="string">'./index.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'[name].bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: MiniCssExtractPlugin.loader,</span><br><span class="line">                        <span class="comment">// options:&#123;  &#125;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">                use:[</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: MiniCssExtractPlugin.loader,</span><br><span class="line">                        <span class="comment">// options:&#123;  &#125;</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line"></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;   <span class="comment">/* 这部分要写在css-loader之后、less-loader之前 */</span></span><br><span class="line">                        loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            ident: <span class="string">'postcss'</span>,</span><br><span class="line">                            plugins:[</span><br><span class="line">                                <span class="built_in">require</span>(<span class="string">'postcss-cssnext'</span>)(), <span class="comment">/* 用于解析cssnext代码，并实现autoprefixer的功能 */</span></span><br><span class="line">                                <span class="comment">// require('autoprefixer')(),/* 用于自动添加兼容前缀 , 注意在数组里面不可以有分号*/</span></span><br><span class="line">                                <span class="built_in">require</span>(<span class="string">'cssnano'</span>)() <span class="comment">/* 用于压缩代码 */</span></span><br><span class="line">                            ]</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'less-loader'</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'[name].css'</span>,</span><br><span class="line">            <span class="comment">// chunkFilename: '[id].css',</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="单独抽离html文件"><a href="#单独抽离html文件" class="headerlink" title="单独抽离html文件"></a>单独抽离html文件</h2><p><br></p><h3 id="HtmlWebpackPlugin"><a href="#HtmlWebpackPlugin" class="headerlink" title="HtmlWebpackPlugin"></a><a href="https://webpack.docschina.org/plugins/html-webpack-plugin/" target="_blank" rel="noopener">HtmlWebpackPlugin</a></h3><p>npm install –save-dev html-webpack-plugin 安装之，然后再webpack.config.js中配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'[name].css'</span>,</span><br><span class="line">            <span class="comment">// chunkFilename: '[id].css',</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'index.html'</span>,</span><br><span class="line">            template: <span class="string">'./index.html'</span>,</span><br><span class="line">            minify:&#123;</span><br><span class="line">                removeComments: <span class="literal">true</span>,  <span class="comment">/* 清理掉index.html里面的注释 */</span></span><br><span class="line">                collapseWhitespace: <span class="literal">true</span>, <span class="comment">/* 清理掉空格 */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure><p>之后会生成dist/index.html，而且里面会自动引入所需要的css和 js，因此不必再src/index.html中手动加入了。 </p><p>事实上html-webpack-plugin还有很多可以配置的东西，网上都有。</p><p><br></p><h3 id="clean-webpack-plugin"><a href="#clean-webpack-plugin" class="headerlink" title="clean-webpack-plugin"></a><a href="https://github.com/johnagan/clean-webpack-plugin" target="_blank" rel="noopener">clean-webpack-plugin</a></h3><p>另外我们每次webpack要重新生成dist文件夹的时候，之前生成的一直都在着需要手动删除，比较麻烦，所以可以使用一个插件<code>clean-webpack-plugin</code>。 命令<code>npm i clean-webpack-plugin -D</code>执安装之。</p><p>然后再webpack.config.js中配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin()</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure><p>即可。</p><p><br><br></p><h2 id="提取公共JS代码"><a href="#提取公共JS代码" class="headerlink" title="提取公共JS代码"></a>提取公共JS代码</h2><p>存在一个情况，假如有a，b两个js文件，它俩都引入了一个相同的第三方库或者是相同的自定义的模块。那么当我们加载a文件的时候会把它打包出来，包括引用了的相同的库和模块，而加载b文件的时候也做了相同的事情，那么明明是相同的一个库或模块，却被打包了两次，这样就冗余了，降低了效率。我们将同一个代码/模块/库打包了多次，因此我们需要做到提取公共JS代码，避免上述情况发生，实现减少代码冗余，提高项目的加载速度。</p><p>注意的是，提取公共代码针对的是多入口文件，如果只有一个js文件的话是不成立的。提取公共代码至少是两个文件。</p><p><br></p><h3 id="案例一：-自定义公共业务代码"><a href="#案例一：-自定义公共业务代码" class="headerlink" title="案例一： 自定义公共业务代码"></a>案例一： 自定义公共业务代码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这是一个公共模块 module.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'module'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//subPageA.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./module.js'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'subPageA'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//subPageB.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./module.js'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'subPageB'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pageA.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./subPageA.js'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pageB.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./subPageB.js'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">entry:&#123;</span><br><span class="line">    <span class="comment">// index: './index.js'</span></span><br><span class="line">    pageA: <span class="string">'./src/pageA.js'</span>,</span><br><span class="line">    pageB: <span class="string">'./src/pageB.js'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">output:&#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name][hash:5].bundle.js'</span>,</span><br><span class="line">    chunkFilename: <span class="string">'[name][hash:5].js'</span></span><br><span class="line">&#125;,</span><br><span class="line">optimization:&#123;</span><br><span class="line">    splitChunks:&#123;</span><br><span class="line">        cacheGroups:&#123;</span><br><span class="line">            common:&#123;</span><br><span class="line">                name:<span class="string">"common"</span>, <span class="comment">/* 表示打包出来的公共模块的名字，不写的话就默认是chunkFilename */</span></span><br><span class="line">                chunks:<span class="string">'all'</span>, <span class="comment">/* 表示作用的范围 */</span></span><br><span class="line">                minSize: <span class="number">1</span>, <span class="comment">/* minSize表示生成公共代码块所需要最小的体积，默认是30kb */</span></span><br><span class="line">                minChunks: <span class="number">2</span><span class="comment">/* 表示公共模块被引用的最小次数，这里表示当一个模块被引用了2次以上就视为公共代码块 */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>打包后的：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/webpack1.jpg" alt=""></p><p><br></p><h3 id="案例二：-从lodash中提取公共代码"><a href="#案例二：-从lodash中提取公共代码" class="headerlink" title="案例二： 从lodash中提取公共代码"></a>案例二： 从lodash中提取公共代码</h3><p>先安装一下lodash： cnpm i lodash -D</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pageA.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./subPageA.js'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span>; <span class="comment">//引用lodash</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//pageB.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./subPageB.js'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span>; <span class="comment">//引用lodash</span></span><br></pre></td></tr></table></figure><p>注意的是，我们之前打包出来的公共js文件是我们自定义的公共模块，这里我们引用了第三方库lodash，最好是不要和我们自定义的模块一同被打包到一个公共js文件中，因此需要再配置一下。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">entry:&#123;</span><br><span class="line">    <span class="comment">// index: './index.js'</span></span><br><span class="line">    pageA: <span class="string">'./src/pageA.js'</span>,</span><br><span class="line">    pageB: <span class="string">'./src/pageB.js'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">output:&#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name][hash:5].bundle.js'</span>,</span><br><span class="line">    chunkFilename: <span class="string">'[name][hash:5].js'</span></span><br><span class="line">&#125;,</span><br><span class="line">optimization:&#123;</span><br><span class="line">    splitChunks:&#123;</span><br><span class="line">        cacheGroups:&#123;</span><br><span class="line">            common:&#123;</span><br><span class="line">                name:<span class="string">"common"</span>, <span class="comment">/* 表示打包出来的公共模块的名字，不写的话就默认是chunkFilename */</span></span><br><span class="line">                chunks:<span class="string">'all'</span>, <span class="comment">/* 表示作用的范围 */</span></span><br><span class="line">                minSize: <span class="number">1</span>, <span class="comment">/* minSize表示生成公共代码块所需要最小的体积，默认是30kb */</span></span><br><span class="line">                minChunks: <span class="number">2</span>,<span class="comment">/* 表示公共模块被引用的最小次数，这里表示当一个模块被引用了2次以上就视为公共代码块 */</span></span><br><span class="line">                priority: <span class="number">1</span> <span class="comment">/* 设置优先级，低于vendor的 */</span></span><br><span class="line">            &#125;,</span><br><span class="line">            vendor:&#123;</span><br><span class="line">                name:<span class="string">'vendor'</span>,</span><br><span class="line">                test:<span class="regexp">/[\\/]node_modules[\\/]/</span>,<span class="comment">/* 表示匹配node_modules里的第三方库lodash */</span></span><br><span class="line">                priority: <span class="number">10</span>,<span class="comment">/* 设置优先级，先打包node_modules的*/</span></span><br><span class="line">                chunks: <span class="string">'all'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>打包之后：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/webpack2.jpg" alt=""></p><p><br><br></p><h2 id="处理图片"><a href="#处理图片" class="headerlink" title="处理图片"></a>处理图片</h2><p>项目根目录img</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm i webpack -D</span><br><span class="line">npm i webpack-cli -D</span><br><span class="line">npm i css-loader -D</span><br><span class="line">npm i style-loader -D</span><br><span class="line">npm i mini-css-extract-plugin -D</span><br><span class="line">npm i clean-webpack-plugin -D</span><br><span class="line">npm i html-webpack-plugin -D</span><br><span class="line"></span><br><span class="line">//处理图片要安装以下loader和插件</span><br><span class="line">cnpm i url-loader img-loader -D</span><br><span class="line">cnpm i file-loader -D</span><br><span class="line">npm install imagemin-pngquant -D</span><br><span class="line">npm i imagemin -D</span><br><span class="line">npm i html-loader -D</span><br></pre></td></tr></table></figure><p><br></p><p><a href="https://www.npmjs.com/package/img-loader" target="_blank" rel="noopener">关于img-loader</a>和<a href="https://github.com/imagemin/imagemin-pngquant" target="_blank" rel="noopener">imagemin-pngquant</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">var path = require(&quot;path&quot;);</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;); //单独抽离出css文件</span><br><span class="line">var HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);</span><br><span class="line">const CleanWebpackPlugin = require(&apos;clean-webpack-plugin&apos;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: &apos;./index.js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, &quot;dist&quot;),</span><br><span class="line">        filename: &apos;[name][hash:5].bundle.js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.css$/,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: MiniCssExtractPlugin.loader,</span><br><span class="line">                        // options:&#123;  &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123; loader: &apos;css-loader&apos; &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123; // limit 给定的值，是图片的大小，单位是 byte， 如果我们引用的 图片，大于或等于给定的 limit值，则不会被转为base64格式的字符串， 如果 图片小于给定的 limit 值，则会被转为 base64的字符串</span><br><span class="line">                test: /\.(jpg|png|gif|bmp|jpeg)$/,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: &apos;url-loader&apos;,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            name: &apos;[name][hash:5].[ext]&apos;,</span><br><span class="line">                            /* 限制图片大小 */</span><br><span class="line">                            limit: 77967,</span><br><span class="line">                            outputPath: &apos;img&apos; /* 会创建dist/img文件夹 */</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    // use: &apos;url-loader?limit=7631&amp;name=[hash:8]-[name].[ext]&apos; </span><br><span class="line">                    &#123;</span><br><span class="line">                        loader:&apos;img-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            plugins:[</span><br><span class="line">                                require(&apos;imagemin-pngquant&apos;)(&#123;</span><br><span class="line">                                    quality:[0.3,0.6]</span><br><span class="line">                                  &#125;),</span><br><span class="line">                            ]</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.(ttf|eot|svg|woff|woff2)$/,</span><br><span class="line">                use: &apos;url-loader&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: &apos;[name].css&apos;,</span><br><span class="line">            // chunkFilename: &apos;[id].css&apos;,</span><br><span class="line">        &#125;),</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            filename: &apos;index.html&apos;,</span><br><span class="line">            template: &apos;./index.html&apos;,</span><br><span class="line">            // minify:&#123;</span><br><span class="line">            // removeComments: true,  /* 清理掉index.html里面的注释 */</span><br><span class="line">            // collapseWhitespace: true, /* 清理掉空格 */</span><br><span class="line">            // &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        new CleanWebpackPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上到这一步为止，只能处理css中的url，尚无法解析html中引用的图片路径，比如html中的<code>&lt;img src=&quot;./logo.png&quot; alt=&quot;&quot;&gt;</code>是会报错的。因此需要安装一个html-loader，然后在webpack.config.js中的module-&gt;rules添加一个test:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &#123;</span><br><span class="line">    test:<span class="regexp">/\.html$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">        &#123;</span><br><span class="line">            loader: <span class="string">'html-loader'</span>,</span><br><span class="line">            options:&#123;</span><br><span class="line">                attrs:[<span class="string">'img:src'</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就 ok 了</p><p><br><br></p><h2 id="webpack-dev-server开启本地服务器"><a href="#webpack-dev-server开启本地服务器" class="headerlink" title="webpack-dev-server开启本地服务器"></a>webpack-dev-server开启本地服务器</h2><p>先安装 ：  npm install webpack-dev-server -g    要全局安装</p><p>安装成功后执行命令<code>webpack-dev-server --open</code>就可以了，默认在localhost:8080端口，项目就启动了。但是要注意的是，该命令并没有把项目进行打包，所以最后发布的时候还是要用webpack指令进行打包。</p><p>它会实时监听代码的变化。</p><p><br></p><h3 id="devServer配置："><a href="#devServer配置：" class="headerlink" title="devServer配置："></a>devServer配置：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    devServer:&#123;</span><br><span class="line">    port:&apos;9091&apos;,</span><br><span class="line">    // contentBase:&apos;dist&apos; /* 不填的话默认是项目根路径 */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="进行数据交互"><a href="#进行数据交互" class="headerlink" title="进行数据交互"></a>进行数据交互</h2><p>mock一个假数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//data.json</span><br><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;: &quot;新裤子乐队&quot;,</span><br><span class="line">    &quot;birthday&quot;: &quot;1996&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//index.js</span><br><span class="line">var data = require(&apos;./data.json&apos;);</span><br><span class="line">console.log(data);</span><br></pre></td></tr></table></figure><p>然后就可以了。</p><p><br><br></p><p>再来说说使用ajax的：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">'jquery'</span>;</span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">require</span>(<span class="string">'./data.json'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(data);</span><br><span class="line"></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'http://localhost:9091/data.json'</span>,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'ajax获取数据成功：'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;,</span><br><span class="line">    error:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'获取数据失败！'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="热更新-hot-module-replace"><a href="#热更新-hot-module-replace" class="headerlink" title="热更新 hot module replace"></a>热更新 hot module replace</h2><p>虽然说webpack-dev-server可以自动监听代码变化并自动刷新，但是它每次刷新都要整个页面刷新，整个页面的所有数据都要重新请求一遍，实际上修改的只是一部分，其他的是不必要重新请求的。这里引出了<strong>热更新</strong>这个概念。热更新，英文为 <strong>hot module replace</strong>，直译为“热模块替换”，这里的热模块就是被修改的那部分模块。</p><p>webpack中内置了热更新的插件，所以不必再下载，直接再webpack.config.js中配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">var</span> Webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);<span class="comment">//第一步</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    plugins:[</span><br><span class="line">        ...,</span><br><span class="line">    <span class="comment">//第二步</span></span><br><span class="line">        <span class="keyword">new</span> Webpack.HotModuleReplacementPlugin(), <span class="comment">/* webpack内置的热更新插件 */</span></span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        port: <span class="string">"9091"</span>,</span><br><span class="line">        <span class="comment">// contentBase: 'dist'  /* 默认是项目根路径 */</span></span><br><span class="line">        hot: <span class="literal">true</span>, <span class="comment">/* 开启热更新 */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样热更新基本实现了。<br></p><p><strong>【需要注意的是】：</strong></p><p>对于CSS，如果使用了MiniCssExtractPlugin单独抽离出来css文件，那么这个热更新是无效的。之对于使用style-loader的有效。</p><p>对于JS，目前这一步是无法实现对于js的热更新的 ，需要再js文件中添加如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">module</span>.hot)&#123;</span><br><span class="line">    <span class="built_in">module</span>.hot.accept();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就实现了对于js代码的热更新。</p><p><br><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6数据劫持proxy&amp;reflect</title>
      <link href="/2019/04/03/ES6%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81.html"/>
      <url>/2019/04/03/ES6%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81.html</url>
      
        <content type="html"><![CDATA[<h2 id="ES5数据劫持"><a href="#ES5数据劫持" class="headerlink" title="ES5数据劫持"></a>ES5数据劫持</h2><p>VUE的双向数据绑定的基础知识。</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMgy1g286elh0cuj30fy07twft.jpg" alt=""></p><p><strong>对对象的监测</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">'show'</span>);</span><br><span class="line"><span class="keyword">var</span> oInput = <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> oData = &#123;</span><br><span class="line">    valueObj: &#123;</span><br><span class="line">        value: <span class="string">'duntengOG'</span>,</span><br><span class="line">        name: <span class="string">'haha'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    sex: <span class="string">'aaa'</span>  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">oInput.oninput = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    oData.value = <span class="keyword">this</span>.value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upDate</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    oDiv.innerText = oData.valueObj.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">upDate();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监控对象的某个属性是否发生改变</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observer</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!data || <span class="keyword">typeof</span> data != <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// for (var prop in data) &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        definedRective(data, key, data[key]);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">definedRective</span> (<span class="params">data, key, val</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// AO</span></span><br><span class="line">    Observer(val);<span class="comment">//针对对象属性的监测</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        get () &#123;</span><br><span class="line">            <span class="comment">// console.log('get');</span></span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;,</span><br><span class="line">        set (newValue) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newValue == val) <span class="keyword">return</span>;</span><br><span class="line">            val = newValue;</span><br><span class="line">            upDate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Observer(oData);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(oData.valueObj);</span><br><span class="line">oData.valueObj.value = <span class="string">'haha'</span>;</span><br></pre></td></tr></table></figure><p>有个缺点就是如果之后该对象又新增了一个属性，则Observer是无法监测到的</p><p><strong>对数组的监测</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [];</span><br><span class="line"><span class="keyword">let</span> &#123;push&#125; = <span class="built_in">Array</span>.prototype;<span class="comment">//解构赋值定义一个push函数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upData</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'更新后的数组arr为：'</span>+arr);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Array</span>.prototype, <span class="string">'push'</span>, &#123;</span><br><span class="line">    value: (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">...arg</span>) =&gt;</span> &#123;</span><br><span class="line">            push.apply(arr, arg);</span><br><span class="line">            upData();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)()</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr.push(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><h2 id="ES6数据劫持"><a href="#ES6数据劫持" class="headerlink" title="ES6数据劫持"></a>ES6数据劫持</h2><p><strong>proxy &amp; reflect</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g29c5nx2b1j30ex08hab8.jpg" alt=""></p><p>ES6中新增的proxy&amp;reflect实现了数据劫持的功能，是ES6在较底层实现的功能所以不用babel转换。代码量比ES5的少了，而且不会出现像ES5那样在程序后续过程中新增监测对象属性监测不到的情况。但是proxy&amp;reflect的兼容性不好。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> oData = &#123;</span><br><span class="line">    val: <span class="string">'duntengOG'</span>,</span><br><span class="line">    _val: <span class="string">'aaaa'</span><span class="comment">//我们定义的私有属性，不想让别人知道</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> oProxyData = <span class="keyword">new</span> <span class="built_in">Proxy</span>(oData, &#123;</span><br><span class="line">    set(target, key, value, receiver) &#123;</span><br><span class="line">        <span class="comment">// console.log(target, key, value, receiver); target就是代理对象，key即操作的属性</span></span><br><span class="line">        <span class="built_in">Reflect</span>.set(target, key, value);</span><br><span class="line">        upDate();</span><br><span class="line">    &#125;,</span><br><span class="line">    get(target, key, receiver) &#123;</span><br><span class="line">        <span class="comment">// console.log(target, key, receiver);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 还有has、deleteProperty。。。等操作，但不是很常见</span></span><br><span class="line">    has(target, key) &#123;</span><br><span class="line">        <span class="keyword">return</span> key.indexOf(<span class="string">'_'</span>) != <span class="number">-1</span> ? <span class="literal">false</span> : key <span class="keyword">in</span> oData;</span><br><span class="line">    &#125;,</span><br><span class="line">    deleteProperty() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 读写 控制</span></span><br><span class="line"><span class="built_in">console</span>.log(oProxyData.val);</span><br><span class="line">oProxyData.val = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upDate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'更新了'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">oProxyData.name = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// console.log( delete oProxyData.val );</span></span><br></pre></td></tr></table></figure><p>（完）</p><p>转载请注明出处。</p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>箭头函数看这篇就够了</title>
      <link href="/2019/04/01/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E7%9C%8B%E8%BF%99%E7%AF%87%E5%B0%B1%E5%A4%9F%E4%BA%86.html"/>
      <url>/2019/04/01/%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E7%9C%8B%E8%BF%99%E7%AF%87%E5%B0%B1%E5%A4%9F%E4%BA%86.html</url>
      
        <content type="html"><![CDATA[<h1 id="初试箭头函数"><a href="#初试箭头函数" class="headerlink" title="初试箭头函数"></a>初试箭头函数</h1><p><strong>作用：</strong>函数目的指向性更强，可读性更好，简化代码，提高开发效率</p><p><strong>特点：</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g26yir0e5ij30ey09775m.jpg" alt=""></p><p><strong>代码1：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> add = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//也可以这样写，省略return更加简洁</span></span><br><span class="line"><span class="keyword">let</span> add = <span class="function">(<span class="params">a,b</span>)=&gt;</span>(a+b);</span><br></pre></td></tr></table></figure><p><strong>代码2：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对象的应用</span></span><br><span class="line"><span class="keyword">let</span> func1 = <span class="function">(<span class="params">a,b,c</span>)=&gt;</span>(&#123;a,b,c&#125;);</span><br><span class="line"><span class="keyword">let</span> func2 = <span class="function">(<span class="params">a,b,c</span>)=&gt;</span>(&#123;<span class="attr">aa</span>:a,<span class="attr">bb</span>:b,<span class="attr">cc</span>:c&#125;);</span><br><span class="line"><span class="comment">// let func3 = (a,b,c)=&gt;&#123;aa:a,bb:b,cc:c&#125;;//如果不加圆括号是会报错的</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(func1(<span class="number">12</span>,<span class="number">35</span>,<span class="number">5</span>));</span><br><span class="line"><span class="built_in">console</span>.log(func2(<span class="number">12</span>,<span class="number">35</span>,<span class="number">5</span>));</span><br><span class="line"><span class="comment">// console.log(func3(12,35,5));</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g26yyfgxeij307705nwec.jpg" alt=""></p><p><strong>代码3：</strong></p><p><strong>箭头函数必须用一个东西来存，可以使变量、属性或者使数组</strong>，想比于ES5中函数可以用function funC(a,b){}格式声明，箭头函数是不允许的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用变量存</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">sum();<span class="comment">//这样调用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//用对象属性存</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    fn: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn();<span class="comment">//这样调用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//用数组存</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;];</span><br><span class="line">arr[<span class="number">0</span>]();<span class="comment">//这样调用</span></span><br></pre></td></tr></table></figure><h1 id="高阶函数应用"><a href="#高阶函数应用" class="headerlink" title="高阶函数应用"></a>高阶函数应用</h1><p>数学和计算机科学中，高阶<strong>函数</strong>是至少满足下列一个条件的<strong>函数</strong>： 接受一个或多个<strong>函数</strong>作为输入参数，返回输出一个<strong>函数</strong></p><p>箭头函数在高阶函数的应用中可以使代码更加简便，下面来看一下对比：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//高阶函数之ES5的传统方法</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">y</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">z</span>) </span>&#123; </span><br><span class="line">            <span class="keyword">return</span> x+y+z;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum1 = sum(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> sum2 = sum1(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> sum3 = sum2(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(sum3);<span class="comment">//成功输出6</span></span><br><span class="line"><span class="comment">/*************把上面的函数改成箭头函数语法**********************/</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="function">(<span class="params">x</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">y</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">z</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> x+y+z;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*************进一步省略return**********************/</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="function">(<span class="params">x</span>)=&gt;</span><span class="function">(<span class="params">y</span>)=&gt;</span><span class="function">(<span class="params">z</span>)=&gt;</span>(x+y+z);</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>));<span class="comment">//输出6</span></span><br></pre></td></tr></table></figure><h1 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h1><p><strong>内部arguments和this都是由定义时外围最接近一层的非箭头函数的arguments和this决定其值的</strong> </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 举个例子</span></span><br><span class="line"><span class="keyword">var</span>  myfun1 = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>,a,b);</span><br><span class="line">&#125;</span><br><span class="line">myfun1(<span class="number">12</span>,<span class="number">5</span>);<span class="comment">//可以正常输出arguments和12和5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myfun2 = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>, a, b)</span><br><span class="line">&#125;</span><br><span class="line">myfun2(<span class="number">12</span>, <span class="number">5</span>);<span class="comment">//报错，arguments未定义,myfun2函数外围没有非箭头函数</span></span><br></pre></td></tr></table></figure><p>再举个带外围非箭头函数的例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> myfun2 = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">arguments</span>, a, b)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我是箭头函数的外围非箭头函数test'</span>);</span><br><span class="line">    myfun2(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test(<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g27050audjj30e505n3yg.jpg" alt=""></p><p>再说另一个应用场景：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5中获取外围最近函数的arguments的做法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Curry</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arg = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(arg, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Curry(<span class="string">'a'</span>, <span class="string">'b'</span>)(<span class="number">11</span>, <span class="number">22</span>);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ES5中获取外围最近函数的arguments的做法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Curry</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Curry(<span class="string">'a'</span>, <span class="string">'b'</span>)(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><h1 id="this"><a href="#this" class="headerlink" title="this"></a>this</h1><p><strong>内部arguments和this都是由定义时外围最接近一层的非箭头函数的arguments和this决定其值的</strong></p><p>不过有一点不同，对于arguments如果外围没有非箭头函数，使用时是报错，提示arguments未定义；</p><p>而this如果外围没有非箭头函数，使用时不会报错，规定其值为<strong>window</strong>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sum = <span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">sum();<span class="comment">//打印结果为window对象</span></span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//之所以用var定义a是为了把a挂载到window上</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">'outer'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    a: <span class="string">'inner'</span>,</span><br><span class="line">    fn: <span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a); <span class="comment">// 该箭头函数没有外围非箭头函数，this指向window</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.fn();<span class="comment">//如果安装ES5的写法结果时inner，但是结果是outer</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//之所以用var定义a是为了把a挂载到window上</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">'outer'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    a: <span class="string">'inner'</span>,</span><br><span class="line">    fn()&#123;</span><br><span class="line">        test=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.a); <span class="comment">//此时this指向了fn的this也就是obj对象</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.fn()();<span class="comment">//结果为inner</span></span><br></pre></td></tr></table></figure><p><strong>比较实际的一个应用setTimeout：</strong></p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g2715siovcj307h01o3ya.jpg" alt=""></p><p>setTimeout是window对象里的一个方法，其this是指向window的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myObj = &#123;</span><br><span class="line">    ms: <span class="string">'hhhhh'</span>,</span><br><span class="line">    fn()&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.ms)</span><br><span class="line">        &#125;, <span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">myObj.fn();<span class="comment">//输出结果为undefined而非我们想要的hhhhh，因为setTimeout指向的this是window</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//针对上述情况的解决方法</span></span><br><span class="line"><span class="keyword">let</span> myObj = &#123;</span><br><span class="line">    ms: <span class="string">'hhhhh'</span>,</span><br><span class="line">    fn()&#123;</span><br><span class="line">        <span class="keyword">let</span> that = <span class="keyword">this</span>;<span class="comment">//把fn的this赋给that,that此时指向fn的对象myObj</span></span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(that.ms)</span><br><span class="line">        &#125;, <span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">myObj.fn();<span class="comment">//成功输出hhhhh，但是这样太麻烦了，事实上这样的写法就是ES6代码babel后的ES5写法</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用箭头函数直接搞定</span></span><br><span class="line"><span class="keyword">let</span> myObj = &#123;</span><br><span class="line">    ms: <span class="string">'hhhhh'</span>,</span><br><span class="line">    fn()&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">        &#125;, <span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">myObj.fn();<span class="comment">//成功输出hhhhh,利用了箭头函数this为外围非箭头函数fn的this</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsonp实现百度搜索框功能</title>
      <link href="/2019/03/29/jsonp%E5%AE%9E%E7%8E%B0%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E6%A1%86%E5%8A%9F%E8%83%BD.html"/>
      <url>/2019/03/29/jsonp%E5%AE%9E%E7%8E%B0%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E6%A1%86%E5%8A%9F%E8%83%BD.html</url>
      
        <content type="html"><![CDATA[<p>由于ajax的同源策略，我们无法跨域请求数据，但是jsonp技术很好地解决了这个问题。本文利用百度搜索框接口结合jsonp技术实现获取百度关键字数据并完成百度搜索框功能：</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g1jhdx8mg6g30dg08m124.gif" alt=""></p><p><br></p><p>我们可以直接在百度的搜索框上获取到它的接口，比如我们点击百度搜索文本框的时候，在chrome的network里可以看到它向一个url发起了请求，这个url也就是我们所需要的接口</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g1jhovvqxvj311y0hdjso.jpg" alt=""></p><p>把这个url取出来：<a href="https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&amp;json=1&amp;p=3&amp;sid=&amp;req=2&amp;sc=eb&amp;csor=0&amp;cb=jQuery110202521957712722107_1553828892769&amp;_=1553828892771" target="_blank" rel="noopener">https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&amp;json=1&amp;p=3&amp;sid=&amp;req=2&amp;sc=eb&amp;csor=0&amp;cb=jQuery110202521957712722107_1553828892769&amp;_=1553828892771</a></p><p>去除一些我们不需要的参数，最终得到<a href="https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&amp;cb=jQuery110202521957712722107_1553828892769" target="_blank" rel="noopener">https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&amp;cb=jQuery110202521957712722107_1553828892769</a></p><p>其中wd表示我们要搜索的关键字，cb是百度规定的回调函数，我们尝试把wd赋值为汉字“中”，</p><p>即：<a href="https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=中&amp;cb=jQuery110202521957712722107_1553828892769" target="_blank" rel="noopener">https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=中&amp;cb=jQuery110202521957712722107_1553828892769</a></p><p>然后用浏览器打开</p><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/006ttwEMly1g1jht01m2bj30eh064jrl.jpg" alt=""></p><p>可以看到服务器返回了一个函数的调用，jQuery110202521957712722107_1553828892769是函数名字，里面的参数是一段json数据。</p><p>基于这些，我们可以自己写一个jsonp的代码来实现这个功能</p><p><br></p><p>简单的样式：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">    * &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">list-style</span>: none;</span><br><span class="line">        <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">a</span>&#123;  </span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">        <span class="attribute">color</span>: black;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(172, 220, 235);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>&#123;</span><br><span class="line">        <span class="attribute">color</span>: black;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">        <span class="attribute">margin-left</span>: -<span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">200px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">input</span> &#123;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">34px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">ul</span> &#123;</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">    &lt;div class="wrapper"&gt;</span><br><span class="line">        &lt;input type="text"&gt;</span><br><span class="line">        &lt;<span class="selector-tag">ul</span>&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> &lt;/body&gt;</span><br></pre></td></tr></table></figure><p><br></p><p>关键的jsonp代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">        oUl = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'ul'</span>)[<span class="number">0</span>];</span><br><span class="line">        oInput = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'input'</span>)[<span class="number">0</span>];</span><br><span class="line">        oInput.oninput = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> value = <span class="keyword">this</span>.value;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> oScript = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">            oScript.src = <span class="string">"https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd="</span> + value + <span class="string">"&amp;cb=doJson"</span>;</span><br><span class="line">            <span class="built_in">document</span>.body.appendChild(oScript);</span><br><span class="line">            <span class="built_in">document</span>.body.removeChild(oScript);<span class="comment">//用完就删，拔吊无情</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">doJson</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> s = data.s;</span><br><span class="line">            <span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">if</span> (s.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                s.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">ele, index</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(index&lt;<span class="number">5</span>)&#123;</span><br><span class="line">                    <span class="comment">// 只显示5行</span></span><br><span class="line">                    str += (<span class="string">"&lt;li&gt;&lt;a href=https://www.baidu.com/s?wd="</span>+ele+<span class="string">" target=_block&gt;"</span> + ele + <span class="string">"&lt;/a&gt;&lt;/li&gt;"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                oUl.innerHTML = str;</span><br><span class="line">                oUl.style.display = <span class="string">"block"</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                oUl.style.display = <span class="string">"none"</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br><br>（完）<br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jQ.Ajax实现瀑布流相册</title>
      <link href="/2019/03/20/jQ.Ajax%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81%E7%9B%B8%E5%86%8C.html"/>
      <url>/2019/03/20/jQ.Ajax%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81%E7%9B%B8%E5%86%8C.html</url>
      
        <content type="html"><![CDATA[<p>.本文使用jQuery的ajax技术读取数据，为了实现跨域采用了代理的方法。ajax直接访问的url为服务器中的getPics.php文件，在php文件中访问了目标接口<a href="http://www.wookmark.com/api/json/popular" target="_blank" rel="noopener">http://www.wookmark.com/api/json/popular</a></p><p>效果看一下：</p><p><img src="https://github.com/Dunteng/images/blob/master/BlogImages/illustration/006ttwEMgy1g1jzyydu1hg30s60lcqvg.gif?raw=true" alt=""></p><p><br><br><strong>JS核心代码</strong>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 使用立即执行函数（函数自调用）防止全局污染</span></span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> oLi = $(<span class="string">'li'</span>);</span><br><span class="line">    <span class="keyword">var</span> flag = <span class="literal">false</span>;<span class="comment">//起到锁的作用，防止ajax在渲染过程中一直请求数据</span></span><br><span class="line">    getData();</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!flag &amp;&amp; <span class="built_in">window</span>.dataFlag != <span class="string">'[]'</span>) &#123;</span><br><span class="line">            flag = <span class="literal">true</span>;<span class="comment">//上锁</span></span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type: <span class="string">"GET"</span>,</span><br><span class="line">                url: <span class="string">"http://localhost/web/ajax/waterfall_Image/src/getPics.php?cpage="</span> + num,</span><br><span class="line">                success: addDom,</span><br><span class="line">                beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    $(<span class="string">'.loading'</span>).show();</span><br><span class="line">                &#125;,</span><br><span class="line">                error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">'ERROR'</span>);</span><br><span class="line">                &#125;,</span><br><span class="line">                complete: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">window</span>.dataFlag = data.responseText;<span class="comment">//加个dataFlag，用于监测数据是否已经完全取空</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">addDom</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        $(<span class="string">'.loading'</span>).hide();</span><br><span class="line">        <span class="keyword">var</span> dataList = <span class="built_in">JSON</span>.parse(data);</span><br><span class="line">        <span class="built_in">console</span>.log(dataList);</span><br><span class="line">        <span class="keyword">if</span> (dataList.length) &#123;</span><br><span class="line">            dataList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">ele, index</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> iDiv = $(<span class="string">'&lt;div class="item"&gt;&lt;/div&gt;'</span>);</span><br><span class="line">                <span class="keyword">var</span> imgBox = $(<span class="string">"&lt;div class='image'&gt;&lt;/div&gt;"</span>);</span><br><span class="line">                <span class="keyword">var</span> oImg = <span class="keyword">new</span> Image();</span><br><span class="line">                <span class="keyword">var</span> oP = $(<span class="string">'&lt;p&gt;&lt;/p&gt;'</span>);</span><br><span class="line">                oP.text(ele.title);</span><br><span class="line">                oImg.src = ele.preview;</span><br><span class="line">                oImg.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    imgBox.append(oImg);</span><br><span class="line">                    iDiv.append(imgBox).append(oP);</span><br><span class="line">                    <span class="keyword">var</span> index = getMinList(oLi);</span><br><span class="line">                    $(oLi[index]).append(iDiv);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        flag = <span class="literal">false</span>; <span class="comment">//ajax获取并且页面数据渲染完成了，该flag为false，使下次loading时得以继续Ajax请求数据</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getMinList</span>(<span class="params">dom</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> minHeight = <span class="built_in">parseInt</span>($(dom[<span class="number">0</span>]).css(<span class="string">'height'</span>));</span><br><span class="line">        <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; dom.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> height = <span class="built_in">parseInt</span>($(dom[i]).css(<span class="string">'height'</span>));</span><br><span class="line">            <span class="keyword">if</span> (height &lt; minHeight) &#123;</span><br><span class="line">                minHeight = height;</span><br><span class="line">                index = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $(<span class="built_in">window</span>).scroll(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> scrollHeight = $(<span class="built_in">window</span>).scrollTop();</span><br><span class="line">        <span class="keyword">var</span> clientHeight = $(<span class="built_in">window</span>).height();</span><br><span class="line">        <span class="keyword">var</span> minLiH = <span class="built_in">parseInt</span>($(oLi[getMinList(oLi)]).css(<span class="string">'height'</span>));</span><br><span class="line">        <span class="keyword">if</span> (scrollHeight + clientHeight &gt; minLiH) &#123;</span><br><span class="line">            getData();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p><strong>php文件代码：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* getPics.php */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-type:text/html; charset="utf-8"'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">API:</span></span><br><span class="line"><span class="comment">getPics.php</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">参数</span></span><br><span class="line"><span class="comment">cpage : 获取数据的页数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">$cpage = <span class="keyword">isset</span>($_GET[<span class="string">'cpage'</span>]) ? $_GET[<span class="string">'cpage'</span>] : <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">$url = <span class="string">'http://www.wookmark.com/api/json/popular?page='</span> . $cpage;</span><br><span class="line"></span><br><span class="line">$content = file_get_contents($url);</span><br><span class="line">$content = iconv(<span class="string">'gbk'</span>, <span class="string">'utf-8'</span>, $content);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $content;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>拖拽方块记录Cookie</title>
      <link href="/2019/03/16/JS%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Cookie%E6%93%8D%E4%BD%9C.html"/>
      <url>/2019/03/16/JS%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Cookie%E6%93%8D%E4%BD%9C.html</url>
      
        <content type="html"><![CDATA[<p>Cookie是由服务器端生成，发送给User-Agent（一般是浏览器），（服务器告诉浏览器设置一下cookie），浏览器会将Cookie以key/value保存到某个目录下的文本文件内，下次请求同一网站时就发送该Cookie给服务器（前提是浏览器设置为启用cookie）。Cookie就是一个小型文件（浏览器对cookie的内存大小是有限制的——-用来记录一些信息）。</p><p>Cookie实际上主要是web服务器开发人员设置的，前端开发人员较少使用cookie。但是我们得学会简单操作cookie （大概流程如下）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> manageCookie = &#123;</span><br><span class="line">setCookie: <span class="function"><span class="keyword">function</span> (<span class="params">name, value, time</span>) </span>&#123; </span><br><span class="line"><span class="built_in">document</span>.cookie = name+<span class="string">'='</span>+value+<span class="string">';max-age='</span>+time;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>;<span class="comment">//返回manageCookie用于实现链式函数调用</span></span><br><span class="line"> &#125;,</span><br><span class="line"> removeCookie: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.setCookie(name,<span class="string">''</span>,<span class="number">-1</span>) <span class="comment">//直接把max-age设置为负数使之过期，浏览器会自动删除过期cookie</span></span><br><span class="line"> &#125;,</span><br><span class="line"> getCookie: <span class="function"><span class="keyword">function</span>(<span class="params">name, callback</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> allCookieArr = <span class="built_in">document</span>.cookie.split(<span class="string">', '</span>);<span class="comment">//注意用逗号和一个空格来切分cookie值！</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;allCookieArr.length; i++)&#123;</span><br><span class="line"><span class="keyword">var</span> itemCookieArr = allCookieArr[i].split(<span class="string">'='</span>);</span><br><span class="line"><span class="keyword">if</span>(itemCookieArr[<span class="number">0</span>]==name)&#123;</span><br><span class="line">callback(itemCookieArr[<span class="number">1</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>;<span class="comment">//同样也是返回manageCookie实现链式调用</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">callback(<span class="literal">undefined</span>);<span class="comment">//如果循环结束都没有找到name对应的值，则调用undefined</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>;<span class="comment">//返回manageCookie实现链式调用</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">manageCookie</span><br><span class="line">.setCookie(<span class="string">'color'</span>, <span class="string">'red'</span>, <span class="number">10000</span>)</span><br><span class="line">.setCookie(<span class="string">'dunteng'</span>, <span class="string">'great'</span>, <span class="string">'10000000'</span>)</span><br><span class="line">.removeCookie(<span class="string">'color'</span>)</span><br><span class="line">.getCookie(<span class="string">'dunteng'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><br><br></p><p>结合上述核心功能实现一个小demo：鼠标拖拽方块改变其坐标，下次打开页面的时候通过cookie记忆呈现上次离开网页时的方块状态。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"demo"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> oDemo = <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> manageCookie = &#123;</span><br><span class="line">        setCookie: <span class="function"><span class="keyword">function</span> (<span class="params">name, value, data</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// expires</span></span><br><span class="line">            <span class="comment">// var oDate = new Date();</span></span><br><span class="line">            <span class="comment">// oDate.setDate(oDate.getDate() + date);</span></span><br><span class="line">            <span class="comment">// document.cookie = key + '=' + val + ';expires=' + oDate;</span></span><br><span class="line">            </span><br><span class="line">            <span class="built_in">document</span>.cookie = name + <span class="string">'='</span> + value + <span class="string">';max-age='</span> + data; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        removeCookie: <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setCookie(name, <span class="string">''</span>, <span class="number">-1</span>); </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        getCookie: <span class="function"><span class="keyword">function</span> (<span class="params">name, callback</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> allCookieArr = <span class="built_in">document</span>.cookie.split(<span class="string">'; '</span>);</span><br><span class="line">            <span class="keyword">var</span> len = allCookieArr.length;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">                <span class="keyword">var</span> itemCookieArr = allCookieArr[i].split(<span class="string">'='</span>);</span><br><span class="line">                <span class="keyword">if</span>(itemCookieArr[<span class="number">0</span>] == name) &#123;</span><br><span class="line">                    callback(itemCookieArr[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>; </span><br><span class="line">                &#125; </span><br><span class="line">            &#125;</span><br><span class="line">            callback(<span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> drag = &#123;</span><br><span class="line">        init: <span class="function"><span class="keyword">function</span>(<span class="params">dom</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.dom = dom;</span><br><span class="line">            <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">this</span>.bindEvent();</span><br><span class="line">            manageCookie.getCookie(<span class="string">'newLeft'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                </span><br><span class="line">                _this.dom.style.left = data + <span class="string">'px'</span>;</span><br><span class="line">            &#125;).getCookie(<span class="string">'newTop'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                _this.dom.style.top = data + <span class="string">'px'</span>;</span><br><span class="line">                <span class="keyword">return</span> data;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        bindEvent: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.dom.onmousedown = <span class="keyword">this</span>.mouseDown.bind(<span class="keyword">this</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        mouseDown: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.onmousemove = <span class="keyword">this</span>.mouseMove.bind(<span class="keyword">this</span>);</span><br><span class="line">            <span class="built_in">document</span>.onmouseup = <span class="keyword">this</span>.mouseUp.bind(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.disY = e.clientY - <span class="keyword">this</span>.dom.offsetTop;</span><br><span class="line">            <span class="keyword">this</span>.disX = e.clientX - <span class="keyword">this</span>.dom.offsetLeft;</span><br><span class="line">        &#125;,</span><br><span class="line">        mouseMove: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.newLeft = e.clientX - <span class="keyword">this</span>.disX;</span><br><span class="line">            <span class="keyword">this</span>.newTop = e.clientY - <span class="keyword">this</span>.disY;</span><br><span class="line">            <span class="keyword">this</span>.dom.style.left = <span class="keyword">this</span>.newLeft + <span class="string">'px'</span>;</span><br><span class="line">            <span class="keyword">this</span>.dom.style.top = <span class="keyword">this</span>.newTop + <span class="string">'px'</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        mouseUp: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.onmousemove = <span class="literal">null</span>;</span><br><span class="line">            <span class="built_in">document</span>.onmouseup = <span class="literal">null</span>;</span><br><span class="line">            manageCookie.setCookie(<span class="string">'newLeft'</span>, <span class="keyword">this</span>.newLeft, <span class="number">10000</span>).setCookie(<span class="string">'newTop'</span>,<span class="keyword">this</span>.newTop, <span class="number">10000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    drag.init(oDemo);</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>（完）<br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>封装Jsonp代码</title>
      <link href="/2019/03/14/%E5%B0%81%E8%A3%85jsonp%E4%BB%A3%E7%A0%81.html"/>
      <url>/2019/03/14/%E5%B0%81%E8%A3%85jsonp%E4%BB%A3%E7%A0%81.html</url>
      
        <content type="html"><![CDATA[<p>jsonp的封装代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonp</span> (<span class="params">url, params, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> funcName = <span class="string">'jsonp_'</span> + <span class="built_in">Date</span>.now() + <span class="built_in">Math</span>.random().toString().substr(<span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tempArr = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> params) &#123;</span><br><span class="line">      <span class="keyword">var</span> value = params[key]</span><br><span class="line">      tempArr.push(key + <span class="string">'='</span> + value)</span><br><span class="line">    &#125;</span><br><span class="line">    params = tempArr.join(<span class="string">'&amp;'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</span><br><span class="line">  script.src = url + <span class="string">'?'</span> + params + <span class="string">'&amp;callback='</span> + funcName</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(script)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>[funcName] = <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    callback(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span> <span class="built_in">window</span>[funcName]</span><br><span class="line">    <span class="built_in">document</span>.body.removeChild(script)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">jsonp(<span class="string">'http://localhost/jsonp/server.php'</span>, &#123; <span class="attr">id</span>: <span class="number">123</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">jsonp(<span class="string">'http://localhost/jsonp/server.php'</span>, &#123; <span class="attr">id</span>: <span class="number">123</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>例子中的server.php代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$conn = mysqli_connect(&apos;localhost&apos;, &apos;root&apos;, &apos;123456&apos;, &apos;demo&apos;);</span><br><span class="line"></span><br><span class="line">$query = mysqli_query($conn, &apos;select * from users&apos;);</span><br><span class="line"></span><br><span class="line">while ($row = mysqli_fetch_assoc($query)) &#123;</span><br><span class="line">  $data[] = $row;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (empty($_GET[&apos;callback&apos;])) &#123;</span><br><span class="line">  header(&apos;Content-Type: application/json&apos;);</span><br><span class="line">  echo json_encode($data);</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 如果客户端采用的是 script 标记对我发送的请求</span><br><span class="line">// 一定要返回一段 JavaScript</span><br><span class="line">header(&apos;Content-Type: application/javascript&apos;);</span><br><span class="line">$result = json_encode($data);</span><br><span class="line"></span><br><span class="line">$callback_name = $_GET[&apos;callback&apos;];</span><br><span class="line"></span><br><span class="line">echo &quot;typeof &#123;$callback_name&#125; === &apos;function&apos; &amp;&amp; &#123;$callback_name&#125;(&#123;$result&#125;)&quot;;</span><br></pre></td></tr></table></figure><p><br><br></p><p>（完）</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优化AJAX的JS封装代码</title>
      <link href="/2019/03/13/%E4%BE%9D%E6%AD%A4%E4%BC%98%E5%8C%96AJAX%E7%9A%84%E5%B0%81%E8%A3%85%E4%BB%A3%E7%A0%81.html"/>
      <url>/2019/03/13/%E4%BE%9D%E6%AD%A4%E4%BC%98%E5%8C%96AJAX%E7%9A%84%E5%B0%81%E8%A3%85%E4%BB%A3%E7%A0%81.html</url>
      
        <content type="html"><![CDATA[<p>为了一步步地理清封装步骤，我打算逐步封装ajax函数的功能，分成了以下6个版本：</p><h2 id="Version-1"><a href="#Version-1" class="headerlink" title="Version 1"></a>Version 1</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ajax</span> (<span class="params">method, url, params</span>) </span>&#123;</span><br><span class="line">      xhr.open(method, url)</span><br><span class="line">      xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>) <span class="comment">//针对post的设置请求头</span></span><br><span class="line"></span><br><span class="line">      params = params || <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">      xhr.send(params)</span><br><span class="line">      xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) <span class="keyword">return</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.responseText)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">ajax(<span class="string">'GET'</span>,<span class="string">'xxx.php'</span>,<span class="string">'id=1'</span>);</span><br><span class="line">ajax(<span class="string">'POST'</span>,<span class="string">'xxx.php'</span>,<span class="string">'key1=value1&amp;key2=value2'</span>);</span><br></pre></td></tr></table></figure><p><strong>说明：</strong> </p><ul><li>未兼容低版本 IE</li><li>这种方法在传参数的时候只能上例所示的格式，无法用json格式；</li><li>当method为get的时候，参数没正确地加在url后面无法起到作用；</li><li>method为get时也是设置了(‘Content-Type’, ‘application/x-www-form-urlencoded’)的请求头，但是这是不必要的。</li><li>把函数的结果写死了，总是console.log(this.responseText)</li></ul><p><br><br></p><h2 id="Version-2"><a href="#Version-2" class="headerlink" title="Version 2"></a>Version 2</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ajax</span> (<span class="params">method, url, params</span>) </span>&#123;</span><br><span class="line">      method = method.toUpperCase() <span class="comment">//统一为大写，避免实参为小写的情况造成下面匹配时出错</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment">//解决XMLHttpRequest在ie6不兼容的问题</span></span><br><span class="line">      <span class="keyword">var</span> xhr = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHttp'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">        </span><br><span class="line">      <span class="keyword">if</span> (method === <span class="string">'GET'</span>) &#123;</span><br><span class="line">        url += <span class="string">'?'</span> + params</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.open(method, url)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> data = <span class="literal">null</span></span><br><span class="line">      <span class="keyword">if</span> (method === <span class="string">'POST'</span>) &#123;</span><br><span class="line">        xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>)</span><br><span class="line">        data = params</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.send(data)</span><br><span class="line">      xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) <span class="keyword">return</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.responseText)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">ajax(<span class="string">'GET'</span>,<span class="string">'xxx.php'</span>,<span class="string">'id=1'</span>);</span><br><span class="line">ajax(<span class="string">'POST'</span>,<span class="string">'xxx.php'</span>,<span class="string">'key1=value1&amp;key2=value2'</span>);</span><br></pre></td></tr></table></figure><p><strong>说明：</strong></p><ul><li>实现了IE低版本的兼容并实现了method各自对应的传参方式</li><li>这种方法在传参数的时候只能上例所示的格式，无法用json格式；</li><li>把函数的结果写死了，总是console.log(this.responseText)</li></ul><p><br><br></p><h2 id="Version-3"><a href="#Version-3" class="headerlink" title="Version 3"></a>Version 3</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ajax</span> (<span class="params">method, url, params</span>) </span>&#123;</span><br><span class="line">      method = method.toUpperCase()</span><br><span class="line">      <span class="keyword">var</span> xhr = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHttp'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 将 object 类型的参数转换为 key=value&amp;key=value</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> tempArr = []</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> params) &#123;</span><br><span class="line">          <span class="keyword">var</span> value = params[key]</span><br><span class="line">          tempArr.push(key + <span class="string">'='</span> + value)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// tempArr =&gt; [ 'key1=value1', 'key2=value2' ]</span></span><br><span class="line">        params = tempArr.join(<span class="string">'&amp;'</span>)</span><br><span class="line">        <span class="comment">// params =&gt; 'key1=value1&amp;key2=value2'</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (method === <span class="string">'GET'</span>) &#123;</span><br><span class="line">        url += <span class="string">'?'</span> + params</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.open(method, url)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> data = <span class="literal">null</span></span><br><span class="line">      <span class="keyword">if</span> (method === <span class="string">'POST'</span>) &#123;</span><br><span class="line">        xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>)</span><br><span class="line">        data = params</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.send(data)</span><br><span class="line">      xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) <span class="keyword">return</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.responseText)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">ajax(<span class="string">'GET'</span>,<span class="string">'xxx.php'</span>,<span class="string">'id=1'</span>);</span><br><span class="line">ajax(<span class="string">'POST'</span>,<span class="string">'xxx.php'</span>,<span class="string">'key1=value1&amp;key2=value2'</span>);</span><br><span class="line">ajax(<span class="string">'GET'</span>, <span class="string">'time.php'</span>, &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;)</span><br><span class="line">ajax(<span class="string">'POST'</span>, <span class="string">'add.php'</span>, &#123; <span class="attr">key1</span>: <span class="string">'value1'</span>, <span class="attr">key2</span>: <span class="string">'value2'</span> &#125;)</span><br></pre></td></tr></table></figure><p><strong>说明：</strong></p><ul><li>弥补了无法使用json传参的缺陷，既能用字符串形式传参也能用json</li><li>仍然把函数结果写死了</li></ul><p><br><br></p><h2 id="尝试在Ajax中return出数据"><a href="#尝试在Ajax中return出数据" class="headerlink" title="尝试在Ajax中return出数据"></a>尝试在Ajax中return出数据</h2><p><img src="https://raw.githubusercontent.com/Dunteng/images/master/BlogImages/illustration/ajaxreturn1.jpg" alt=""></p><p><br><br></p><h2 id="Version-4"><a href="#Version-4" class="headerlink" title="Version 4"></a><del>Version 4</del></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">ajax</span> (<span class="params">method, url, params</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> res = <span class="literal">null</span>  <span class="comment">//用于返回值</span></span><br><span class="line"></span><br><span class="line">      method = method.toUpperCase()</span><br><span class="line">      <span class="keyword">var</span> xhr = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHttp'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 将 object 类型的参数转换为 key=value&amp;key=value</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> tempArr = []</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> params) &#123;</span><br><span class="line">          <span class="keyword">var</span> value = params[key]</span><br><span class="line">          tempArr.push(key + <span class="string">'='</span> + value)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// tempArr =&gt; [ 'key1=value1', 'key2=value2' ]</span></span><br><span class="line">        params = tempArr.join(<span class="string">'&amp;'</span>)</span><br><span class="line">        <span class="comment">// params =&gt; 'key1=value1&amp;key2=value2'</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (method === <span class="string">'GET'</span>) &#123;</span><br><span class="line">        url += <span class="string">'?'</span> + params</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.open(method, url, <span class="literal">false</span>) <span class="comment">//async参数为false，使用同步而非异步</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> data = <span class="literal">null</span></span><br><span class="line">      <span class="keyword">if</span> (method === <span class="string">'POST'</span>) &#123;</span><br><span class="line">        xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>)</span><br><span class="line">        data = params</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) <span class="keyword">return</span></span><br><span class="line">        <span class="comment">// 不应该在封装的函数中主观的处理响应结果</span></span><br><span class="line">        <span class="comment">// console.log(this.responseText)</span></span><br><span class="line">        <span class="comment">// 无法在内部包含的函数中通过 return 给外部函数的调用返回结果</span></span><br><span class="line">        <span class="comment">// return this.responseText</span></span><br><span class="line">        <span class="comment">// 由于异步模式下 这里的代码最后执行 所以不可能在外部通过返回值的方式返回数据</span></span><br><span class="line">        res = <span class="keyword">this</span>.responseText</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      xhr.send(data) <span class="comment">//使用了同步的策略，只能把send（）置于最后</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = ajax(<span class="string">"GET"</span>,<span class="string">"xxx.php"</span>,&#123;<span class="attr">id</span>: <span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">var</span> result2 = ajax(<span class="string">"POST"</span>,<span class="string">"xxx.php"</span>,&#123;<span class="attr">key1</span>: <span class="string">'value1'</span>, <span class="attr">key2</span>: <span class="string">'value2'</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(result);</span><br><span class="line">alert(result2);</span><br></pre></td></tr></table></figure><p>说明：</p><ul><li>函数有返回值，没有把函数写死</li><li>但是使用了同步的策略，这是非常不好的</li></ul><p><br><br></p><h2 id="Version-5"><a href="#Version-5" class="headerlink" title="Version 5"></a>Version 5</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// 封装者</span></span><br><span class="line">  <span class="comment">// =============================</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">ajax</span> (<span class="params">method, url, params, done</span>) </span>&#123;</span><br><span class="line">    method = method.toUpperCase()</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"> &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHttp'</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'object'</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> tempArr = []</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> params) &#123;</span><br><span class="line">        <span class="keyword">var</span> value = params[key]</span><br><span class="line">        tempArr.push(key + <span class="string">'='</span> + value)</span><br><span class="line">      &#125;</span><br><span class="line">      params = tempArr.join(<span class="string">'&amp;'</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (method === <span class="string">'GET'</span>) &#123;</span><br><span class="line">      url += <span class="string">'?'</span> + params</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xhr.open(method, url, <span class="literal">true</span>)<span class="comment">//async默认为true，即为异步策略</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> data = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">if</span> (method === <span class="string">'POST'</span>) &#123;</span><br><span class="line">      xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>)</span><br><span class="line">      data = params</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) <span class="keyword">return</span></span><br><span class="line">      <span class="comment">// 不应该在封装的函数中主观的处理响应结果</span></span><br><span class="line">      <span class="comment">// console.log(this.responseText)</span></span><br><span class="line">      <span class="comment">// 你说我太主观，那么你告诉我应该做什么</span></span><br><span class="line">      done(<span class="keyword">this</span>.responseText)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xhr.send(data)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 调用者</span></span><br><span class="line">  <span class="comment">// ============================</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> onDone = <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ajax(<span class="string">'get'</span>, <span class="string">'time.php'</span>, &#123;&#125;, onDone)</span><br></pre></td></tr></table></figure><p><strong>说明：</strong></p><p><strong>为什么return出来的是undefined？为什么取不出一个正确的return值？</strong>因为Ajax是异步的操作，在获取数据完成之前，就已经执行了return res(计划中获取到的数据)，所以是无法正确return出我们想要的结果的。</p><p>既然取不出一个return值，那么换个思路，使用<strong>回调函数</strong>让封装者替我们实现我们想要的效果.</p><p>使用的是异步策略，在异步的情况下使用回调函数时比较多的。</p><p>但是这段代码还是比较凌乱的</p><p><br><br></p><h2 id="Version-6"><a href="#Version-6" class="headerlink" title="Version 6"></a>Version 6</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajaxFunc</span>(<span class="params">method,url,data,callback,flag</span>)</span>&#123;</span><br><span class="line">flag = flag||<span class="literal">true</span>;<span class="comment">//默认采用异步模式</span></span><br><span class="line">method = method.toUpperCase();</span><br><span class="line"><span class="keyword">var</span> xhr = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHttp'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//当参数以json格式传入时，转化成字符串&amp;格式</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">'object'</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> tempArr = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line"><span class="keyword">var</span> value = data[key]</span><br><span class="line">tempArr.push(key + <span class="string">'='</span> + value)</span><br><span class="line">&#125;</span><br><span class="line">data = tempArr.join(<span class="string">'&amp;'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(method == <span class="string">'GET'</span>)&#123;</span><br><span class="line">url +=(<span class="string">'?'</span>+ data);</span><br><span class="line">xhr.open(method,url,flag);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(method == <span class="string">'POST'</span>)&#123;</span><br><span class="line">xhr.open(method,url,flag);</span><br><span class="line">xhr.setRequestHeader(<span class="string">'Content-type'</span>,<span class="string">'application/x-www-form-urlencoded'</span>);</span><br><span class="line">xhr.send(data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.readyState == <span class="number">4</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.status == <span class="number">200</span>)&#123;</span><br><span class="line">callback(<span class="keyword">this</span>.responseText);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"ERROR!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//测试代码：</span></span><br><span class="line">ajaxFunc(<span class="string">'GET'</span>, <span class="string">'post.php'</span>, <span class="string">""</span>, myfun1, <span class="literal">true</span>);</span><br><span class="line">ajaxFunc(<span class="string">'POST'</span>, <span class="string">'post.php'</span>, <span class="string">"username=jiji&amp;age=450"</span>, myfun2, <span class="literal">true</span>);</span><br><span class="line">ajaxFunc(<span class="string">'POST'</span>, <span class="string">'post.php'</span>, &#123;<span class="attr">username</span>: <span class="string">'jiji'</span>,<span class="attr">age</span>: <span class="number">45</span>&#125;, myfun2, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure><p>这个是Ajax比较像样的封装函数了。</p><p><br><br></p><p>(完)</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>处理机调度与死锁</title>
      <link href="/2019/03/07/03%E5%A4%84%E7%90%86%E6%9C%BA%E8%B0%83%E5%BA%A6%E4%B8%8E%E6%AD%BB%E9%94%81.html"/>
      <url>/2019/03/07/03%E5%A4%84%E7%90%86%E6%9C%BA%E8%B0%83%E5%BA%A6%E4%B8%8E%E6%AD%BB%E9%94%81.html</url>
      
        <content type="html"><![CDATA[<h1 id="1-处理机调度"><a href="#1-处理机调度" class="headerlink" title="1. 处理机调度"></a>1. 处理机调度</h1><h2 id="1-1-概念"><a href="#1-1-概念" class="headerlink" title="1.1 概念"></a>1.1 概念</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qn1rcznjj30yg0iuwsp.jpg" alt=""></p><h2 id="1-2-处理机调度的层级"><a href="#1-2-处理机调度的层级" class="headerlink" title="1.2 处理机调度的层级"></a>1.2 处理机调度的层级</h2><h4 id="高级调度（作业调度）"><a href="#高级调度（作业调度）" class="headerlink" title="高级调度（作业调度）"></a>高级调度（作业调度）</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qn7g121ij30w70ij4di.jpg" alt=""></p><h4 id="中级调度（内存调度）"><a href="#中级调度（内存调度）" class="headerlink" title="中级调度（内存调度）"></a>中级调度（内存调度）</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qnc0pbvlj30wf0ibtoi.jpg" alt=""></p><h4 id="低级调度（进程调度）"><a href="#低级调度（进程调度）" class="headerlink" title="低级调度（进程调度）"></a>低级调度（进程调度）</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qnf09rtjj30yz0j0wt7.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qnglyoguj30vh0eo466.jpg" alt=""></p><h4 id="三者对比"><a href="#三者对比" class="headerlink" title="三者对比"></a>三者对比</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qnnrgywcj30tg0edwqg.jpg" alt=""></p><h1 id="2-进程调度"><a href="#2-进程调度" class="headerlink" title="2. 进程调度"></a>2. 进程调度</h1><h2 id="2-1-进程调度的时机"><a href="#2-1-进程调度的时机" class="headerlink" title="2.1 进程调度的时机"></a>2.1 进程调度的时机</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qnwfh3koj311y0lbqnb.jpg" alt=""></p><h2 id="2-2-进程调度的方式"><a href="#2-2-进程调度的方式" class="headerlink" title="2.2 进程调度的方式"></a>2.2 进程调度的方式</h2><p>抢占式与非抢占式</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qnzipw35j30y60hwk4h.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qo2jvefuj30xs0g37fy.jpg" alt=""></p><h1 id="3-调度算法的评价指标"><a href="#3-调度算法的评价指标" class="headerlink" title="3. 调度算法的评价指标"></a>3. 调度算法的评价指标</h1><h2 id="3-1-CPU利用率"><a href="#3-1-CPU利用率" class="headerlink" title="3.1 CPU利用率"></a>3.1 CPU利用率</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qo86gipvj311y0lbwzf.jpg" alt=""></p><h2 id="3-2-系统吞吐量"><a href="#3-2-系统吞吐量" class="headerlink" title="3.2 系统吞吐量"></a>3.2 系统吞吐量</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qobu3h9gj30tr0etgql.jpg" alt=""></p><h2 id="3-3-周转时间"><a href="#3-3-周转时间" class="headerlink" title="3.3 周转时间"></a>3.3 周转时间</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qog48uogj311y0lbqne.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qogvefzoj311y0lb4c8.jpg" alt=""></p><h2 id="3-4-等待时间"><a href="#3-4-等待时间" class="headerlink" title="3.4 等待时间"></a>3.4 等待时间</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qoospfudj30x00in1dn.jpg" alt=""></p><h2 id="3-5-响应时间"><a href="#3-5-响应时间" class="headerlink" title="3.5 响应时间"></a>3.5 响应时间</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qoq58r6dj30ye06omzt.jpg" alt=""></p><h1 id="4-调度算法"><a href="#4-调度算法" class="headerlink" title="4.调度算法"></a>4.调度算法</h1><h2 id="即可用于作业调度又可用于进程调度的算法："><a href="#即可用于作业调度又可用于进程调度的算法：" class="headerlink" title="即可用于作业调度又可用于进程调度的算法："></a>即可用于作业调度又可用于进程调度的算法：</h2><h2 id="4-1-先来先服务算法（FCFS）"><a href="#4-1-先来先服务算法（FCFS）" class="headerlink" title="4.1  先来先服务算法（FCFS）"></a>4.1  先来先服务算法（FCFS）</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r2jsocr3j311y0lb4ho.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r2npdcghj311y0lbakv.jpg" alt=""></p><h2 id="4-2-短作业优先（SJF）"><a href="#4-2-短作业优先（SJF）" class="headerlink" title="4.2  短作业优先（SJF）"></a>4.2  短作业优先（SJF）</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r2wgvr19j311y0lbww9.jpg" alt=""></p><p>平均等待时间、平均周转时间最少</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r322qnbxj311y0lbws8.jpg" alt=""></p><h2 id="4-3-高响应比优先（HRRN）"><a href="#4-3-高响应比优先（HRRN）" class="headerlink" title="4.3  高响应比优先（HRRN）"></a>4.3  高响应比优先（HRRN）</h2><p> <img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r395uu82j311y0lbh2w.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3adxwd6j311y0lb15a.jpg" alt=""></p><h3 id="三者对比-1"><a href="#三者对比-1" class="headerlink" title="三者对比"></a>三者对比</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3b74deoj311y0lbas1.jpg" alt=""></p><h2 id="4-4-优先级调度算法"><a href="#4-4-优先级调度算法" class="headerlink" title="4.4 优先级调度算法"></a>4.4 优先级调度算法</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3wndj9pj311y0lb16c.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3zgw9pjj311y0lb7lr.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r413z5qnj311y0lb4jn.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r41o2tmlj311y0lbakk.jpg" alt=""></p><h2 id="只用于进程调度的算法"><a href="#只用于进程调度的算法" class="headerlink" title="只用于进程调度的算法"></a>只用于进程调度的算法</h2><h2 id="4-5-轮转时间片算法"><a href="#4-5-轮转时间片算法" class="headerlink" title="4.5 轮转时间片算法"></a>4.5 轮转时间片算法</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3rtvyg0j311y0lbqgr.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3q2z967j311y0lbdz5.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r3swa9ptj311y0lbk3o.jpg" alt=""></p><h2 id="4-6-多级反馈队列调度算法"><a href="#4-6-多级反馈队列调度算法" class="headerlink" title="4.6 多级反馈队列调度算法"></a>4.6 多级反馈队列调度算法</h2><p>过程见视频，较复杂，注意理解<img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r4b6mv8jj311y0lbdvw.jpg" alt=""></p><h1 id="5-死锁"><a href="#5-死锁" class="headerlink" title="5. 死锁"></a>5. 死锁</h1><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>个进程互相等待对方手里的资源，这些资源都没有被释放，导致各进程都阻塞，无法向前推进的现象。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0saev0rp5j311y0lb7ud.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sai40aw1j30wv0d246u.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0saj2o2t7j311y0lb7jh.jpg" alt=""></p><h3 id="死锁的处理"><a href="#死锁的处理" class="headerlink" title="死锁的处理"></a>死锁的处理</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sarh7ddvj30xj0gqqd8.jpg" alt=""></p><h3 id="1-预防死锁"><a href="#1-预防死锁" class="headerlink" title="1. 预防死锁"></a>1. 预防死锁</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sawzwpzsj311y0lb14f.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sazjmbm5j311y0lbn8r.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sb2rxbw0j311y0lbdvr.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sb3dqekvj311y0lb4dn.jpg" alt=""></p><h3 id="2-避免死锁"><a href="#2-避免死锁" class="headerlink" title="2.  避免死锁"></a>2.  避免死锁</h3><p><strong>安全状态：</strong></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sbft08umj31re0u07ah.jpg" alt=""></p><h3 id="银行家算法"><a href="#银行家算法" class="headerlink" title="银行家算法"></a>银行家算法</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sbhm7ixbj311y0lb1e0.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sbky5t6yj30xr0acwk3.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sbzb5dwmj311y0lbdvt.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sbzvasmgj311y0lb49q.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sc188qr7j311y0lbk1r.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sc5w292uj311y0lbx3y.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sc8aran4j311y0lbk1y.jpg" alt=""></p><h3 id="3-死锁的监测与解除"><a href="#3-死锁的监测与解除" class="headerlink" title="3. 死锁的监测与解除"></a>3. 死锁的监测与解除</h3><p>这部分重要，看视频：<a href="https://www.bilibili.com/video/av40376808?p=32" target="_blank" rel="noopener">https://www.bilibili.com/video/av40376808?p=32</a></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0sckz7n0oj311y0lbtjq.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>进程的描述与控制</title>
      <link href="/2019/03/06/02%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%8F%8F%E8%BF%B0%E4%B8%8E%E6%8E%A7%E5%88%B6.html"/>
      <url>/2019/03/06/02%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%8F%8F%E8%BF%B0%E4%B8%8E%E6%8E%A7%E5%88%B6.html</url>
      
        <content type="html"><![CDATA[<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><h2 id="1-前趋图和程序执行"><a href="#1-前趋图和程序执行" class="headerlink" title="1. 前趋图和程序执行"></a>1. 前趋图和程序执行</h2><h3 id="1-1-前趋图"><a href="#1-1-前趋图" class="headerlink" title="1.1 前趋图"></a>1.1 前趋图</h3><p>见课本p32、p33</p><h3 id="1-2-程序顺序执行"><a href="#1-2-程序顺序执行" class="headerlink" title="1.2 程序顺序执行"></a>1.2 程序顺序执行</h3><p>程序执行有固定的时序，</p><p><strong>特征：</strong> 顺序性、可再现性、封闭性</p><h3 id="1-3-程序并发执行"><a href="#1-3-程序并发执行" class="headerlink" title="1.3 程序并发执行"></a>1.3 程序并发执行</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0publkgx4j30q40bewfa.jpg" alt="      "></p><p>与顺序执行的特征相反： 间断性、不可再现性、非封闭性（由资源共享造成）</p><p>结合pdf第9页左右例子理解</p><h2 id="2-进程的描述"><a href="#2-进程的描述" class="headerlink" title="2. 进程的描述"></a>2. 进程的描述</h2><h3 id="2-1-进程的定义与特征"><a href="#2-1-进程的定义与特征" class="headerlink" title="2.1 进程的定义与特征"></a>2.1 进程的定义与特征</h3><h4 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h4><p>是程序的一次执行过程，是进程实体的运行过程，是系统进行资源分配和调度 的一个独立单位。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pw2y75xxj30ya0i6k3r.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pw75wembj30uv0ivtha.jpg" alt=""></p><h4 id="特征："><a href="#特征：" class="headerlink" title="特征："></a>特征：</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pwls8evtj310d0kzk7h.jpg" alt=""></p><h4 id="进程和程序的区别："><a href="#进程和程序的区别：" class="headerlink" title="进程和程序的区别："></a>进程和程序的区别：</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pumkycuaj30ov0d7acu.jpg" alt=""></p><h3 id="2-2-进程的状态及转换"><a href="#2-2-进程的状态及转换" class="headerlink" title="2.2 进程的状态及转换"></a>2.2 进程的状态及转换</h3><h4 id="基本状态："><a href="#基本状态：" class="headerlink" title="基本状态："></a>基本状态：</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0puoshfafj30el0br3z2.jpg" alt=""></p><h4 id="创建状态和终止状态"><a href="#创建状态和终止状态" class="headerlink" title="创建状态和终止状态"></a>创建状态和终止状态</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pwt7tdmbj30zj0k1ne6.jpg" alt=""></p><h3 id="2-3-挂起操作与激活操作"><a href="#2-3-挂起操作与激活操作" class="headerlink" title="2.3 挂起操作与激活操作"></a>2.3 挂起操作与激活操作</h3><p>见书本p38\p39</p><h3 id="2-4-进程控制块PCB"><a href="#2-4-进程控制块PCB" class="headerlink" title="2.4 进程控制块PCB"></a>2.4 进程控制块PCB</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pv2jjpexj30ow1nnqgj.jpg" alt=""></p><h2 id="3-进程控制"><a href="#3-进程控制" class="headerlink" title="3. 进程控制"></a>3. 进程控制</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pwv8sr4dj30yn0jx11q.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0px2pngb0j311y0lbkaj.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0px6rffx3j311y0lc7iw.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pxc7k4t4j311y0lcgzx.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pxlzge2pj311y0lbtt8.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pxny9oswj311y0lbwsi.jpg" alt=""></p><h2 id="4-进程同步"><a href="#4-进程同步" class="headerlink" title="4. 进程同步"></a>4. 进程同步</h2><h3 id="4-1-进程同步（进程的直接制约关系）"><a href="#4-1-进程同步（进程的直接制约关系）" class="headerlink" title="4.1 进程同步（进程的直接制约关系）"></a>4.1 进程同步（进程的直接制约关系）</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r4z2trshj311y0lban2.jpg" alt=""></p><h3 id="4-2-进程互斥（进程的间接制约关系）"><a href="#4-2-进程互斥（进程的间接制约关系）" class="headerlink" title="4.2 进程互斥（进程的间接制约关系）"></a>4.2 进程互斥（进程的间接制约关系）</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r50gtecyj311y0lbk8u.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r5160ahej311y0lbdv0.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r52a2mpvj30sd0fstg7.jpg" alt=""></p><h3 id="4-3-硬件同步机制（进程互斥的硬件方法）"><a href="#4-3-硬件同步机制（进程互斥的硬件方法）" class="headerlink" title="4.3 硬件同步机制（进程互斥的硬件方法）"></a>4.3 硬件同步机制（进程互斥的硬件方法）</h3><h4 id="关中断"><a href="#关中断" class="headerlink" title="关中断"></a>关中断</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0rvfs46pdj311y0lbqe2.jpg" alt=""></p><h4 id="TestAndSet指令"><a href="#TestAndSet指令" class="headerlink" title="TestAndSet指令"></a>TestAndSet指令</h4><p>简称TS指令或TSL指令</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0rvloygu5j311y0lbtox.jpg" alt=""></p><h4 id="Swap指令"><a href="#Swap指令" class="headerlink" title="Swap指令"></a>Swap指令</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0rvnnbwdrj311y0lb17l.jpg" alt=""></p><h3 id="4-4读者-写者问题"><a href="#4-4读者-写者问题" class="headerlink" title="4.4读者-写者问题"></a>4.4读者-写者问题</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r59jvg0nj311y0lbasa.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r5ih7bjqj311y0lb1fj.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0r5t5rjxfj311y0lbqee.jpg" alt=""></p><h3 id="4-5-哲学家进餐问题"><a href="#4-5-哲学家进餐问题" class="headerlink" title="4.5 哲学家进餐问题"></a>4.5 哲学家进餐问题</h3><p><a href="https://www.bilibili.com/video/av40376808?p=20" target="_blank" rel="noopener">https://www.bilibili.com/video/av40376808?p=20</a></p><h3 id="4-6-信号量机制"><a href="#4-6-信号量机制" class="headerlink" title="4.6 信号量机制"></a>4.6 信号量机制</h3><h4 id="整形信号量"><a href="#整形信号量" class="headerlink" title="整形信号量"></a>整形信号量</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s7nzlu76j311y0lbwx0.jpg" alt=""></p><h4 id="记录型信号量"><a href="#记录型信号量" class="headerlink" title="记录型信号量"></a>记录型信号量</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s89nuj9fj311y0la19h.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s7w0at66j311y0lbngk.jpg" alt=""></p><h4 id="信号量机制实现进程互斥"><a href="#信号量机制实现进程互斥" class="headerlink" title="信号量机制实现进程互斥"></a>信号量机制实现进程互斥</h4><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s81qzpn7j311y0lb7oj.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s84ho17hj311y0lbwtw.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s85q4vzbj311y0lbap7.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s86jdp0mj311y0lb4ge.jpg" alt=""></p><h3 id="4-7-生产者消费者问题"><a href="#4-7-生产者消费者问题" class="headerlink" title="4.7 生产者消费者问题"></a>4.7 生产者消费者问题</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8ykmm7nj30ud0jiaga.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8slzfkxj311y0lbtzn.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8twoliuj30xn0560xb.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8uh02lkj311y0lbnlx.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s91zhzvsj311y0lbatk.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s94en3cfj311y0lbh2v.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s95ciaasj311y0lbwr3.jpg" alt=""></p><h2 id="5-管程"><a href="#5-管程" class="headerlink" title="5. 管程"></a>5. 管程</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8at0ft2j311y0lbqdo.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8ccvbmuj30o70ffafx.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8i3pf46j311y0lbneb.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8jct50gj311y0lbncx.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0s8jyzcsoj311y0lb4a3.jpg" alt=""></p><h2 id="6-进程通信"><a href="#6-进程通信" class="headerlink" title="6. 进程通信"></a>6. 进程通信</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pxsey6f2j311y0lbk29.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pxvb7o6tj311y0lbdtv.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pxy26zsij311y0lbh03.jpg" alt=""></p><h2 id="7-线程"><a href="#7-线程" class="headerlink" title="7. 线程"></a>7. 线程</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pydawsr8j311y0lbtro.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pyfqf1d0j30yy0jjqil.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pyitai0jj311y0lbwtz.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pyl12f9qj30re0ksajl.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pyq0moqsj311y0lbdpo.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pypjsb9kj311y0lb47v.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ql8dox1bj30vi0jktjc.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qmlg8cbej30yb0k5aj0.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qmm2uwxrj30zo0k1qcp.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qmn9b6hbj30x40jm7d2.jpg" alt=""></p><h2 id="8-进程、线程和作业的概念区分"><a href="#8-进程、线程和作业的概念区分" class="headerlink" title="8. 进程、线程和作业的概念区分"></a>8. 进程、线程和作业的概念区分</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0qomkpz36j30oq0kygow.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>正则表达式验证密码的强度</title>
      <link href="/2019/03/05/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%AA%8C%E8%AF%81%E5%AF%86%E7%A0%81%E7%9A%84%E5%BC%BA%E5%BA%A6.html"/>
      <url>/2019/03/05/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%AA%8C%E8%AF%81%E5%AF%86%E7%A0%81%E7%9A%84%E5%BC%BA%E5%BA%A6.html</url>
      
        <content type="html"><![CDATA[<p>密码: 数字,字母,特殊符号</p><p>密码: 只有数字- 或者是只有字母,或者是只有特殊符号—1级—弱</p><p>两两组合: 数字和字母, 数字和特殊符号, 字母和特殊符号   —–2级—-中</p><p>三者都有: 数字和字母和特殊符号——3级—–强</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">  #dv&#123;</span><br><span class="line">    width: <span class="number">300</span>px;</span><br><span class="line">    height:<span class="number">200</span>px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left:<span class="number">300</span>px;</span><br><span class="line">    top:<span class="number">100</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">  .strengthLv0 &#123;</span><br><span class="line">    height: <span class="number">6</span>px;</span><br><span class="line">    width: <span class="number">120</span>px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    padding: <span class="number">2</span>px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .strengthLv1 &#123;</span><br><span class="line">    background: red;</span><br><span class="line">    height: <span class="number">6</span>px;</span><br><span class="line">    width: <span class="number">40</span>px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    padding: <span class="number">2</span>px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .strengthLv2 &#123;</span><br><span class="line">    background: orange;</span><br><span class="line">    height: <span class="number">6</span>px;</span><br><span class="line">    width: <span class="number">80</span>px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    padding: <span class="number">2</span>px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .strengthLv3 &#123;</span><br><span class="line">    background: green;</span><br><span class="line">    height: <span class="number">6</span>px;</span><br><span class="line">    width: <span class="number">120</span>px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    padding: <span class="number">2</span>px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;div id="dv"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;label for="pwd"&gt;密码&lt;/</span>label&gt;</span><br><span class="line">  &lt;input type=<span class="string">"text"</span> id=<span class="string">"pwd"</span> maxlength=<span class="string">"16"</span>&gt;<span class="xml"><span class="comment">&lt;!--课外话题--&gt;</span></span></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;em&gt;密码强度：&lt;/em&gt;</span><br><span class="line">    &lt;em id="strength"&gt;&lt;/em&gt;</span><br><span class="line">    &lt;div id="strengthLevel" class="strengthLv0"&gt;&lt;/div&gt;</span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">  <span class="comment">//获取文本框注册键盘抬起事件</span></span><br><span class="line">  my$(<span class="string">"pwd"</span>).onkeyup=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//每次键盘抬起都要获取文本框中的内容,验证文本框中有什么东西,得到一个级别,然后下面的div显示对应的颜色</span></span><br><span class="line">    <span class="comment">//如果密码的长度是小于6的,没有必要判断</span></span><br><span class="line"><span class="comment">//    if(this.value.length&gt;=6)&#123;</span></span><br><span class="line"><span class="comment">//     var lvl= getLvl(this.value);</span></span><br><span class="line"><span class="comment">//      my$("strengthLevel").className="strengthLv"+lvl;</span></span><br><span class="line"><span class="comment">//    &#125;else&#123;</span></span><br><span class="line"><span class="comment">//      my$("strengthLevel").className="strengthLv0";</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    my$(<span class="string">"strengthLevel"</span>).className=<span class="string">"strengthLv"</span>+(<span class="keyword">this</span>.value.length&gt;=<span class="number">6</span>?getLvl(<span class="keyword">this</span>.value) :<span class="number">0</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//给我密码,我返回对应的级别</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getLvl</span>(<span class="params">pwd</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> lvl=<span class="number">0</span>;<span class="comment">//默认是0级</span></span><br><span class="line">    <span class="comment">//密码中是否有数字,或者是字母,或者是特殊符号</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/[0-9]/</span>.test(pwd))&#123;</span><br><span class="line">      lvl++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断密码中有没有字母</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/[a-zA-Z]/</span>.test(pwd))&#123;</span><br><span class="line">      lvl++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断密码中有没有特殊符号</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="regexp">/[^0-9a-zA-Z_]/</span>.test(pwd))&#123;</span><br><span class="line">      lvl++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> lvl;<span class="comment">//最小的值是1,最大值是3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/  /</span><span class="regexp">/获取文本框注册键盘抬起事件</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/  my$("pwd").onkeyup=function () &#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    /</span><span class="regexp">/每次键盘抬起都要获取文本框中的内容,验证文本框中有什么东西,得到一个级别,然后下面的div显示对应的颜色</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    /</span><span class="regexp">/如果密码的长度是小于6的,没有必要判断</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    if(this.value.length&gt;=6)&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      var lvl=getLvl(this.value);</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      if(lvl==1)&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/        /</span><span class="regexp">/弱</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/        my$("strengthLevel").className="strengthLv1";</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      &#125;else if(lvl==2)&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/        my$("strengthLevel").className="strengthLv2";</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      &#125;else if(lvl==3)&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/        my$("strengthLevel").className="strengthLv3";</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      &#125;else&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/        my$("strengthLevel").className="strengthLv0";</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      &#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    &#125;else&#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/      my$("strengthLevel").className="strengthLv0";</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    &#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/  &#125;;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/  /</span><span class="regexp">/给我密码,我返回对应的级别</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/  function getLvl(pwd) &#123;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    var lvl=0;/</span><span class="regexp">/默认是0级</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    /</span><span class="regexp">/密码中是否有数字,或者是字母,或者是特殊符号</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/    if(/</span>[<span class="number">0</span><span class="number">-9</span>]/.test(pwd))&#123;</span><br><span class="line"><span class="comment">//      lvl++;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    //判断密码中有没有字母</span></span><br><span class="line"><span class="comment">//    if(/[a-zA-Z]/.test(pwd))&#123;</span></span><br><span class="line"><span class="comment">//      lvl++;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    //判断密码中有没有特殊符号</span></span><br><span class="line"><span class="comment">//    if(/[^0-9a-zA-Z_]/.test(pwd))&#123;</span></span><br><span class="line"><span class="comment">//      lvl++;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    return lvl;//1  3</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 小案例 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>操作系统引言</title>
      <link href="/2019/03/05/01OS%E5%BC%95%E8%A8%80.html"/>
      <url>/2019/03/05/01OS%E5%BC%95%E8%A8%80.html</url>
      
        <content type="html"><![CDATA[<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h2 id="1-操作系统的定义："><a href="#1-操作系统的定义：" class="headerlink" title="1. 操作系统的定义："></a>1. 操作系统的定义：</h2><p>​    操作系统是直接控制和管理计算机硬件、软件资源的最 基本的系统软件，用以方便用户充分、有效的利用这些资源 并增强整个计算机的处理能力</p><h2 id="2-操作系统的目标-amp-作用"><a href="#2-操作系统的目标-amp-作用" class="headerlink" title="2. 操作系统的目标&amp;作用"></a>2. 操作系统的目标&amp;作用</h2><h3 id="2-1-目标："><a href="#2-1-目标：" class="headerlink" title="2.1 目标："></a>2.1 目标：</h3><p><strong>方便性、有效性、</strong>可扩充性、开放性</p><h3 id="2-2-作用："><a href="#2-2-作用：" class="headerlink" title="2.2 作用："></a>2.2 作用：</h3><p>​        1.OS作为用户于计算机硬件系统之间的接口</p><p>​        2.作为计算机资源的管理者</p><p>​        3. 作为扩展机器实现了对计算机资源的抽象    </p><h2 id="3-单批道处理系统"><a href="#3-单批道处理系统" class="headerlink" title="3. 单批道处理系统"></a>3. 单批道处理系统</h2><p>概念：系统对作业的处理都是成批进行的、且内存中始终只保持 一道作业，称为单道批处理系统（simple batch system）。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0pssg5tfej30hx0acn0h.jpg" alt=""><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0psu5ylsqj30la0c8q54.jpg" alt=""></p><h2 id="4-多批道处理系统"><a href="#4-多批道处理系统" class="headerlink" title="4. 多批道处理系统"></a>4. 多批道处理系统</h2><h3 id="4-1-基本概念"><a href="#4-1-基本概念" class="headerlink" title="4.1 基本概念"></a>4.1 基本概念</h3><p>多道：内存中同时存放几个作业； </p><p>宏观上并行运行：都处于运行状态，但都未运行完；</p><p>微观上串行运行：各作业交替使用CPU</p><h3 id="4-2-特征"><a href="#4-2-特征" class="headerlink" title="4.2 特征"></a>4.2 特征</h3><p>多道性、无序性、调度性（作业调度、进程调度）</p><h3 id="4-3-多道批处理系统的优缺点"><a href="#4-3-多道批处理系统的优缺点" class="headerlink" title="4.3 多道批处理系统的优缺点"></a>4.3 多道批处理系统的优缺点</h3><p>优点： 资源利用率高：CPU和内存利用率较高； 作业吞吐量大：单位时间内完成的工作总量大； </p><p>缺点：  用户交互性差：整个作业完成后或中间出错时，才与用户交互，不利于调试和修改； </p><p>​    作业平均周转时间长：短作业的周转时间显著增长</p><h2 id="5-分时系统"><a href="#5-分时系统" class="headerlink" title="5. 分时系统"></a>5. 分时系统</h2><h3 id="5-1-概念："><a href="#5-1-概念：" class="headerlink" title="5.1 概念："></a>5.1 概念：</h3><p>指一台主机上连接了多个带有显示器和键盘 的终端，同时允许多个用户共享主机中的资源，各 个用户都可通过自己的终端以交互方式使用计算机。 </p><h3 id="5-2-分时的目的："><a href="#5-2-分时的目的：" class="headerlink" title="5.2 分时的目的："></a>5.2 分时的目的：</h3><p>多个程序分时共享硬件和软件资源(即： 多任务)。多个用户分享使用同一台计算机(即：多用户) 。 </p><h3 id="5-3-分时的定义："><a href="#5-3-分时的定义：" class="headerlink" title="5.3 分时的定义："></a>5.3 分时的定义：</h3><p>把计算机的系统资源（尤其是CPU时间） 进行时间上的分割，每个时间段称为一个时间片 （time slice），每个用户依次轮流使用时间片。</p><h2 id="6-批处理系统和分时系统的区别"><a href="#6-批处理系统和分时系统的区别" class="headerlink" title="6. 批处理系统和分时系统的区别"></a>6. 批处理系统和分时系统的区别</h2><h3 id="6-1-批处理系统"><a href="#6-1-批处理系统" class="headerlink" title="6.1 批处理系统"></a>6.1 批处理系统</h3><p>从字面上理解，就是一批一批的处理任务的一种系统，严格的定义，就是指<strong>用户将一批作业提交给操作系统后就不再干预，由操作系统控制它们自动运行</strong>。这种采用批量处理作业技术的操作系统称为批处理操作系统。简单地理解就是我手中有一大堆作业（相当一个程序）要运行，我一个一个的放入内存中执行效率会很慢，因为我要人为的去装载程序（早期的机器会把程序写到磁带中，然后人为地放到专门处理程序的机器中），所以我一次性放一批的作业，让操作系统自己去运行它，而我不需要干涉，这样我就省了很多力气 ，如下图 </p><p><img src="https://img-blog.csdn.net/20170329153105707?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzAxMzc2MTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p><h3 id="6-2-分时系统"><a href="#6-2-分时系统" class="headerlink" title="6.2 分时系统"></a>6.2 分时系统</h3><p>分时操作系统：“分时”的含义是指多个用户使用同一台计算机，多个程序分时（分时间片）共享硬件和软件资源。分时操作系统是指在一台主机上连接多个带有显示器和键盘的终端，同时允许多个用户通过主机的终端，以交互方式使用计算机，共享主机中的资源。，<strong>分时操作系统将CPU的时间划分成若干个片段，称为时间片</strong>，操作系统以时间片为单位，轮流为每个终端用户服务 ，如下图 </p><p><img src="https://img-blog.csdn.net/20170329152411531?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzAxMzc2MTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p><h3 id="6-3-总结"><a href="#6-3-总结" class="headerlink" title="6.3 总结"></a>6.3 总结</h3><p>  从他们的定义我们大概可以总结出：<br>批处理系统没有人机交互，而分时系统允许多个用户同时使用<br>批处理系统中允许程序长时间地占用CPU，而分时系统不允许</p><p>多道程序按不按时间片来分配时间 多道程序没有时间片的概念  </p><h2 id="7-操作系统的基本特征"><a href="#7-操作系统的基本特征" class="headerlink" title="7. 操作系统的基本特征"></a>7. 操作系统的基本特征</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ptfk7v13j30l20f7wj4.jpg" alt=""></p><h2 id="8-操作系统的主要功能"><a href="#8-操作系统的主要功能" class="headerlink" title="8. 操作系统的主要功能"></a>8. 操作系统的主要功能</h2><h3 id="8-1-处理机管理"><a href="#8-1-处理机管理" class="headerlink" title="8.1 处理机管理"></a>8.1 处理机管理</h3><p>也可以理解为进程管理</p><p>它又分为 【进程控制】【进程同步】 【进程通信】 【调度】</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ptomyfnqj30mm0vwtjm.jpg" alt=""></p><h3 id="8-2-存储管理"><a href="#8-2-存储管理" class="headerlink" title="8.2 存储管理"></a>8.2 存储管理</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ptpxeuk6j30m70eggpw.jpg" alt=""></p><h3 id="8-3-设备管理"><a href="#8-3-设备管理" class="headerlink" title="8.3 设备管理"></a>8.3 设备管理</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ptslx1sdj30na0esn25.jpg" alt=""></p><h3 id="8-4-文件管理"><a href="#8-4-文件管理" class="headerlink" title="8.4 文件管理"></a>8.4 文件管理</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ptty0c21j30mg0ap76f.jpg" alt=""></p><h3 id="8-5-用户接口"><a href="#8-5-用户接口" class="headerlink" title="8.5 用户接口"></a>8.5 用户接口</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ptzk5gwgj30kd0er0vh.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>继承</title>
      <link href="/2019/03/04/%E7%BB%A7%E6%89%BF.html"/>
      <url>/2019/03/04/%E7%BB%A7%E6%89%BF.html</url>
      
        <content type="html"><![CDATA[<p>继承: 首先继承是一种关系，类(class)与类之间的关系，JS中没有类，但是可以通过构造函数模拟类，然后通过原型来实现继承。继承也是为了数据共享，JS中的继承也是为了实现数据共享。下面介绍三种继承方法。</p><h1 id="通过改变原型指向实现继承"><a href="#通过改变原型指向实现继承" class="headerlink" title="通过改变原型指向实现继承"></a>通过改变原型指向实现继承</h1><p>这是一个Person构造函数，用于构造Person类的对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,sex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name=name;</span><br><span class="line">  <span class="keyword">this</span>.sex=sex;</span><br><span class="line">  <span class="keyword">this</span>.age=age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"人可以吃东西"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Person.prototype.sleep=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"人在睡觉"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Person.prototype.play=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"生活就是不一样的玩法而已"</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这是一个Student构造函数，用于构造Student类的对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,sex，score</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name=name;</span><br><span class="line">  <span class="keyword">this</span>.sex=sex;</span><br><span class="line">  <span class="keyword">this</span>.age=age;</span><br><span class="line">  <span class="keyword">this</span>.score = score;</span><br><span class="line">&#125;</span><br><span class="line">Student.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"吃东西"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Student.prototype.sleep=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"在睡觉"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Student.prototype.play=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"在玩耍"</span>);</span><br><span class="line">&#125;;</span><br><span class="line">Student.prototype.study=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"学习很累很累的哦."</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>可以看见，Student构造函数的很多属性和Person构造函数的属性是一致的，这样就造成了一种冗余。因此，可以让Student继承Person来减少冗余：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">score</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.score=score;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">//改变学生的原型的指向即可</span></span><br><span class="line">   Student.prototype=<span class="keyword">new</span> Person(<span class="string">"小明"</span>,<span class="number">10</span>,<span class="string">"男"</span>);</span><br><span class="line">   Student.prototype.study=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"学习很累很累的哦."</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="number">100</span>);<span class="comment">//创建Student实例</span></span><br></pre></td></tr></table></figure><h1 id="借用构造函数来实现继承"><a href="#借用构造函数来实现继承" class="headerlink" title="借用构造函数来实现继承"></a>借用构造函数来实现继承</h1><p>​    为了数据共享,改变原型指向，做到了继承—通过改变原型指向实现的继承，但是这种方法有个<strong>缺陷</strong>：因为改变原型指向的同时实现继承，直接初始化了属性，继承过来的属性的值都是一样的了，所以。这就是问题，只能重新调用对象的属性进行重新赋值，显然这样太麻烦了。</p><p>​    <strong>解决方案</strong>:继承的时候，不用改变原型的指向，直接调用父级的构造函数的方式来为属性赋值就可以了：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, sex, weight</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.name = name;</span><br><span class="line">     <span class="keyword">this</span>.age = age;</span><br><span class="line">     <span class="keyword">this</span>.sex = sex;</span><br><span class="line">     <span class="keyword">this</span>.weight = weight;</span><br><span class="line">   &#125;</span><br><span class="line">   Person.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">"您好"</span>);</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,sex,weight,score</span>) </span>&#123;</span><br><span class="line">     <span class="comment">//借用构造函数</span></span><br><span class="line">     Person.call(<span class="keyword">this</span>,name,age,sex,weight);</span><br><span class="line">     <span class="keyword">this</span>.score = score;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> stu1 = <span class="keyword">new</span> Student(<span class="string">"小明"</span>,<span class="number">10</span>,<span class="string">"男"</span>,<span class="string">"10kg"</span>,<span class="string">"100"</span>);</span><br><span class="line">   <span class="built_in">console</span>.log(stu1.name, stu1.age, stu1.sex, stu1.weight, stu1.score);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> stu2 = <span class="keyword">new</span> Student(<span class="string">"小红"</span>,<span class="number">20</span>,<span class="string">"女"</span>,<span class="string">"20kg"</span>,<span class="string">"120"</span>);</span><br><span class="line">   <span class="built_in">console</span>.log(stu2.name, stu2.age, stu2.sex, stu2.weight, stu2.score);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> stu3 = <span class="keyword">new</span> Student(<span class="string">"小丽"</span>,<span class="number">30</span>,<span class="string">"保密"</span>,<span class="string">"30kg"</span>,<span class="string">"130"</span>);</span><br><span class="line">   <span class="built_in">console</span>.log(stu3.name, stu3.age, stu3.sex, stu3.weight, stu3.score);</span><br><span class="line"></span><br><span class="line">stu3.sayHi();<span class="comment">//报错！无法调用父级构造函数的方法，因为无法继承方法</span></span><br></pre></td></tr></table></figure><p><strong>事实上，这个方法却带来了另一个缺陷:父级类别中的方法不能继承!!!</strong></p><h1 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h1><p>​    原型实现继承</p><p>​    借用构造函数实现继承</p><p>​    组合继承:原型继承+借用构造函数继承</p><p>​    <strong>组合继承的方法是比较好的一种方式，避免了上述两种方式的缺陷。</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,sex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name=name;</span><br><span class="line">  <span class="keyword">this</span>.age=age;</span><br><span class="line">  <span class="keyword">this</span>.sex=sex;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayHi=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"很高兴见到你"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,sex,score</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//借用构造函数:属性值重复的问题</span></span><br><span class="line">  Person.call(<span class="keyword">this</span>,name,age,sex);</span><br><span class="line">  <span class="keyword">this</span>.score=score;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//改变原型指向----继承</span></span><br><span class="line">Student.prototype=<span class="keyword">new</span> Person();<span class="comment">//不传参数值。</span></span><br><span class="line">Student.prototype.eat=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"吃东西"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> stu=<span class="keyword">new</span> Student(<span class="string">"小黑"</span>,<span class="number">20</span>,<span class="string">"男"</span>,<span class="string">"100分"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu.name,stu.age,stu.sex,stu.score);</span><br><span class="line">stu.sayHi();</span><br><span class="line">stu.eat();</span><br><span class="line"><span class="keyword">var</span> stu2=<span class="keyword">new</span> Student(<span class="string">"小白"</span>,<span class="number">18</span>,<span class="string">"男人"</span>,<span class="string">"85分"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu2.name,stu2.age,stu2.sex,stu2.score);</span><br><span class="line">stu2.sayHi();</span><br><span class="line">stu2.eat();</span><br><span class="line"></span><br><span class="line"><span class="comment">//属性和方法都被继承了</span></span><br></pre></td></tr></table></figure><h1 id="拷贝继承"><a href="#拷贝继承" class="headerlink" title="拷贝继承"></a>拷贝继承</h1><p><strong>拷贝继承：</strong>把一个对象中的属性或者方法直接复制到另一个对象中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.age=<span class="number">10</span>;</span><br><span class="line">Person.prototype.sex=<span class="string">"男"</span>;</span><br><span class="line">Person.prototype.height=<span class="number">100</span>;</span><br><span class="line">Person.prototype.play=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"玩的好开心"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2=&#123;&#125;;</span><br><span class="line"><span class="comment">//Person的构造中有原型prototype,prototype就是一个对象,那么里面,age,sex,height,play都是该对象中的属性或者方法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> Person.prototype)&#123;</span><br><span class="line">  obj2[key]=Person.prototype[key];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.dir(obj2);</span><br><span class="line">obj2.play();</span><br></pre></td></tr></table></figure><p><br><br></p><p>（完）</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS电商上线项目</title>
      <link href="/2019/02/28/dianshang01.html"/>
      <url>/2019/02/28/dianshang01.html</url>
      
        <content type="html"><![CDATA[<h1 id="架构设计"><a href="#架构设计" class="headerlink" title="架构设计"></a>架构设计</h1><ul><li><p>前后端完全分离</p></li><li><p>分层架构</p><p>逻辑层–数据层–工具层</p><p>通过层级的划分来进行系统的解耦，提高系统可扩展性和可维护性</p></li><li><p>模块化</p><p>达到进一步解耦的效果，让系统通过组件的拼装来完成业务的实现。</p><p>模块化的另一个好处：支持团队的并行开发，提高整个团队的效率</p></li></ul><p><br></p><h2 id="技术选型"><a href="#技术选型" class="headerlink" title="技术选型"></a>技术选型</h2><p>HTML+CSS+JavaScript+jQuery（Ajax和DOM操作）</p><p><br></p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ul><li><p>webpack</p><p>对代码进行基于CommonJs的模块化打包集成</p></li><li><p>node.js</p></li><li><p>npm</p></li><li><p>shell脚本</p><p>用于制作自动化脚本发布工具</p></li><li><p>Charles</p><p>用于请求劫持</p></li><li><p>Git</p><p><br></p></li></ul><h1 id="开发安排"><a href="#开发安排" class="headerlink" title="开发安排"></a>开发安排</h1><h2 id="准备部分"><a href="#准备部分" class="headerlink" title="准备部分"></a>准备部分</h2><ul><li>基础框架的搭建<ul><li>双平台的开发环境安装</li><li>git仓库的规范化用法</li><li>webpack脚手架搭建实战</li></ul></li><li><p>通用模块</p><ul><li><p>可高复用工具类设计与封装</p></li><li><p>通用模块设计与独立打包方法</p></li><li><p>高逼格UI开发经验与技巧</p><p><br></p></li></ul></li></ul><h2 id="业务部分"><a href="#业务部分" class="headerlink" title="业务部分"></a>业务部分</h2><ul><li>用户模块<ul><li>数据安全性处理方案</li><li>表单同步/异步验证</li><li>基于JavaScript的小型SPA开发</li></ul></li><li>商品模块<ul><li>jQuery插件模块化改造</li><li>独立组建抽离技巧</li><li>多功能列表开发</li></ul></li><li>购物车模块<ul><li>商品状态随时验证方法</li><li>模块内部方法调用方式</li><li>非form提交时的数据验证</li></ul></li><li>订单模块<ul><li>modal式组件封装思想</li><li>城市级联操作</li><li>复杂表单回填</li></ul></li><li>支付模块<ul><li>支付宝支付功能对接</li><li>支付状态动态监测</li><li>支付成功回执处理</li></ul></li><li>管理后台<ul><li>管理后天实现思路</li><li>React框架及其组件化</li><li>React-Router的使用</li></ul></li><li>访问数据分析<ul><li>PV / UV</li><li>流量来源监控</li><li>用户特征分析</li></ul></li><li>SEO优化<ul><li>SEO原理</li><li>关键词的设计</li><li>SEO监控</li></ul></li><li>线上部署<ul><li>线上服务器环境搭建</li><li>自动化发布脚本编写</li><li>域名规划与nginx配置</li></ul></li><li>可用性监控<ul><li>外部监控原理</li><li>第三方监控的设置</li><li>更高级的监控方式</li></ul></li></ul><p><br></p><h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjkhkl8tj30q90dcdol.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjnb9yh9j30ob09un0z.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjorrwkij30o40bm780.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjpfza5ij30j30a2mzz.jpg" alt=""></p><p><br><br></p><h1 id="架构设计与技术选型"><a href="#架构设计与技术选型" class="headerlink" title="架构设计与技术选型"></a>架构设计与技术选型</h1><h2 id="架构设计-1"><a href="#架构设计-1" class="headerlink" title="架构设计"></a>架构设计</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjtko8v5j30kn08s0uy.jpg" alt=""><br></p><h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjvdkhrzj30k20a80v1.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mjyk0guij30lh0a8aev.jpg" alt=""></p><p>（了解一下这几种模块化方案，本项目采用common JS）</p><p><br><br></p><p>一个web应用的入口式网页页面，而每一个页面都有一个主模块，用来组织各个子模块的逻辑关系，从而形成一个功能完整的页面，我们可以把主模块和各个子模块放在同一层，称之为<strong>逻辑层</strong>，而逻辑层需要和<strong>后端服务</strong>进行数据交互。我们把这些数据交互的方法都划分到一个个的service模块里，我们把这些service模块又划分为一个层，称之为<strong>数据层</strong>，所有的数据交换都要由数据层来和服务器进行，不允许业务模块和服务器直接进行跨层的对接。最后我们需要划分一个最底层的层级，用来提供支持整个系统的通用工具，称之为<strong>工具层</strong>。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mk3e6bomj30n60de7a2.jpg" alt=""></p><p><br></p><h2 id="技术选型-1"><a href="#技术选型-1" class="headerlink" title="技术选型"></a>技术选型</h2><h3 id="需要考虑的东西"><a href="#需要考虑的东西" class="headerlink" title="需要考虑的东西"></a>需要考虑的东西</h3><ul><li><p>软件过程模型</p><ul><li>瀑布模型</li><li>螺旋模型</li><li>敏捷开发</li></ul><p>软件过程的不同所带来的开发过程也不同</p></li><li><p>前后端分离</p><p>分离方式的不同会影响到开发效率</p></li><li><p>构建工具</p></li><li><p>框架</p></li><li><p>代码版本控制软件</p></li><li><p>发布上线的方案</p></li></ul><p><br></p><h3 id="本项目的选择"><a href="#本项目的选择" class="headerlink" title="本项目的选择"></a>本项目的选择</h3><ul><li><p>软件过程：敏捷开发</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mkp9cropj30li0aywi2.jpg" alt=""></p></li><li><p>前后端采用完全分离的方式</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ml71m3xtj30ik0ajmze.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ml5apemcj30if0a0ad2.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ml7o2i58j30jr09amzx.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0ml87sncyj30iu0ayn07.jpg" alt=""></p></li><li><p>框架选型</p><p>使用 jQuery 来进行 Ajax 操作和 DOM 操作</p></li><li><p>构建工具</p><p>webpack</p></li><li><p>版本控制</p><p>Git</p></li><li><p>发布上线</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mlejuhmtj30dl0bzdin.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0mlfpuajvj30dk0c6tbk.jpg" alt=""></p></li></ul><p><br><br></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>使用敏捷开发思想</li><li>前后端完全分离</li><li>commonJs + webpack 实现模块化</li><li>框架使用 jQuery</li><li>版本控制 git</li></ul><p><br><br></p><h1 id="前后端配合方式和数据接口定义"><a href="#前后端配合方式和数据接口定义" class="headerlink" title="前后端配合方式和数据接口定义"></a>前后端配合方式和数据接口定义</h1><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0n3843zlvj30ld0d4jss.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0n39a2hx3j30l90d60un.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>导航细线边框的实现</title>
      <link href="/2019/02/25/%E5%AF%BC%E8%88%AA%E7%BB%86%E7%BA%BF%E8%BE%B9%E6%A1%86%E7%9A%84%E5%AE%9E%E7%8E%B0.html"/>
      <url>/2019/02/25/%E5%AF%BC%E8%88%AA%E7%BB%86%E7%BA%BF%E8%BE%B9%E6%A1%86%E7%9A%84%E5%AE%9E%E7%8E%B0.html</url>
      
        <content type="html"><![CDATA[<p>要实现如下边框：</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0wjv0k2coj30aq08x74s.jpg" alt=""></p><p>一般不要直接给每个盒子加border：1px solid #ccc，这样会使中间的边框线重合变成了2px的线，太粗，不好看。</p><h2 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h2><p>只给盒子的下边框和右边框加border,贴边的消除border</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.nav-item</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*border: 1rpx solid #ccc;/*不建议这样写，这样会造成中间的分割线为2rpx*/</span></span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav-item</span><span class="selector-pseudo">:nth-child(3n)</span>&#123;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">0</span> none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h2><p>使用伪元素加定位</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.nav-item</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav-item</span><span class="selector-pseudo">:nth-child(3n)</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>更好的方式是将上述代码封装起来，以便多次调用：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.bdr</span>&#123;    </span><br><span class="line">    <span class="comment">/* 2.3.子绝父相 */</span></span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.bdr</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="comment">/* 2.1.通过伪元素绘制一像素的右边框 */</span></span><br><span class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#ddd</span>;</span><br><span class="line">    <span class="comment">/* 2.2.定位，不占位置 */</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见浏览器内核</title>
      <link href="/2019/02/20/%E5%B8%B8%E8%A7%81%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E6%A0%B8.html"/>
      <url>/2019/02/20/%E5%B8%B8%E8%A7%81%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E6%A0%B8.html</url>
      
        <content type="html"><![CDATA[<h1 id="常见浏览器内核介绍"><a href="#常见浏览器内核介绍" class="headerlink" title="常见浏览器内核介绍"></a>常见浏览器内核介绍</h1><p>浏览器是网页运行的平台，常用的浏览器有IE、火狐（Firefox）、谷歌（Chrome）、Safari和Opera等。我们平时称为五大浏览器。</p><p><img src="https://ws1.sinaimg.cn/large/006ttwEMgy1g19n2tsnswj30ci08qdj8.jpg" alt=""></p><p>​             </p><blockquote><p>浏览器内核又可以分成两部分：渲染引擎(layout engineer 或者 Rendering Engine)和 JS 引擎。<br>渲染引擎 它负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入 CSS 等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。<br>JS 引擎 则是解析 Javascript 语言，执行 javascript语言来实现网页的动态效果。</p><p>最开始渲染引擎和 JS 引擎并没有区分的很明确，后来 JS 引擎越来越独立，内核就倾向于只指渲染引擎。有一个网页标准计划小组制作了一个 ACID 来测试引擎的兼容性和性能。内核的种类很多，如加上没什么人使用的非商业的免费内核，可能会有10多种，但是常见的浏览器内核可以分这四种：Trident、Gecko、Blink、Webkit。</p></blockquote><h2 id="Trident-IE内核"><a href="#Trident-IE内核" class="headerlink" title="Trident  (IE内核)"></a>Trident  (IE内核)</h2><p>国内很多的双核浏览器的其中一核便是 Trident  /‘traɪdnt/ [三叉戟]，美其名曰 “兼容模式”。</p><p>代表： IE、傲游、世界之窗浏览器、Avant、腾讯TT、猎豹安全浏览器、360极速浏览器、百度浏览器等。</p><p>Window10 发布后，IE 将其内置浏览器命名为 Edge，Edge 最显著的特点就是新内核 EdgeHTML。</p><h2 id="Gecko-firefox"><a href="#Gecko-firefox" class="headerlink" title="Gecko(firefox)"></a>Gecko(firefox)</h2><p>Gecko /‘gɛko/[壁虎]： Mozilla FireFox(火狐浏览器) 采用该内核，Gecko 的特点是代码完全公开，因此，其可开发程度很高，全世界的程序员都可以为其编写代码，增加功能。 可惜这几年已经没落了， 比如 打开速度慢、升级频繁、猪一样的队友flash、神一样的对手chrome。</p><h2 id="webkit-Safari"><a href="#webkit-Safari" class="headerlink" title="webkit(Safari)"></a>webkit(Safari)</h2><p> Safari 是苹果公司开发的浏览器，所用浏览器内核的名称是大名鼎鼎的 WebKit。</p><p> 现在很多人错误地把 webkit 叫做 chrome内核（即使 chrome内核已经是 blink 了），苹果感觉像被别人抢了媳妇，都哭晕再厕所里面了。</p><p> 代表浏览器：傲游浏览器3、 Apple Safari (Win/Mac/iPhone/iPad)、Symbian手机浏览器、Android 默认浏览器，</p><h2 id="Chromium-Blink-chrome"><a href="#Chromium-Blink-chrome" class="headerlink" title="Chromium/Blink(chrome)"></a>Chromium/Blink(chrome)</h2><p>   在 Chromium 项目中研发 Blink 渲染引擎（即浏览器核心），内置于 Chrome 浏览器之中。Blink 其实是 WebKit 的分支。 </p><p>​     大部分国产浏览器最新版都采用Blink内核。二次开发</p><h2 id="Presto-Opera"><a href="#Presto-Opera" class="headerlink" title="Presto(Opera)"></a>Presto(Opera)</h2><p>  Presto（已经废弃） 是挪威产浏览器 opera 的 “前任” 内核，为何说是 “前任”，因为最新的 opera 浏览器早已将之抛弃从而投入到了谷歌怀抱了。  </p><p><br><br></p><p>移动端的浏览器内核主要说的是系统内置浏览器的内核。</p><p>Android手机而言，使用率最高的就是Webkit内核，大部分国产浏览器宣称的自己的内核，基本上也是属于webkit二次开发。</p><p>iOS以及WP7平台上，由于系统原因，系统大部分自带浏览器内核，一般是Safari或者IE内核Trident的</p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>遍历DOM树</title>
      <link href="/2019/02/16/%E9%81%8D%E5%8E%86DOM%E6%A0%91.html"/>
      <url>/2019/02/16/%E9%81%8D%E5%8E%86DOM%E6%A0%91.html</url>
      
        <content type="html"><![CDATA[<p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  第一个函数:给我根节点,我会找到所有的子节点:forDOM(根节点)</span></span><br><span class="line"><span class="comment">//  获取这个根节点的子节点</span></span><br><span class="line"><span class="comment">//  var children=根节点的.children</span></span><br><span class="line"><span class="comment">//  调用第二个函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  第二个函数:给我所有的子节点,我把每个子节点的名字显示出来(children)</span></span><br><span class="line"><span class="comment">//  for(var i=0;i&lt;children.length;i++)&#123;</span></span><br><span class="line"><span class="comment">//    每个子节点</span></span><br><span class="line"><span class="comment">//    var child=children[i];</span></span><br><span class="line"><span class="comment">//    f1(child);给我节点,我显示该节点的名字</span></span><br><span class="line"><span class="comment">//    child是子节点,但是如果child里面还有子节点,此时child就是爹了</span></span><br><span class="line"><span class="comment">//    child.children&amp;&amp;第一个函数(child)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取页面中的根节点--根标签</span></span><br><span class="line">  <span class="keyword">var</span> root=<span class="built_in">document</span>.documentElement;<span class="comment">//html</span></span><br><span class="line">  <span class="comment">//函数遍历DOM树</span></span><br><span class="line">  <span class="comment">//根据根节点,调用fn的函数,显示的是根节点的名字</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">forDOM</span>(<span class="params">root1</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//调用f1,显示的是节点的名字</span></span><br><span class="line">   <span class="comment">// f1(root1);</span></span><br><span class="line">    <span class="comment">//获取根节点中所有的子节点</span></span><br><span class="line">    <span class="keyword">var</span> children=root1.children;</span><br><span class="line">    <span class="comment">//调用遍历所有子节点的函数</span></span><br><span class="line">    forChildren(children);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//给我所有的子节点,我把这个子节点中的所有的子节点显示出来</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">forChildren</span>(<span class="params">children</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//遍历所有的子节点</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;children.length;i++)&#123;</span><br><span class="line">      <span class="comment">//每个子节点</span></span><br><span class="line">      <span class="keyword">var</span> child=children[i];</span><br><span class="line">      <span class="comment">//显示每个子节点的名字</span></span><br><span class="line">      f1(child);</span><br><span class="line">      <span class="comment">//判断child下面有没有子节点,如果还有子节点,那么就继续的遍历</span></span><br><span class="line">      child.children&amp;&amp;forDOM(child);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//函数调用,传入根节点</span></span><br><span class="line">  forDOM(root);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"节点的名字:"</span>+node.nodeName);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><br><br><br><br><br></p><p>( 完 )</p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>css的权重问题</title>
      <link href="/2019/02/02/css%E7%9A%84%E6%9D%83%E9%87%8D%E9%97%AE%E9%A2%98.html"/>
      <url>/2019/02/02/css%E7%9A%84%E6%9D%83%E9%87%8D%E9%97%AE%E9%A2%98.html</url>
      
        <content type="html"><![CDATA[<h2 id="CSS优先级"><a href="#CSS优先级" class="headerlink" title="CSS优先级"></a>CSS优先级</h2><p>定义CSS样式时，经常出现两个或更多规则应用在同一元素上，这时就会出现优先级的问题。</p><p>在考虑权重时，初学者还需要注意一些特殊的情况，具体如下：</p><p>继承样式的权重为0。即在嵌套结构中，不管父元素样式的权重多大，被子元素继承时，他的权重都为0，也就是说子元素定义的样式会覆盖继承来的样式。</p><p>行内样式优先。应用style属性的元素，其行内样式的权重非常高，可以理解为远大于100。总之，他拥有比上面提高的选择器都大的优先级。</p><p>权重相同时，CSS遵循就近原则。也就是说靠近元素的样式具有最大的优先级，或者说排在最后的样式优先级最大。</p><p>CSS定义了一个!important命令，该命令被赋予最大的优先级。也就是说不管权重如何以及样式位置的远近，!important都具有最大优先级。</p><p><br></p><p><br></p><h2 id="计算权重"><a href="#计算权重" class="headerlink" title="计算权重"></a>计算权重</h2><p>关于CSS权重，我们需要一套计算公式来去计算，这个就是 CSS Specificity，我们称为CSS 特性或称非凡性，它是一个衡量CSS值优先级的一个标准 具体规范入如下：</p><p>specificity用一个四位的数 字串(CSS2是三位)来表示，更像四个级别，值从左到右，左面的最大，一级大于一级，数位之间没有进制，级别之间不可超越。 </p><table><thead><tr><th>继承或者* 的贡献值</th><th>0,0,0,0</th></tr></thead><tbody><tr><td>每个元素（标签）贡献值为</td><td>0,0,0,1</td></tr><tr><td>每个类，伪类贡献值为</td><td>0,0,1,0</td></tr><tr><td>每个ID贡献值为</td><td>0,1,0,0</td></tr><tr><td>每个行内样式贡献值</td><td>1,0,0,0</td></tr><tr><td>每个!important贡献值  重要的</td><td>∞ 无穷大</td></tr></tbody></table><p><br></p><p>权重是可以叠加的</p><p> 比如的例子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">div ul  li   ------&gt;      0,0,0,3</span><br><span class="line"></span><br><span class="line">.nav ul li   ------&gt;      0,0,1,2</span><br><span class="line"></span><br><span class="line">a:hover      -----—&gt;      0,0,1,1</span><br><span class="line"></span><br><span class="line">.nav a       ------&gt;      0,0,1,1   </span><br><span class="line"></span><br><span class="line">#nav p       -----&gt;       0,1,0,1</span><br></pre></td></tr></table></figure><p>​   <br></p><p>​      </p><p> 👀 注意： </p><ol><li>数位之间没有进制 比如说： 0,0,0,5 + 0,0,0,5 =0,0,0,10 而不是 0,0, 1, 0， 所以不会存在10个div能赶上一个类选择器的情况。</li><li>继承的 权重是 0  </li></ol><p>总结优先级：</p><ol><li>使用了 !important声明的规则。</li><li>内嵌在 HTML 元素的 style属性里面的声明。</li><li>使用了 ID 选择器的规则。</li><li>使用了类选择器、属性选择器、伪元素和伪类选择器的规则。</li><li>使用了元素选择器的规则。</li><li>只包含一个通用选择器的规则。</li><li>同一类选择器则遵循就近原则。</li></ol><p><br><br></p><h2 id="来练练"><a href="#来练练" class="headerlink" title="来练练"></a>来练练</h2><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19engqkklj30zk0iqtao.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19eo6bptuj30pv0imabj.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19eouc6loj30zk0iq75z.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19epf43toj30t30i20ul.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19epy7amkj30t10h0wfg.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19eqn3wrzj30wm0ipwgo.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19erfs9scj30rw0id75v.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19ersuzobj30qc0fj3zo.jpg" alt=""></p><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19etc9v5pj30t20gmmyn.jpg" alt=""></p><p><br><br></p><h2 id="important"><a href="#important" class="headerlink" title="!important"></a>!important</h2><p>来给一个属性提高权重。这个属性的权重就是无穷大。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type="text/css"&gt;</span><br><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line"><span class="attribute">color</span>:red <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#para1</span>&#123;</span><br><span class="line"><span class="attribute">color</span>:blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.spec</span>&#123;</span><br><span class="line"><span class="attribute">color</span>:green;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>!important需要强调3点：</p><p>1） !important提升的是一个属性，而不是一个选择器</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">color:red !important;   → 只写了这一个!important，所以就字体颜色属性提升权重</span><br><span class="line"><span class="selector-tag">font-size</span>: 100<span class="selector-tag">px</span> ;      → 这条属性没有写!<span class="selector-tag">important</span>，所以没有提升权重</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#para1</span>&#123;</span><br><span class="line"><span class="attribute">color</span>:blue;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.spec</span>&#123;</span><br><span class="line"><span class="attribute">color</span>:green;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2） !important无法提升继承的权重，该是0还是0</p><p>3）!important不影响就近原则</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><img src="https://raw.githubusercontent.com/rockdunteng/imageBed/master/note/blog/006ttwEMgy1g19ez4pgnoj30k20bv3yr.jpg" alt=""></p><p>还有!important这个挂逼注意一下。</p><p>（完）</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS封装动画函数</title>
      <link href="/2019/01/14/JS%E5%B0%81%E8%A3%85%E8%BF%90%E5%8A%A8%E5%87%BD%E6%95%B0.html"/>
      <url>/2019/01/14/JS%E5%B0%81%E8%A3%85%E8%BF%90%E5%8A%A8%E5%87%BD%E6%95%B0.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍JavaScript实现动画效果的封装函数，将从匀速水平移动开始，在此基础上不断增加新功能，如二级标题所示。</p><h2 id="匀速水平移动动画"><a href="#匀速水平移动动画" class="headerlink" title="匀速水平移动动画"></a>匀速水平移动动画</h2><p>这哥们可以用来写轮播图。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0anhy7p0zg30to08qn5g.gif" alt=""></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    * &#123;</span></span><br><span class="line"><span class="undefined">      margin: 0;</span></span><br><span class="line"><span class="undefined">      padding: 0;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    input &#123;</span></span><br><span class="line"><span class="undefined">      margin-top: 20px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    div &#123;</span></span><br><span class="line"><span class="undefined">      margin-top: 30px;</span></span><br><span class="line"><span class="undefined">      width: 200px;</span></span><br><span class="line"><span class="undefined">      height: 100px;</span></span><br><span class="line"><span class="undefined">      background-color: green;</span></span><br><span class="line"><span class="undefined">      position: absolute;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"移动到400px"</span> <span class="attr">id</span>=<span class="string">"btn1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"移动到800px"</span> <span class="attr">id</span>=<span class="string">"btn2"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><p>JavaScript代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);&#125;</span><br><span class="line">  <span class="comment">//div要移动,要脱离文档流---position:absolute</span></span><br><span class="line">  <span class="comment">//如果样式的代码是在style的标签中设置,外面是获取不到</span></span><br><span class="line">  <span class="comment">//如果样式的代码是在style的属性设置,外面是可以获取</span></span><br><span class="line">  <span class="comment">//获取div的当前位置</span></span><br><span class="line">  <span class="comment">//console.log(my$("dv").offsetLeft);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//点击第一个按钮移动到400px</span></span><br><span class="line"></span><br><span class="line">  my$(<span class="string">"btn1"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    animate(my$(<span class="string">"dv"</span>), <span class="number">400</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//点击第二个按钮移动到800px</span></span><br><span class="line"></span><br><span class="line">  my$(<span class="string">"btn2"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    animate(my$(<span class="string">"dv"</span>), <span class="number">800</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">//动画函数---任意一个元素移动到指定的目标位置</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">element, target</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//先清理定时器，防止多次点击产生多个定时器</span></span><br><span class="line">    clearInterval(element.timeId);</span><br><span class="line">    <span class="comment">//一会要清理定时器(只产生一个定时器)</span></span><br><span class="line">    element.timeId = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//获取div的当前的位置</span></span><br><span class="line">      <span class="keyword">var</span> current = element.offsetLeft;<span class="comment">//数字类型,没有px</span></span><br><span class="line">      <span class="comment">//div每次移动多少像素---步数</span></span><br><span class="line">      <span class="keyword">var</span> step = <span class="number">10</span>;</span><br><span class="line">      step = current &lt; target ? step : -step;</span><br><span class="line">      <span class="comment">//每次移动后的距离</span></span><br><span class="line">      current += step;</span><br><span class="line">      <span class="comment">//判断当前移动后的位置是否到达目标位置</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(target - current) &gt; <span class="built_in">Math</span>.abs(step)) &#123;</span><br><span class="line">        element.style.left = current + <span class="string">"px"</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//清理定时器</span></span><br><span class="line">        clearInterval( element.timeId );</span><br><span class="line">        element.style.left = target + <span class="string">"px"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><h2 id="变速水平移动动画（缓动）"><a href="#变速水平移动动画（缓动）" class="headerlink" title="变速水平移动动画（缓动）"></a>变速水平移动动画（缓动）</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0fcx30nygg30uo068n5s.gif" alt=""></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="comment">//点击按钮移动div</span></span><br><span class="line"></span><br><span class="line">  my$(<span class="string">"btn1"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    animate(my$(<span class="string">"dv"</span>), <span class="number">400</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  my$(<span class="string">"btn2"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    animate(my$(<span class="string">"dv"</span>), <span class="number">800</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//匀速动画</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">element, target</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//清理定时器</span></span><br><span class="line">    clearInterval(element.timeId);</span><br><span class="line">    element.timeId = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//获取元素的当前位置</span></span><br><span class="line">      <span class="keyword">var</span> current = element.offsetLeft;</span><br><span class="line">      <span class="comment">//移动的步数</span></span><br><span class="line">      <span class="keyword">var</span> step = (target-current)/<span class="number">10</span>;</span><br><span class="line">      step = step&gt;<span class="number">0</span>?<span class="built_in">Math</span>.ceil(step):<span class="built_in">Math</span>.floor(step);</span><br><span class="line">      current += step;</span><br><span class="line">      element.style.left = current + <span class="string">"px"</span>;</span><br><span class="line">      <span class="keyword">if</span>(current==target) &#123;</span><br><span class="line">        <span class="comment">//清理定时器</span></span><br><span class="line">        clearInterval(element.timeId);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//测试代码:</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"目标位置:"</span>+target+<span class="string">",当前位置:"</span>+current+<span class="string">",每次移动步数:"</span>+step);</span><br><span class="line">    &#125;, <span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><h2 id="封装getStyle"><a href="#封装getStyle" class="headerlink" title="封装getStyle()"></a>封装getStyle()</h2><p>在进一步写动画改变属性函数之前，我们先来封装一个getStyle()函数，一会儿要用到。</p><p>先来看一段css代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   //CSS部分，这个div有个id值"dv"</span><br><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">     <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">     <span class="attribute">background-color</span>: purple;</span><br><span class="line">     <span class="attribute">left</span>:<span class="number">100px</span>;</span><br><span class="line">     <span class="attribute">top</span>:<span class="number">0</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>然后我们想打印出这个div的left值，执行代码console.log(document.getElementById(“dv”).offsetLeft); 我们期望看到控制台输出100，然而并没有。因为没有脱标，只有加上了position: absolute之后才会如愿输出100。</p><p>如果我们就是不想加上position: absolute，又要怎样获取呢？有两种方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//谷歌,火狐支持</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">window</span>.getComputedStyle(my$(<span class="string">"dv"</span>),<span class="literal">null</span>).left);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.getComputedStyle(my$(<span class="string">"dv"</span>),<span class="literal">null</span>)[<span class="string">"left"</span>]);</span><br><span class="line"><span class="comment">//IE8支持</span></span><br><span class="line"><span class="built_in">console</span>.log(my$(<span class="string">"dv"</span>).currentStyle.left);</span><br></pre></td></tr></table></figure><p><br></p><p>接下来时兼容代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">element,attr</span>) </span>&#123;</span><br><span class="line">   <span class="comment">//判断浏览器是否支持这个方法</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.getComputedStyle? <span class="built_in">window</span>.getComputedStyle(element,<span class="literal">null</span>)[attr]:element.currentStyle[attr];</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(getStyle(<span class="built_in">document</span>.getElementById(<span class="string">"dv"</span>),<span class="string">"left"</span>));</span><br></pre></td></tr></table></figure><p>完成。这个函数可以得到一个元素的任意一个样式属性值，字符串类型。</p><p><br></p><p><br></p><h2 id="动画之改变单个属性的值"><a href="#动画之改变单个属性的值" class="headerlink" title="动画之改变单个属性的值"></a>动画之改变单个属性的值</h2><p>在上述动画封装函数的基础上，我们可以进一步写出修改属性值的动画函数，当然这个函数依旧可以实现水平移动动画的效果。</p><p>先看效果：</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0fiu2f7zyg30le0hg464.gif" alt=""></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123;   <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);     &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  my$(<span class="string">"btn1"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//获取div此时left的当前位置,达到目标400</span></span><br><span class="line">   <span class="comment">// animate(my$("dv"),"left",400);</span></span><br><span class="line">    <span class="comment">//获取div此时的宽度,达到目标400</span></span><br><span class="line">    animate(my$(<span class="string">"dv"</span>),<span class="string">"width"</span>,<span class="number">400</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  my$(<span class="string">"btn2"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </span><br><span class="line">      animate(my$(<span class="string">"dv"</span>), <span class="string">"height"</span>, <span class="number">600</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取任意的一个属性的当前的属性值: left---&gt;此时的left属性的值,width---当前的元素的宽</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">element,attr</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//判断浏览器是否支持这个方法</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.getComputedStyle? <span class="built_in">window</span>.getComputedStyle(element,<span class="literal">null</span>)[attr]:element.currentStyle[attr];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//element---元素</span></span><br><span class="line">  <span class="comment">//attr---属性名字，在原来animate的基础上加了一个形参attr</span></span><br><span class="line">  <span class="comment">//target---目标位置</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">element,attr ,target</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//清理定时器</span></span><br><span class="line">    clearInterval(element.timeId);</span><br><span class="line">    element.timeId = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//获取元素的当前位置</span></span><br><span class="line">      <span class="keyword">var</span> current = <span class="built_in">parseInt</span>(getStyle(element,attr));<span class="comment">//getStyle返回字符串类型转为数字类型</span></span><br><span class="line">      <span class="comment">//移动的步数</span></span><br><span class="line">      <span class="keyword">var</span> step = (target-current)/<span class="number">10</span>;</span><br><span class="line">      step = step&gt;<span class="number">0</span>?<span class="built_in">Math</span>.ceil(step):<span class="built_in">Math</span>.floor(step);</span><br><span class="line">      current += step;</span><br><span class="line">      element.style[attr] = current + <span class="string">"px"</span>;</span><br><span class="line">      <span class="keyword">if</span>(current==target) &#123;</span><br><span class="line">        <span class="comment">//清理定时器</span></span><br><span class="line">        clearInterval(element.timeId);</span><br><span class="line">      &#125;</span><br><span class="line">              <span class="comment">//测试代码</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"目标:"</span>+target+<span class="string">",当前:"</span>+current+<span class="string">",每次的移动步数:"</span>+step);</span><br><span class="line">    &#125;, <span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><h2 id="动画之改变多个属性的值"><a href="#动画之改变多个属性的值" class="headerlink" title="动画之改变多个属性的值"></a>动画之改变多个属性的值</h2><p>在上面改变单个属性的函数代码基础上，使用json格式来存储所要的目的状态。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0fkx87bhng30sc0he481.gif" alt=""></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>) </span>&#123;   <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);    &#125;</span><br><span class="line">  <span class="comment">//点击按钮,改变宽度到达一个目标值,高度到达一个目标值</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取任意一个元素的任意一个属性的当前的值---当前属性的位置值</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">element,attr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.getComputedStyle? <span class="built_in">window</span>.getComputedStyle(element,<span class="literal">null</span>)[attr]:element.currentStyle[attr]||<span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">element,json</span>) </span>&#123;</span><br><span class="line">    clearInterval(element.timeId);</span><br><span class="line">    element.timeId=setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> flag=<span class="literal">true</span>;<span class="comment">//默认,假设,全部到达目标</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> attr <span class="keyword">in</span> json)&#123;</span><br><span class="line">        <span class="comment">//获取元素这个属性的当前的值</span></span><br><span class="line">        <span class="keyword">var</span> current=<span class="built_in">parseInt</span>(getStyle(element,attr));</span><br><span class="line">        <span class="comment">//当前的属性对应的目标值</span></span><br><span class="line">        <span class="keyword">var</span> target=json[attr];</span><br><span class="line">        <span class="comment">//移动的步数</span></span><br><span class="line">        <span class="keyword">var</span> step=(target-current)/<span class="number">10</span>;</span><br><span class="line">        step=step&gt;<span class="number">0</span>?<span class="built_in">Math</span>.ceil(step):<span class="built_in">Math</span>.floor(step);</span><br><span class="line">        current+=step;<span class="comment">//移动后的值</span></span><br><span class="line">        element.style[attr]=current+<span class="string">"px"</span>;</span><br><span class="line">        <span class="keyword">if</span>(current!=target)&#123;</span><br><span class="line">          flag=<span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">        <span class="comment">//清理定时器</span></span><br><span class="line">        clearInterval(element.timeId);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//测试代码</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"目标:"</span>+target+<span class="string">",当前:"</span>+current+<span class="string">",每次的移动步数:"</span>+step);</span><br><span class="line">    &#125;,<span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  my$(<span class="string">"btn1"</span>).onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">      animate(my$(<span class="string">"dv"</span>),&#123;<span class="string">"width"</span>:<span class="number">400</span>,<span class="string">"height"</span>:<span class="number">500</span>,<span class="string">"left"</span>:<span class="number">500</span>,<span class="string">"top"</span>:<span class="number">80</span>&#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><h2 id="动画之回调函数"><a href="#动画之回调函数" class="headerlink" title="动画之回调函数"></a>动画之回调函数</h2><p><strong>回调是什么？</strong></p><p><strong>简单讲：</strong> 回调是指在另一个函数执行完成<strong>之后</strong>被调用的函数  ——  因此得名“回调”。</p><p><strong>稍复杂地讲：</strong> 在 JavaScript 中，函数也是对象。因此，函数可以传入函数作为参数，也可以被其他函数返回。这样的函数称为<strong>高阶函数</strong>。被作为参数传入的函数就叫做<strong>回调函数</strong>。</p><p>如果我们想要实现下图中的效果，则需要在动画函数中加入作为参数的回调函数。</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g0fkvg88dxg30sm0h8jvg.gif" alt=""></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取任意一个元素的任意一个属性的当前的值---当前属性的位置值</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">element,attr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.getComputedStyle? <span class="built_in">window</span>.getComputedStyle(element,<span class="literal">null</span>)[attr]:element.currentStyle[attr]||<span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//element---元素</span></span><br><span class="line">  <span class="comment">//json---对象---多个属性及多个目标值</span></span><br><span class="line">  <span class="comment">//fn---函数</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">element,json,fn</span>) </span>&#123;</span><br><span class="line">    clearInterval(element.timeId);</span><br><span class="line">    element.timeId=setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> flag=<span class="literal">true</span>;<span class="comment">//默认,假设,全部到达目标</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> attr <span class="keyword">in</span> json)&#123;</span><br><span class="line">        <span class="comment">//获取元素这个属性的当前的值</span></span><br><span class="line">        <span class="keyword">var</span> current=<span class="built_in">parseInt</span>(getStyle(element,attr));</span><br><span class="line">        <span class="comment">//当前的属性对应的目标值</span></span><br><span class="line">        <span class="keyword">var</span> target=json[attr];</span><br><span class="line">        <span class="comment">//移动的步数</span></span><br><span class="line">        <span class="keyword">var</span> step=(target-current)/<span class="number">10</span>;</span><br><span class="line">        step=step&gt;<span class="number">0</span>?<span class="built_in">Math</span>.ceil(step):<span class="built_in">Math</span>.floor(step);</span><br><span class="line">        current+=step;<span class="comment">//移动后的值</span></span><br><span class="line">        element.style[attr]=current+<span class="string">"px"</span>;</span><br><span class="line">        <span class="keyword">if</span>(current!=target)&#123;</span><br><span class="line">          flag=<span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">        <span class="comment">//清理定时器</span></span><br><span class="line">        clearInterval(element.timeId);</span><br><span class="line">        <span class="comment">//所有的属性到达目标才能使用这个函数,前提是用户传入了这个函数</span></span><br><span class="line">        <span class="keyword">if</span>(fn)&#123;</span><br><span class="line">          fn();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">//测试代码</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"目标:"</span>+target+<span class="string">",当前:"</span>+current+<span class="string">",每次的移动步数:"</span>+step);</span><br><span class="line">    &#125;,<span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  my$(<span class="string">"btn1"</span>).onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> json1=&#123;<span class="string">"width"</span>:<span class="number">400</span>,<span class="string">"height"</span>:<span class="number">500</span>,<span class="string">"left"</span>:<span class="number">500</span>,<span class="string">"top"</span>:<span class="number">80</span>&#125;;</span><br><span class="line">    </span><br><span class="line">    animate(my$(<span class="string">"dv"</span>), json1, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> json2=&#123;<span class="string">"width"</span>:<span class="number">40</span>,<span class="string">"height"</span>:<span class="number">50</span>,<span class="string">"left"</span>:<span class="number">50</span>,<span class="string">"top"</span>:<span class="number">10</span>&#125;;</span><br><span class="line">        animate(my$(<span class="string">"dv"</span>),json2,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> json3=&#123;<span class="string">"width"</span>:<span class="number">450</span>,<span class="string">"height"</span>:<span class="number">500</span>,<span class="string">"left"</span>:<span class="number">550</span>,<span class="string">"top"</span>:<span class="number">80</span>&#125;;</span><br><span class="line">          animate(my$(<span class="string">"dv"</span>),json3);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br><br></p><h2 id="动画之改变透明度与层级"><a href="#动画之改变透明度与层级" class="headerlink" title="动画之改变透明度与层级"></a>动画之改变透明度与层级</h2><p>改变透明度和层级这两部分需要进行if判断，代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123; <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取任意一个元素的任意一个属性的当前的值---当前属性的位置值</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getStyle</span>(<span class="params">element, attr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.getComputedStyle ? <span class="built_in">window</span>.getComputedStyle(element, <span class="literal">null</span>)[attr] : element.currentStyle[attr] || <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">animate</span>(<span class="params">element, json, fn</span>) </span>&#123;</span><br><span class="line">    clearInterval(element.timeId);<span class="comment">//清理定时器</span></span><br><span class="line">    <span class="comment">//定时器,返回的是定时器的id</span></span><br><span class="line">    element.timeId = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> flag = <span class="literal">true</span>;<span class="comment">//默认,假设,全部到达目标</span></span><br><span class="line">      <span class="comment">//遍历json对象中的每个属性还有属性对应的目标值</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> json) &#123;</span><br><span class="line">        <span class="comment">//判断这个属性attr中是不是opacity</span></span><br><span class="line">        <span class="keyword">if</span> (attr == <span class="string">"opacity"</span>) &#123;</span><br><span class="line">          <span class="comment">//获取元素的当前的透明度,当前的透明度放大100倍</span></span><br><span class="line">          <span class="keyword">var</span> current = getStyle(element, attr) * <span class="number">100</span>;</span><br><span class="line">          <span class="comment">//目标的透明度放大100倍</span></span><br><span class="line">          <span class="keyword">var</span> target = json[attr] * <span class="number">100</span>;</span><br><span class="line">          <span class="keyword">var</span> step = (target - current) / <span class="number">10</span>;</span><br><span class="line">          step = step &gt; <span class="number">0</span> ? <span class="built_in">Math</span>.ceil(step) : <span class="built_in">Math</span>.floor(step);</span><br><span class="line">          current += step;<span class="comment">//移动后的值</span></span><br><span class="line">          element.style[attr] = current / <span class="number">100</span>;<span class="comment">//原先放大100倍现在就要缩小100倍</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (attr == <span class="string">"zIndex"</span>) &#123; <span class="comment">//判断这个属性attr中是不是zIndex</span></span><br><span class="line">          <span class="comment">//层级改变就是直接改变这个属性的值</span></span><br><span class="line">          element.style[attr] = json[attr];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//普通的属性</span></span><br><span class="line">          <span class="comment">//获取元素这个属性的当前的值</span></span><br><span class="line">          <span class="keyword">var</span> current = <span class="built_in">parseInt</span>(getStyle(element, attr));</span><br><span class="line">          <span class="comment">//当前的属性对应的目标值</span></span><br><span class="line">          <span class="keyword">var</span> target = json[attr];</span><br><span class="line">          <span class="comment">//移动的步数</span></span><br><span class="line">          <span class="keyword">var</span> step = (target - current) / <span class="number">10</span>;</span><br><span class="line">          step = step &gt; <span class="number">0</span> ? <span class="built_in">Math</span>.ceil(step) : <span class="built_in">Math</span>.floor(step);</span><br><span class="line">          current += step;<span class="comment">//移动后的值</span></span><br><span class="line">          element.style[attr] = current + <span class="string">"px"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//是否到达目标</span></span><br><span class="line">        <span class="keyword">if</span> (current != target) &#123;</span><br><span class="line">          flag = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="comment">//清理定时器</span></span><br><span class="line">        clearInterval(element.timeId);</span><br><span class="line">        <span class="comment">//所有的属性到达目标才能使用这个函数,前提是用户传入了这个函数</span></span><br><span class="line">        <span class="keyword">if</span> (fn) &#123;</span><br><span class="line">          fn();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//测试代码</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"目标:"</span> + target + <span class="string">",当前:"</span> + current + <span class="string">",每次的移动步数:"</span> + step);</span><br><span class="line">    &#125;, <span class="number">20</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//zIndex:1000</span></span><br><span class="line">  <span class="comment">//透明度: 数字类型----小数---放大100倍</span></span><br><span class="line">  my$(<span class="string">"btn1"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> json1 = &#123;<span class="string">"width"</span>: <span class="number">400</span>, <span class="string">"height"</span>: <span class="number">500</span>, <span class="string">"left"</span>: <span class="number">500</span>, <span class="string">"top"</span>: <span class="number">80</span>, <span class="string">"opacity"</span>: <span class="number">0.2</span>&#125;;</span><br><span class="line">    animate(my$(<span class="string">"dv"</span>), json1, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      animate(my$(<span class="string">"dv"</span>), &#123;<span class="string">"width"</span>: <span class="number">40</span>, <span class="string">"height"</span>: <span class="number">50</span>, <span class="string">"left"</span>: <span class="number">0</span>, <span class="string">"top"</span>: <span class="number">0</span>, <span class="string">"opacity"</span>: <span class="number">1</span>, <span class="string">"zIndex"</span>: <span class="number">1000</span>&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br>至此JavaScript封装动画函数实现暂告一段落。<br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 小案例 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS实现全选与全不选</title>
      <link href="/2019/01/13/JS%E5%AE%9E%E7%8E%B0%E5%85%A8%E9%80%89%E4%B8%8E%E5%85%A8%E4%B8%8D%E9%80%89.html"/>
      <url>/2019/01/13/JS%E5%AE%9E%E7%8E%B0%E5%85%A8%E9%80%89%E4%B8%8E%E5%85%A8%E4%B8%8D%E9%80%89.html</url>
      
        <content type="html"><![CDATA[<p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g04wyzjpdag30ay08ghdt.gif" alt=""><br><br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    * &#123;</span></span><br><span class="line"><span class="undefined">      padding: 0;</span></span><br><span class="line"><span class="undefined">      margin: 0;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    .wrap &#123;</span></span><br><span class="line"><span class="undefined">      width: 300px;</span></span><br><span class="line"><span class="undefined">      margin: 100px auto 0;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    table &#123;</span></span><br><span class="line"><span class="undefined">      border-collapse: collapse;</span></span><br><span class="line"><span class="undefined">      border-spacing: 0;</span></span><br><span class="line"><span class="undefined">      border: 1px solid #c0c0c0;</span></span><br><span class="line"><span class="undefined">      width: 300px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    th,</span></span><br><span class="line"><span class="undefined">    td &#123;</span></span><br><span class="line"><span class="undefined">      border: 1px solid #d0d0d0;</span></span><br><span class="line"><span class="undefined">      color: #404060;</span></span><br><span class="line"><span class="undefined">      padding: 10px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    th &#123;</span></span><br><span class="line"><span class="undefined">      background-color: #09c;</span></span><br><span class="line"><span class="undefined">      font: bold 16px "微软雅黑";</span></span><br><span class="line"><span class="undefined">      color: #fff;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    td &#123;</span></span><br><span class="line"><span class="undefined">      font: 14px "微软雅黑";</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    tbody tr &#123;</span></span><br><span class="line"><span class="undefined">      background-color: #f0f0f0;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    tbody tr:hover &#123;</span></span><br><span class="line"><span class="undefined">      cursor: pointer;</span></span><br><span class="line"><span class="undefined">      background-color: #fafafa;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"j_cbAll"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>菜名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span>饭店<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"j_tb"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>红烧肉<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>章鱼饭馆<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>爆炒冰溜子<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>章鱼饭馆<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>油炸榴莲<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>章鱼饭馆<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>大肠刺身<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>章鱼饭馆<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><p>JavaScript代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">        &#125;</span><br><span class="line">   </span><br><span class="line">  <span class="comment">//获取全选的这个复选框</span></span><br><span class="line">  <span class="keyword">var</span> ckAll = my$(<span class="string">"j_cbAll"</span>);</span><br><span class="line">  <span class="comment">//获取tbody中所有的小复选框</span></span><br><span class="line">  <span class="keyword">var</span> cks = my$(<span class="string">"j_tb"</span>).getElementsByTagName(<span class="string">"input"</span>);</span><br><span class="line">  <span class="comment">//点击全选的这个复选框,获取他当前的状态,然后设置tbody中所有复选框的状态</span></span><br><span class="line">  ckAll.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//console.log(this.checked);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cks.length; i++) &#123;</span><br><span class="line">      cks[i].checked = <span class="keyword">this</span>.checked;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取tbody中所有的复选框,分别注册点击事件</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;cks.length;i++)&#123;</span><br><span class="line">    cks[i].onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> flag=<span class="literal">true</span>;<span class="comment">//默认都被选中了</span></span><br><span class="line">      <span class="comment">//判断是否所有的复选框都选中</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;cks.length;j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!cks[j].checked)&#123;</span><br><span class="line">          <span class="comment">//没选中就进来了</span></span><br><span class="line">          flag=<span class="literal">false</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//全选的这个复选框的状态就是flag这个变量的值</span></span><br><span class="line">      ckAll.checked=flag;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 小案例 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自定义属性操作案例</title>
      <link href="/2019/01/13/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C%E6%A1%88%E4%BE%8B.html"/>
      <url>/2019/01/13/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E6%93%8D%E4%BD%9C%E6%A1%88%E4%BE%8B.html</url>
      
        <content type="html"><![CDATA[<p>为了练习一下自定义属性操作，做了一个tab栏切换的demo</p><h2 id="自定义属性操作"><a href="#自定义属性操作" class="headerlink" title="自定义属性操作"></a>自定义属性操作</h2><ul><li>getAttribute() 获取标签行内属性</li><li>setAttribute() 设置标签行内属性</li><li>removeAttribute() 移除标签行内属性</li><li>与element.属性的区别: 上述三个方法用于获取任意的行内属性。</li></ul><h2 id="tab栏切换案例"><a href="#tab栏切换案例" class="headerlink" title="tab栏切换案例"></a>tab栏切换案例</h2><h3 id="别人写的："><a href="#别人写的：" class="headerlink" title="别人写的："></a>别人写的：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head lang=<span class="string">"en"</span>&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;title&gt;<span class="xml"><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    * &#123;</span><br><span class="line">      margin: <span class="number">0</span>;</span><br><span class="line">      padding: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ul &#123;</span><br><span class="line">      list-style-type: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .box &#123;</span><br><span class="line">      width: <span class="number">400</span>px;</span><br><span class="line">      height: <span class="number">300</span>px;</span><br><span class="line">      border: 1px solid #ccc;</span><br><span class="line">      margin: <span class="number">100</span>px auto;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .hd &#123;</span><br><span class="line">      height: <span class="number">45</span>px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .hd span &#123;</span><br><span class="line">      display: inline-block;</span><br><span class="line">      width: <span class="number">90</span>px;</span><br><span class="line">      background-color: pink;</span><br><span class="line">      line-height: <span class="number">45</span>px;</span><br><span class="line">      text-align: center;</span><br><span class="line">      cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .hd span.current &#123;</span><br><span class="line">      background-color: purple;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .bd li &#123;</span><br><span class="line">      height: <span class="number">255</span>px;</span><br><span class="line">      background-color: purple;</span><br><span class="line">      display: none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .bd li.current &#123;</span><br><span class="line">      display: block;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box"</span> id=<span class="string">"box"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"hd"</span>&gt;</span><br><span class="line">    &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"current"</span>&gt;体育&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">    &lt;span&gt;娱乐&lt;/</span>span&gt;</span><br><span class="line">    &lt;span&gt;新闻&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">    &lt;span&gt;综合&lt;/</span>span&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  &lt;div class="bd"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">      &lt;li class="current"&gt;我是体育模块&lt;/</span>li&gt;</span><br><span class="line">      &lt;li&gt;我是娱乐模块&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">      &lt;li&gt;我是新闻模块&lt;/</span>li&gt;</span><br><span class="line">      &lt;li&gt;我是综合模块&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/u</span>l&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;script src=<span class="string">"common.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//获取最外面的div</span></span><br><span class="line">  <span class="keyword">var</span> box=my$(<span class="string">"box"</span>);</span><br><span class="line">  <span class="comment">//获取的是里面的第一个div</span></span><br><span class="line">  <span class="keyword">var</span> hd=box.getElementsByTagName(<span class="string">"div"</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="comment">//获取的是里面的第二个div</span></span><br><span class="line">  <span class="keyword">var</span> bd=box.getElementsByTagName(<span class="string">"div"</span>)[<span class="number">1</span>];</span><br><span class="line">  <span class="comment">//获取所有的li标签</span></span><br><span class="line">  <span class="keyword">var</span> list=bd.getElementsByTagName(<span class="string">"li"</span>);</span><br><span class="line">  <span class="comment">//获取所有的span标签</span></span><br><span class="line">  <span class="keyword">var</span> spans=hd.getElementsByTagName(<span class="string">"span"</span>);</span><br><span class="line">  <span class="comment">//循环遍历的方式,添加点击事件</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;spans.length;i++)&#123;</span><br><span class="line">    <span class="comment">//在点击之前就把索引保存在span标签中</span></span><br><span class="line">    spans[i].setAttribute(<span class="string">"index"</span>,i);</span><br><span class="line">    spans[i].onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//第一件事,所有的span的类样式全部移除</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;spans.length;j++)&#123;</span><br><span class="line">        spans[j].removeAttribute(<span class="string">"class"</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//第二件事,当前被点击的span应用类样式</span></span><br><span class="line">      <span class="keyword">this</span>.className=<span class="string">"current"</span>;</span><br><span class="line">      <span class="comment">//span被点击的时候获取存储的索引值</span></span><br><span class="line">      <span class="comment">//alert(this.getAttribute("index"));</span></span><br><span class="line">      <span class="keyword">var</span> num=<span class="keyword">this</span>.getAttribute(<span class="string">"index"</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//获取所有的li标签,每个li标签先全部隐藏</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>;k&lt;list.length;k++)&#123;</span><br><span class="line">        list[k].removeAttribute(<span class="string">"class"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//当前被点击的span对应的li标签显示</span></span><br><span class="line">      list[num].className=<span class="string">"current"</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><p>效果图：</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g02x9y808rj30d709et8k.jpg" alt=""></p><p><br></p><h3 id="我写的："><a href="#我写的：" class="headerlink" title="我写的："></a>我写的：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;测试草稿&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    * &#123;</span><br><span class="line">        margin: <span class="number">0</span>;</span><br><span class="line">        padding: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .box &#123;</span><br><span class="line">        height: <span class="number">250</span>px;</span><br><span class="line">        width: <span class="number">200</span>px;</span><br><span class="line">        margin:<span class="number">100</span>px auto;</span><br><span class="line">    &#125;</span><br><span class="line">    .hd &#123;</span><br><span class="line">        height: <span class="number">50</span>px;</span><br><span class="line">        width: <span class="number">200</span>px;</span><br><span class="line">        background-color: red;</span><br><span class="line">    &#125;</span><br><span class="line">    .hd ul &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        height: <span class="number">100</span>%;</span><br><span class="line">        widows: <span class="number">100</span>%;</span><br><span class="line">        justify-content:center;</span><br><span class="line">        align-items: center;</span><br><span class="line">    &#125;</span><br><span class="line">    .hd li &#123;</span><br><span class="line">        flex: <span class="number">1</span>;</span><br><span class="line">        text-align: center;</span><br><span class="line">        list-style: none;</span><br><span class="line">    &#125;</span><br><span class="line">    .hd li.current &#123;</span><br><span class="line">        background-color: yellow;</span><br><span class="line">    &#125;</span><br><span class="line">    .bd &#123;</span><br><span class="line">        width: <span class="number">200</span>px;</span><br><span class="line">        height: <span class="number">200</span>px;</span><br><span class="line">        background-color:pink;</span><br><span class="line">    &#125;</span><br><span class="line">    .bd li &#123;</span><br><span class="line">        list-style: none;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line">    .bd li.current &#123;</span><br><span class="line">        display: block;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div class="box" id="box"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div class="hd" &gt;</span></span><br><span class="line"><span class="regexp">            &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">                &lt;li class="current"&gt;魏&lt;/</span>li&gt;</span><br><span class="line">                &lt;li&gt;蜀&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">                &lt;li&gt;吴&lt;/</span>li&gt;</span><br><span class="line">            &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"bd"</span>&gt;</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">                &lt;li <span class="class"><span class="keyword">class</span></span>=<span class="string">"current"</span>&gt;曹操&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">                &lt;li&gt;刘备&lt;/</span>li&gt;</span><br><span class="line">                &lt;li&gt;孙权&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/u</span>l&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> box = my$(<span class="string">"box"</span>);</span><br><span class="line">        <span class="keyword">var</span> hd = box.getElementsByTagName(<span class="string">"div"</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">var</span> bd = box.getElementsByTagName(<span class="string">"div"</span>)[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> hdlist = hd.getElementsByTagName(<span class="string">"li"</span>);</span><br><span class="line">        <span class="keyword">var</span> bdlist = bd.getElementsByTagName(<span class="string">"li"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;hdlist.length; i++)&#123;</span><br><span class="line">            hdlist[i].num = i;<span class="comment">//点语法添加属性</span></span><br><span class="line">            hdlist[i].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;hdlist.length;j++)&#123;</span><br><span class="line">                    hdlist[j].removeAttribute(<span class="string">"class"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.setAttribute(<span class="string">"class"</span>,<span class="string">"current"</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>;k&lt;bdlist.length;k++)&#123;</span><br><span class="line">                    bdlist[k].removeAttribute(<span class="string">"class"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                bdlist[<span class="keyword">this</span>.num].setAttribute(<span class="string">"class"</span>,<span class="string">"current"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure><p><br></p><p>效果图：</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g02xbgn3t7j308108mmwy.jpg" alt=""></p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 小案例 </tag>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>绑定/解绑事件兼容代码</title>
      <link href="/2019/01/13/%E7%BB%91%E5%AE%9A%E8%A7%A3%E7%BB%91%E4%BA%8B%E4%BB%B6%E5%85%BC%E5%AE%B9%E4%BB%A3%E7%A0%81.html"/>
      <url>/2019/01/13/%E7%BB%91%E5%AE%9A%E8%A7%A3%E7%BB%91%E4%BA%8B%E4%BB%B6%E5%85%BC%E5%AE%B9%E4%BB%A3%E7%A0%81.html</url>
      
        <content type="html"><![CDATA[<p>为元素绑定( 多个 )事件(DOM)除了用<strong>对象.onclick=fn</strong>这类的方式（这种方式无法绑定多个事件，如果写了多个事件则会发生覆盖），还有：<br>  1 对象.addEventListener(“事件类型”,事件处理函数,false)–谷歌、火狐和IE9、10、11支持,IE8不支持<br>  2 对象.attachEvent(“有on的事件类型”,事件处理函数)–谷歌不支持,火狐不支持,IE8支持，但是IE11不支持</p><h2 id="addEventListener"><a href="#addEventListener" class="headerlink" title="addEventListener"></a>addEventListener</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//为按钮绑定点击事件</span></span><br><span class="line">  <span class="comment">//参数1:事件的类型---事件的名字,没有on</span></span><br><span class="line">  <span class="comment">//参数2:事件处理函数---函数(命名函数,匿名函数)</span></span><br><span class="line">  <span class="comment">//参数3:布尔类型</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//为同一个元素绑定多个相同的事件--</span></span><br><span class="line"> my$(<span class="string">"btn"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="comment">//my$函数封装了getElementById</span></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"哈哈哈"</span>);</span><br><span class="line"> &#125;,<span class="literal">false</span>);</span><br><span class="line"> my$(<span class="string">"btn"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"嘿嘿嘿"</span>);</span><br><span class="line"> &#125;,<span class="literal">false</span>);</span><br><span class="line"> my$(<span class="string">"btn"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"喵喵喵"</span>);</span><br><span class="line"> &#125;,<span class="literal">false</span>);</span><br><span class="line"> my$(<span class="string">"btn"</span>).addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"呜呜呜"</span>);</span><br><span class="line"> &#125;,<span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p><br></p><p>##attachEvent</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//参数1:事件类型---事件名字，有on</span></span><br><span class="line"><span class="comment">//参数2:事件处理函数---函数(命名函数,匿名函数)</span></span><br><span class="line"></span><br><span class="line">my$(<span class="string">"btn"</span>).attachEvent(<span class="string">"onclick"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"哈哈哈哈哈"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">my$(<span class="string">"btn"</span>).attachEvent(<span class="string">"onclick"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"吼吼吼吼吼"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">my$(<span class="string">"btn"</span>).attachEvent(<span class="string">"onclick"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"嘻嘻嘻嘻嘻"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><br></p><h2 id="两者的区别"><a href="#两者的区别" class="headerlink" title="两者的区别"></a>两者的区别</h2><p>总结绑定事件的区别:addEventListener()和attachEvent()</p><ul><li>相同点: 都可以为元素绑定事件</li><li>不同点:</li><li>1.方法名不一样</li><li>2.参数个数不一样addEventListener三个参数,attachEvent两个参数</li><li>3.addEventListener 谷歌,火狐,IE11支持,IE8不支持；attachEvent 谷歌火狐不支持,IE11不支持,IE8支持</li><li>4.this不同,addEventListener 中的this是当前绑定事件的对象，attachEvent中的this是window</li><li>5.addEventListener中事件的类型(事件的名字)没有on；attachEvent中的事件的类型(事件的名字)有on</li></ul><h2 id="绑定-解绑兼容性代码"><a href="#绑定-解绑兼容性代码" class="headerlink" title="绑定/解绑兼容性代码"></a>绑定/解绑兼容性代码</h2><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g06fa3y3t1g307q0dcdp2.gif" alt=""></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>测试草稿<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"删除"</span> <span class="attr">id</span>=<span class="string">"del"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JavaScript部分：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//绑定事件的兼容代码</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">addEventListener</span>(<span class="params">element,type,fn</span>)</span>&#123;<span class="comment">//调用时此处的fn可以是匿名函数也可以是命名函数的函数名</span></span><br><span class="line">            <span class="keyword">if</span>(element.addEventListener)&#123;</span><br><span class="line">                element.addEventListener(type,fn,<span class="literal">false</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(element.attachEvent)&#123;</span><br><span class="line">                element.attachEvent(<span class="string">"on"</span>+type,fn);<span class="comment">//注意此处的"on"不可省略</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                element[<span class="string">"on"</span>+type]=fn;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//解绑事件的兼容代码</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">removeEventListener</span>(<span class="params">element,type,fnName</span>)</span>&#123;</span><br><span class="line">            <span class="comment">/*注意此处参数必须是函数名而不是匿名函数，匿名函数无效！</span></span><br><span class="line"><span class="comment">            两个人（匿名函数）长得一模一样，都没有名字（函数命名），但是不能说他们就是同一个人（函数）*/</span></span><br><span class="line">            <span class="keyword">if</span>(element.removeEventListener)&#123;</span><br><span class="line">                element.removeEventListener(type,fnName,<span class="literal">false</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(element.detachEvent)&#123;</span><br><span class="line">                element.detachEvent(<span class="string">"on"</span>+type,fnName);<span class="comment">//注意此处的"on"不可省略</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                element[<span class="string">"on"</span>+type]=<span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> pObj = <span class="built_in">document</span>.createElement(<span class="string">"p"</span>);</span><br><span class="line">            pObj.innerText = <span class="string">"来了老弟~"</span>;</span><br><span class="line">            my$(<span class="string">"dv"</span>).appendChild(pObj);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> spanObj = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line">            spanObj.innerText = <span class="string">"好嗨哟~"</span>;</span><br><span class="line">            my$(<span class="string">"dv"</span>).appendChild(spanObj);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        addEventListener(my$(<span class="string">"btn"</span>),<span class="string">"click"</span>,f1);</span><br><span class="line">        addEventListener(my$(<span class="string">"btn"</span>),<span class="string">"click"</span>,f2);</span><br><span class="line"></span><br><span class="line">        my$(<span class="string">"del"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            removeEventListener(my$(<span class="string">"btn"</span>),<span class="string">"click"</span>,f1);</span><br><span class="line">            removeEventListener(my$(<span class="string">"btn"</span>),<span class="string">"click"</span>,f2);</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS搜索框自动提示</title>
      <link href="/2019/01/13/JS%E6%90%9C%E7%B4%A2%E6%A1%86%E8%87%AA%E5%8A%A8%E6%8F%90%E7%A4%BA.html"/>
      <url>/2019/01/13/JS%E6%90%9C%E7%B4%A2%E6%A1%86%E8%87%AA%E5%8A%A8%E6%8F%90%E7%A4%BA.html</url>
      
        <content type="html"><![CDATA[<p><br></p><p>效果展示：</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1g08f80sqi4g30e80bq1kx.gif" alt=""></p><p>html部分：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">  &lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">    <span class="selector-id">#box</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">450px</span>;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">200px</span> auto;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#txt</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">350px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#pop</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">350px</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#pop</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0px</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">      <span class="attribute">list-style-type</span>: none;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#pop</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id="box"&gt;</span><br><span class="line">  &lt;input type="text" id="txt" value=""&gt;</span><br><span class="line">  &lt;input type="button" value="搜索" id="btn"&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p><br>JavaScript：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123; <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setInnerText</span>(<span class="params">element, text</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> element.textContent == <span class="string">"undefined"</span>) &#123;</span><br><span class="line">        element.innerText = text;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        element.textContent = text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> keyWords = [</span><br><span class="line">  <span class="string">"小林才是最纯洁的"</span>, </span><br><span class="line">  <span class="string">"小林才是最帅的"</span>, </span><br><span class="line">  <span class="string">"小明是最胖的"</span>, </span><br><span class="line">  <span class="string">"小明是最高的"</span>, </span><br><span class="line">  <span class="string">"三国是我最喜欢的"</span>, </span><br><span class="line">  <span class="string">"三星note7会爆炸"</span>,</span><br><span class="line">  <span class="string">"苹果好吃"</span>, </span><br><span class="line">  <span class="string">"苹果此次召回还是没有中国"</span>];</span><br><span class="line">  <span class="comment">//获取文本框注册键盘抬起事件</span></span><br><span class="line">  my$(<span class="string">"txt"</span>).onkeyup = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//每一次的键盘抬起都判断页面中有没有这个div</span></span><br><span class="line">    <span class="keyword">if</span>(my$(<span class="string">"dv"</span>))&#123;</span><br><span class="line">      <span class="comment">//删除一次</span></span><br><span class="line">      my$(<span class="string">"box"</span>).removeChild(my$(<span class="string">"dv"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取文本框输入的内容</span></span><br><span class="line">    <span class="keyword">var</span> text = <span class="keyword">this</span>.value;</span><br><span class="line">    <span class="comment">//临时数组--空数组-------&gt;存放对应上的数据</span></span><br><span class="line">    <span class="keyword">var</span> tempArr = [];</span><br><span class="line">    <span class="comment">//把文本框输入的内容和数组中的每个数据对比</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keyWords.length; i++) &#123;</span><br><span class="line">      <span class="comment">//是否是最开始出现的</span></span><br><span class="line">      <span class="keyword">if</span> (keyWords[i].indexOf(text) == <span class="number">0</span>) &#123;</span><br><span class="line">        tempArr.push(keyWords[i]);<span class="comment">//追加</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//如果文本框是空的,临时数组是空的,不用创建div</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.value.length == <span class="number">0</span> || tempArr.length == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">//如果页面中有这个div,删除这个div</span></span><br><span class="line">      <span class="keyword">if</span> (my$(<span class="string">"dv"</span>)) &#123;</span><br><span class="line">        my$(<span class="string">"box"</span>).removeChild(my$(<span class="string">"dv"</span>));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建div,把div加入id为box的div中</span></span><br><span class="line">    <span class="keyword">var</span> dvObj = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">    my$(<span class="string">"box"</span>).appendChild(dvObj);</span><br><span class="line">    dvObj.id = <span class="string">"dv"</span>;</span><br><span class="line">    dvObj.style.width = <span class="string">"350px"</span>;</span><br><span class="line">    <span class="comment">//dvObj.style.height="100px";//肯定是不需要的，由内容撑开</span></span><br><span class="line">    dvObj.style.border = <span class="string">"1px solid green"</span>;</span><br><span class="line">    <span class="comment">//循环遍历临时数组,创建对应的p标签</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; tempArr.length; i++) &#123;</span><br><span class="line">      <span class="comment">//创建p标签</span></span><br><span class="line">      <span class="keyword">var</span> pObj = <span class="built_in">document</span>.createElement(<span class="string">"p"</span>);</span><br><span class="line">      <span class="comment">//把p加到div中</span></span><br><span class="line">      dvObj.appendChild(pObj);</span><br><span class="line">      setInnerText(pObj, tempArr[i]);</span><br><span class="line">      pObj.style.margin = <span class="number">0</span>;</span><br><span class="line">      pObj.style.padding = <span class="number">0</span>;</span><br><span class="line">      pObj.style.cursor = <span class="string">"pointer"</span>;</span><br><span class="line">      pObj.style.marginTop = <span class="string">"5px"</span>;</span><br><span class="line">      pObj.style.marginLeft = <span class="string">"5px"</span>;</span><br><span class="line">      <span class="comment">//鼠标进入</span></span><br><span class="line">      pObj.onmouseover = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.style.backgroundColor = <span class="string">"yellow"</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">//鼠标离开</span></span><br><span class="line">      pObj.onmouseout = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.style.backgroundColor = <span class="string">""</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 小案例 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈js匿名函数</title>
      <link href="/2019/01/12/%E6%B5%85%E8%B0%88js%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0.html"/>
      <url>/2019/01/12/%E6%B5%85%E8%B0%88js%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0.html</url>
      
        <content type="html"><![CDATA[<h2 id="匿名函数与函数表达式"><a href="#匿名函数与函数表达式" class="headerlink" title="匿名函数与函数表达式"></a>匿名函数与函数表达式</h2><p>​    与匿名函数相对的是命名函数——如果函数有名字就是命名函数，反之即为匿名函数。</p><p>​    函数的一般定义方式为函数声明：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> 函数名(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">// 函数体</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用方式为：函数名();</span></span><br></pre></td></tr></table></figure><p>​    函数的另一种定义方式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 函数体</span></span><br><span class="line">&#125;;<span class="comment">//由于是赋值过程所以结尾必须加分号</span></span><br><span class="line"><span class="comment">//调用方式为：fn();</span></span><br><span class="line"><span class="comment">//把一个匿名函数赋给一个变量，即为函数表达式</span></span><br></pre></td></tr></table></figure><h2 id="函数声明与函数表达式"><a href="#函数声明与函数表达式" class="headerlink" title="函数声明与函数表达式"></a>函数声明与函数表达式</h2><p>​    乍一看会觉得函数声明的方式来定义函数比较方便，但是函数声明和函数表达式是存在区别的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"林深时见鹿"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    f1();<span class="comment">//输出“溪午不闻钟”而非“林深时见鹿”，因为f1被下面的函数声明覆盖了</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"溪午不闻钟"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    f1();<span class="comment">//输出“溪午不闻钟”</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//函数表达式</span></span><br><span class="line">    <span class="keyword">var</span> f2 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"林深时见鹿"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    f2();<span class="comment">//输出“林深时见鹿”</span></span><br><span class="line">    f2 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"溪午不闻钟"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    f2();<span class="comment">//输出“溪午不闻钟”</span></span><br><span class="line"><span class="comment">//函数表达式由于是变量赋值的形式，所以不存在函数覆盖的情况</span></span><br></pre></td></tr></table></figure><h2 id="匿名函数自调用"><a href="#匿名函数自调用" class="headerlink" title="匿名函数自调用"></a>匿名函数自调用</h2><p>​    <strong>匿名函数自调用也叫做“立即执行函数”</strong>，在声明的同时立即直接执行，一次性。</p><p>​    一般如以下两种形式：</p><blockquote><p>(function (){}());  W3C建议第一种</p><p>(function (){})();</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数自调用</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"野竹分青霭"</span>);</span><br><span class="line">&#125;());</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"飞泉挂碧峰"</span>)</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p><br></p><p>立即执行函数，执行后即被释放。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//例子1</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">123</span>;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">234</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(a + b);</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">//例子2：带参数</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a,b,c</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a+b+c*<span class="number">2</span>);</span><br><span class="line">&#125;(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//例子3：有返回值</span></span><br><span class="line"><span class="keyword">var</span> num = (<span class="function"><span class="keyword">function</span>(<span class="params">a,b,c,</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> d = a+b+c*<span class="number">2</span><span class="number">-2</span>;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>));</span><br></pre></td></tr></table></figure><h2 id="循环添加事件时不宜使用匿名函数"><a href="#循环添加事件时不宜使用匿名函数" class="headerlink" title="循环添加事件时不宜使用匿名函数"></a>循环添加事件时不宜使用匿名函数</h2><p>在下面这个例子中要显示li的高亮，不推荐写这样的代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//为li添加鼠标进入事件</span><br><span class="line">   liObj.onmouseover = function()&#123;</span><br><span class="line">       this.style.backgroundColor = &quot;red&quot;;</span><br><span class="line">   &#125;;</span><br><span class="line">   //为li添加鼠标离开事件</span><br><span class="line">   liObj.onmouseout = function()&#123;</span><br><span class="line">       this.style.backgroundColor = &quot;&quot;;</span><br><span class="line">   &#125;;</span><br></pre></td></tr></table></figure><p>这种匿名函数的写法不会错，但是每次循环都会产生一个匿名函数占用内存，这样子效率不高，浪费空间。</p><p>所以我们推荐在循环添加事件的时候用命名函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">my$</span>(<span class="params">id</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">var</span> kungfu = [<span class="string">"降龙十八掌"</span>, <span class="string">"黯然销魂掌"</span>, <span class="string">"葵花宝典"</span>, <span class="string">"九阴真经"</span>, <span class="string">"吸星大法"</span>, <span class="string">"如来神掌"</span>, <span class="string">"化骨绵掌"</span>, <span class="string">"玉女心经"</span>, <span class="string">"极乐神功"</span>, <span class="string">"辟邪剑谱"</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">//点击按钮动态的创建列表,把列表加到div中</span></span><br><span class="line">  my$(<span class="string">"btn"</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//创建ul,把ul立刻加入到父级元素div中</span></span><br><span class="line">    <span class="keyword">var</span> ulObj = <span class="built_in">document</span>.createElement(<span class="string">"ul"</span>);</span><br><span class="line">    my$(<span class="string">"dv"</span>).appendChild(ulObj);</span><br><span class="line">    <span class="comment">//动态的创建li,加到ul中</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; kungfu.length; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> liObj = <span class="built_in">document</span>.createElement(<span class="string">"li"</span>);</span><br><span class="line">      <span class="comment">//设置li中间的文字内容</span></span><br><span class="line">      liObj.innerHTML = kungfu[i];</span><br><span class="line">      ulObj.appendChild(liObj);</span><br><span class="line">      <span class="comment">//为li添加鼠标进入事件</span></span><br><span class="line">      liObj.onmouseover = mouseoverHandle;</span><br><span class="line">      <span class="comment">//为li添加鼠标离开事件</span></span><br><span class="line">      liObj.onmouseout = mouseoutHandle;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//此位置.按钮的点击事件的外面</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mouseoverHandle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.style.backgroundColor = <span class="string">"red"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mouseoutHandle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.style.backgroundColor = <span class="string">""</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//如果是循环的方式添加事件,推荐用命名函数</span></span><br><span class="line">  <span class="comment">//如果不是循环的方式添加事件,推荐使用匿名函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字符串小练习</title>
      <link href="/2019/01/09/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B0%8F%E6%A1%88%E4%BE%8B.html"/>
      <url>/2019/01/09/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B0%8F%E6%A1%88%E4%BE%8B.html</url>
      
        <content type="html"><![CDATA[<h2 id="案例一：找到这个字符串中所有的-o-出现的位置"><a href="#案例一：找到这个字符串中所有的-o-出现的位置" class="headerlink" title="案例一：找到这个字符串中所有的 o 出现的位置"></a>案例一：找到这个字符串中所有的 o 出现的位置</h2><p>“hello wod odd ott fbo nhyo”</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"hello wod odd ott fbo nhyo"</span>;</span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//var index = str.indexOf('o',index);</span></span><br><span class="line"><span class="comment">//index++;</span></span><br><span class="line"><span class="keyword">while</span>((index = str.indexOf(<span class="string">'o'</span>,index))!=<span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(index);</span><br><span class="line">    index++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="案例一升级版：找到这个字符串中所有的“你好啊”出现的位置"><a href="#案例一升级版：找到这个字符串中所有的“你好啊”出现的位置" class="headerlink" title="案例一升级版：找到这个字符串中所有的“你好啊”出现的位置"></a>案例一升级版：找到这个字符串中所有的“你好啊”出现的位置</h2><p>“李白你好啊你好啊杜甫说你好啊我也说你好啊”</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"李白你好啊你好啊杜甫说你好啊我也说你好啊"</span>;</span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> key = <span class="string">'你好啊'</span>;</span><br><span class="line"><span class="keyword">while</span>((index = str.indexOf(key,index))!=<span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(index);</span><br><span class="line">    index+=key.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以案例一的代码可以进行一下优化，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"hello wod odd ott fbo nhyo"</span>;</span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> key = <span class="string">'o'</span>;</span><br><span class="line"><span class="keyword">while</span>((index = str.indexOf(key,index))!=<span class="number">-1</span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(index);</span><br><span class="line">    index+=key.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="案例二：找到字符串中每个字符出现了多少次"><a href="#案例二：找到字符串中每个字符出现了多少次" class="headerlink" title="案例二：找到字符串中每个字符出现了多少次"></a>案例二：找到字符串中每个字符出现了多少次</h2><p>我写的臃肿版：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str3 = <span class="string">"whatOareYyouYnoYshaHleiHoHmyHgod"</span>;</span><br><span class="line"><span class="keyword">var</span> length = str3.length;</span><br><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; arr.length; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[j]==str3[i])&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(j == arr.length)&#123;</span><br><span class="line">        arr[arr.length]=str3[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr);</span><br><span class="line"><span class="keyword">var</span> num = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line">    num[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; length; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(str3[j]==arr[i])&#123;</span><br><span class="line">            num[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'字符'</span>+arr[i]+<span class="string">'出现了'</span>+num[i]+<span class="string">'次'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简洁版：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str3 = <span class="string">"whatOareYyouYnoYshaHleiHoHmyHgod"</span>;</span><br><span class="line">  <span class="comment">//第一步:把所有的字母全部变成小写</span></span><br><span class="line">  str3 = str3.toLocaleLowerCase();</span><br><span class="line">  <span class="comment">//第二步:创建一个空对象,目的:把字母作为键,次数作为值</span></span><br><span class="line">  <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="comment">//第三步,遍历字符串,获取每个字母</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str3.length; i++) &#123;</span><br><span class="line">    <span class="comment">//判断obj这个对象中有没有这个字母(字母---键)</span></span><br><span class="line">    <span class="keyword">var</span> key = str3[i];<span class="comment">//每个字母</span></span><br><span class="line">    <span class="keyword">if</span> (obj[key]) &#123;<span class="comment">//判断obj中有没有这个键</span></span><br><span class="line">      <span class="comment">//对象中有这个字母了</span></span><br><span class="line">      obj[key]++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//对象中没有这个字母,那就把字母加到对象中,并且给这个字母一个出现的次数,默认1次</span></span><br><span class="line">      obj[key] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//遍历对象,显示每个字母的次数</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key+<span class="string">"这个字母出现了"</span>+obj[key]+<span class="string">"次"</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 小案例 </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript中的值传递和地址传递（引用传递）</title>
      <link href="/2019/01/07/JavaScript%E4%B8%AD%E7%9A%84%E5%80%BC%E4%BC%A0%E9%80%92%E5%92%8C%E5%9C%B0%E5%9D%80%E4%BC%A0%E9%80%92%EF%BC%88%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92%EF%BC%89.html"/>
      <url>/2019/01/07/JavaScript%E4%B8%AD%E7%9A%84%E5%80%BC%E4%BC%A0%E9%80%92%E5%92%8C%E5%9C%B0%E5%9D%80%E4%BC%A0%E9%80%92%EF%BC%88%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92%EF%BC%89.html</url>
      
        <content type="html"><![CDATA[<h2 id="简单类型和复杂类型"><a href="#简单类型和复杂类型" class="headerlink" title="简单类型和复杂类型"></a>简单类型和复杂类型</h2><p>我们先来理清一下几种数据类型。原始的数据类型就有： number,string,boolean,undefined, null,object。进一步划分为值类型和引用类型。</p><p><strong>值类型：</strong>简单数据类型，基本数据类型，在存储时，变量中存储的是值本身，因此叫做值类型。</p><p><strong>引用类型：</strong>复杂数据类型，在存储时，变量中存储的仅仅是地址（引用），因此叫做引用数据类型。</p><p>1、基本类型(又称简单类型、值类型): number,string,boolean</p><p>2、复杂类型(引用类型):object</p><p>3、空类型:undefined,null</p><p>值类型的值在哪一块空间中存储? 栈中存储</p><p>引用类型的值在哪一块空间中存储?对象在堆上存储,地址在栈上存储。</p><p>var num=10;//值类型,值在栈上</p><p>var obj={};//复杂类型,对象在堆,地址(引用)在栈</p><p>值类型之间传递,传递的是值</p><p>引用类型之间传递,传递的是地址(引用)</p><p>值类型作为函数的参数,传递的是值</p><p>引用类型作为函数的参数,传递的是地址</p><h2 id="数据类型在内存中的存储"><a href="#数据类型在内存中的存储" class="headerlink" title="数据类型在内存中的存储"></a>数据类型在内存中的存储</h2><h3 id="堆和栈"><a href="#堆和栈" class="headerlink" title="堆和栈"></a>堆和栈</h3><ul><li><p>堆和栈</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">堆栈空间分配区别：</span><br><span class="line">　　1、栈（操作系统）：由操作系统自动分配释放 ，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈；</span><br><span class="line">　　2、堆（操作系统）： 存储复杂类型(对象)，一般由程序员分配释放， 若程序员不释放，由垃圾回收机制回收，分配方式倒是类似于链表。</span><br></pre></td></tr></table></figure></li><li><p>注意：JavaScript中没有堆和栈的概念，此处我们用堆和栈来讲解，目的方便理解和方便以后的学习。</p></li></ul><h3 id="基本类型在内存中的存储"><a href="#基本类型在内存中的存储" class="headerlink" title="基本类型在内存中的存储"></a>基本类型在内存中的存储</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgkaitpicj30n70fgt8v.jpg" alt=""></p><h3 id="复杂类型在内存中的存储"><a href="#复杂类型在内存中的存储" class="headerlink" title="复杂类型在内存中的存储"></a>复杂类型在内存中的存储</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgkbgb44oj30p00cz3zh.jpg" alt=""></p><h3 id="基本类型作为函数的参数"><a href="#基本类型作为函数的参数" class="headerlink" title="基本类型作为函数的参数"></a>基本类型作为函数的参数</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgkc4enzbj30o60g3jrv.jpg" alt=""></p><h3 id="复杂类型作为函数的参数"><a href="#复杂类型作为函数的参数" class="headerlink" title="复杂类型作为函数的参数"></a>复杂类型作为函数的参数</h3><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgkchu8lhj30xb0lfwfm.jpg" alt=""></p><h2 id="例题练习"><a href="#例题练习" class="headerlink" title="例题练习"></a>例题练习</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下面代码输出的结果</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age,salary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.salary = salary;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">person</span>) </span>&#123;</span><br><span class="line">  person.name = <span class="string">"ls"</span>;</span><br><span class="line">  person = <span class="keyword">new</span> Person(<span class="string">"aa"</span>,<span class="number">18</span>,<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">"zs"</span>,<span class="number">18</span>,<span class="number">1000</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p.name);<span class="comment">//zs</span></span><br><span class="line">f1(p);</span><br><span class="line"><span class="built_in">console</span>.log(p.name);<span class="comment">//ls</span></span><br></pre></td></tr></table></figure><p><strong>答案：</strong></p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgjz1hw08j309907gmx5.jpg" alt=""><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgkwqtyikj30y00fj0tw.jpg" alt=""></p><p>思考：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. </span></span><br><span class="line"><span class="keyword">var</span> num1 = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> num2 = num1;</span><br><span class="line">num1 = <span class="number">20</span>;</span><br><span class="line"><span class="built_in">console</span>.log(num1);</span><br><span class="line"><span class="built_in">console</span>.log(num2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. </span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">50</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    num = <span class="number">60</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(num);</span><br><span class="line">&#125;</span><br><span class="line">f1(num);</span><br><span class="line"><span class="built_in">console</span>.log(num);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3. 重点</span></span><br><span class="line"><span class="keyword">var</span> num1 = <span class="number">55</span>;</span><br><span class="line"><span class="keyword">var</span> num2 = <span class="number">66</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">num, num1</span>) </span>&#123;</span><br><span class="line">  num = <span class="number">100</span>;</span><br><span class="line">  num1 = <span class="number">100</span>;</span><br><span class="line">  num2 = <span class="number">100</span>;<span class="comment">//注意是隐式全局变量</span></span><br><span class="line">  <span class="built_in">console</span>.log(num);</span><br><span class="line">  <span class="built_in">console</span>.log(num1);</span><br><span class="line">  <span class="built_in">console</span>.log(num2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f1(num1, num2);</span><br><span class="line"><span class="built_in">console</span>.log(num1);</span><br><span class="line"><span class="built_in">console</span>.log(num2);</span><br><span class="line"><span class="built_in">console</span>.log(num);</span><br></pre></td></tr></table></figure><p><strong>答案：</strong></p><p>1、</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgjtae7g3j306p045q2r.jpg" alt=""></p><p>2、</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgjvexo2gj305i04fmwz.jpg" alt=""></p><p>3、</p><p><img src="http://ww1.sinaimg.cn/large/006ttwEMgy1fzgjqnz30gj30bf0ajaa5.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>flex伸缩弹性布局常用属性</title>
      <link href="/2018/12/15/flex%E5%B8%83%E5%B1%80%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7.html"/>
      <url>/2018/12/15/flex%E5%B8%83%E5%B1%80%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7.html</url>
      
        <content type="html"><![CDATA[<h2 id="伸缩布局-CSS3"><a href="#伸缩布局-CSS3" class="headerlink" title="伸缩布局(CSS3)"></a>伸缩布局(CSS3)</h2><p>CSS3在布局方面做了非常大的改进，使得我们对块级元素的布局排列变得十分灵活，适应性非常强，其强大的伸缩性，在响应式开中可以发挥极大的作用。</p><p><br></p><p>主轴：Flex容器的主轴主要用来配置Flex项目，默认是水平方向</p><p>侧轴：与主轴垂直的轴称作侧轴，默认是垂直方向的</p><p>方向：默认主轴从左向右，侧轴默认从上到下</p><p>主轴和侧轴并不是固定不变的，通过flex-direction可以互换。</p><p><img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy6udwb0ndj30ju08r0u6.jpg" alt=""></p><p>Flex布局的语法规范经过几年发生了很大的变化，也给Flexbox的使用带来一定的局限性，因为语法规范版本众多，浏览器支持不一致，致使Flexbox布局使用不多<br></p><h2 id="各属性详解"><a href="#各属性详解" class="headerlink" title="各属性详解"></a>各属性详解</h2><p><br>1.flex子项目在主轴的缩放比例，不指定flex属性，则不参与伸缩分配</p><p>min-width  最小值      min-width: 280px  最小宽度  不能小于 280</p><p>max-width: 1280px  最大宽度  不能大于 1280</p><p><br></p><p>2.flex-direction调整主轴方向（默认为水平方向）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flex-direction：row</span><br></pre></td></tr></table></figure><p>flex容器的主轴被定义为与文本方向相同。 主轴起点和主轴终点与内容方向相同。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flex-direction：row-reverse</span><br></pre></td></tr></table></figure><p>表现和row相同，但是置换了主轴起点和主轴终点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flex-direction：column</span><br></pre></td></tr></table></figure><p>flex容器的主轴和块轴相同。主轴起点与主轴终点和书写模式的前后点相同</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flex-direction：column-reverse</span><br></pre></td></tr></table></figure><p>表现和<code>column</code>相同，但是置换了主轴起点和主轴终点</p><p>  可以仿写<a href="http://m.ctrip.com/html5/" target="_blank" rel="noopener">携程网手机端</a>页面练习flex布局</p><p><br></p><p>3、justify-content调整主轴对齐（水平对齐）</p><p>子盒子如何在父盒子里面水平对齐</p><table><thead><tr><th>值</th><th>描述</th><th>白话文</th></tr></thead><tbody><tr><td>flex-start</td><td>默认值。项目位于容器的开头。</td><td>让子元素从父容器的开头开始排序但是盒子顺序不变</td></tr><tr><td>flex-end</td><td>项目位于容器的结尾。</td><td>让子元素从父容器的后面开始排序但是盒子顺序不变</td></tr><tr><td>center</td><td>项目位于容器的中心。</td><td>让子元素在父容器中间显示</td></tr><tr><td>space-between</td><td>项目位于各行之间留有空白的容器内。</td><td>左右的盒子贴近父盒子，中间的平均分布空白间距</td></tr><tr><td>space-around</td><td>项目位于各行之前、之间、之后都留有空白的容器内。</td><td>相当于给每个盒子添加了左右margin外边距</td></tr></tbody></table><p><br>4、align-items调整侧轴对齐（垂直对齐）</p><p>子盒子如何在父盒子里面垂直对齐（单行）</p><table><thead><tr><th>值</th><th>描述</th><th>白话文</th></tr></thead><tbody><tr><td>stretch</td><td>默认值。项目被拉伸以适应容器。</td><td>让子元素的高度拉伸适用父容器（子元素不给高度的前提下)</td></tr><tr><td>center</td><td>项目位于容器的中心。</td><td>垂直居中</td></tr><tr><td>flex-start</td><td>项目位于容器的开头。</td><td>垂直对齐开始位置 上对齐</td></tr><tr><td>flex-end</td><td>项目位于容器的结尾。</td><td>垂直对齐结束位置 底对齐</td></tr><tr><td></td><td></td></tr></tbody></table><p><br>5、flex-wrap控制是否换行</p><p>当我们子盒子内容宽度多于父盒子的时候如何处理</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>nowrap</td><td>默认值。规定灵活的项目不拆行或不拆列。  不换行，则 收缩（压缩） 显示  强制一行内显示</td></tr><tr><td>wrap</td><td>规定灵活的项目在必要的时候拆行或拆列。</td></tr><tr><td>wrap-reverse</td><td>规定灵活的项目在必要的时候拆行或拆列，但是以相反的顺序。</td></tr><tr><td></td><td></td></tr><tr><td></td></tr></tbody></table><p><br>6、flex-flow是flex-direction、flex-wrap的简写形式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">flex-flow</span>: <span class="selector-tag">flex-direction</span>  <span class="selector-tag">flex-wrap</span>;</span><br></pre></td></tr></table></figure><p>白话记：    flex-flow: 排列方向   换不换行; </p><p>两个中间用空格</p><p>例如：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">display</span>: <span class="selector-tag">flex</span>;</span><br><span class="line"><span class="comment">/* flex-direction: row;</span></span><br><span class="line"><span class="comment">flex-wrap: wrap;   这两句话等价于下面的这句话*/</span></span><br><span class="line"><span class="selector-tag">flex-flow</span>: <span class="selector-tag">column</span> <span class="selector-tag">wrap</span>;  <span class="comment">/* 两者的综合 */</span></span><br></pre></td></tr></table></figure><p><br>7、align-content堆栈（由flex-wrap产生的独立行）多行垂直对齐方式齐</p><p>align-content是针对flex容器里面多轴(多行)的情况,align-items是针对一行的情况进行排列。</p><p>必须对父元素设置自由盒属性display:flex;，并且设置排列方式为横向排列flex-direction:row;并且设置换行，flex-wrap:wrap;这样这个属性的设置才会起作用。</p><table><thead><tr><th>值</th><th>描述</th><th>测试</th></tr></thead><tbody><tr><td>stretch</td><td>默认值。项目被拉伸以适应容器。</td><td></td></tr><tr><td>center</td><td>项目位于容器的中心。</td><td></td></tr><tr><td>flex-start</td><td>项目位于容器的开头。</td><td></td></tr><tr><td>flex-end</td><td>项目位于容器的结尾。</td><td></td></tr><tr><td>space-between</td><td>项目位于各行之间留有空白的容器内。</td><td></td></tr><tr><td>space-around</td><td>项目位于各行之前、之间、之后都留有空白的容器内。</td></tr></tbody></table><p><br>8、order控制子项目的排列顺序，正序方式排序，从小到大</p><p>用css 来控制盒子的前后顺序。  用order 就可以</p><p>用整数值来定义排列顺序，数值小的排在前面。可以为负值。 默认值是 0</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">order</span>: 1;</span><br></pre></td></tr></table></figure><p><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈BFC</title>
      <link href="/2018/12/10/%E6%B5%85%E8%B0%88BFC.html"/>
      <url>/2018/12/10/%E6%B5%85%E8%B0%88BFC.html</url>
      
        <content type="html"><![CDATA[<p><strong>BFC(Block formatting context)</strong></p><p>直译为”块级格式化上下文”。它是一个独立的渲染区域，只有Block-level box参与， 它规定了内部的Block-level Box如何布局，并且与这个区域外部毫不相干。</p><p>白话文： 孩子在家里愿意怎么折腾都行，但是出了家门口，你就的乖乖的，不能影响外面的任何人。</p><p><br></p><h3 id="元素的显示模式"><a href="#元素的显示模式" class="headerlink" title="元素的显示模式"></a>元素的显示模式</h3><p>我们前面讲过 元素的显示模式 display。 </p><p>分为 块级元素   行内元素  行内块元素 ，其实，它还有很多其他显示模式。</p><p><img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy5juu4ov4j30a20dkjrx.jpg" alt=""><br></p><h3 id="哪些元素会具有BFC的条件"><a href="#哪些元素会具有BFC的条件" class="headerlink" title="哪些元素会具有BFC的条件"></a>哪些元素会具有BFC的条件</h3><p>不是所有的元素模式都能产生BFC，w3c 规范： </p><p>display 属性为 block, list-item, table 的元素，会产生BFC.</p><p>这个三个都是用来布局最为合理的元素，因为他们就是用来可视化布局。</p><p>注意其他的，display属性，比如 line 等等，他们创建的是 IFC ，我们暂且不研究。</p><p>这个BFC 有着具体的布局特性： </p><p><img src="http://wx1.sinaimg.cn/large/006ttwEMgy1fy5juujfrkg30dw0dwt8n.gif" alt=""></p><p>有宽度和高度 ， 有 外边距margin  有内边距padding 有边框 border。<br></p><h3 id="什么情况下可以让元素产生BFC"><a href="#什么情况下可以让元素产生BFC" class="headerlink" title="什么情况下可以让元素产生BFC"></a>什么情况下可以让元素产生BFC</h3><p>以上盒子具有BFC条件了，就是说有资质了，但是怎样触发才会产生BFC，从而创造这个封闭的环境呢？<br>同样，要给这些元素添加如下属性就可以触发BFC。</p><blockquote><p>-float属性不为none</p><p>-position为absolute或fixed</p><p>-display为inline-block, table-cell, table-caption, flex, inline-flex</p><p>-overflow不为visible。</p></blockquote><p><br></p><h3 id="BFC元素所具有的特性"><a href="#BFC元素所具有的特性" class="headerlink" title="BFC元素所具有的特性"></a>BFC元素所具有的特性</h3><p>BFC布局规则特性：</p><p>1.在BFC中，盒子从顶端开始垂直地一个接一个地排列.</p><p>2.盒子垂直方向的距离由margin决定。属于同一个BFC的两个相邻盒子的margin会发生重叠，不属于同一个BFC的两个相邻盒子的margin不会发生重叠。（一般非BFC区域内的两个相邻盒子的margin也是会发生重叠）</p><p>3.在BFC中，每一个盒子的左外边缘（margin-left）会触碰到容器的左边缘(border-left)内侧，只是接触不会压住border（对于从右到左的格式来说，则触碰到右边缘）。</p><p>4.BFC的区域不会与浮动盒子产生交集，而是紧贴浮动边缘。</p><p>5.计算BFC的高度时，自然也会检测浮动或者定位的盒子高度。</p><p><br></p><h3 id="BFC的主要用途"><a href="#BFC的主要用途" class="headerlink" title="BFC的主要用途"></a>BFC的主要用途</h3><p>BFC能用来做什么？</p><p>(1) 清除元素内部浮动</p><p>只要把父元素设为BFC就可以清理子元素的浮动了，最常见的用法就是在父元素上设置overflow: hidden样式，对于IE6加上zoom:1就可以了。</p><p>主要用到 <strong>计算BFC的高度时，自然也会检测浮动或者定位的盒子高度</strong>这一特性</p><p>清除浮动前：<img src="http://wx2.sinaimg.cn/large/006ttwEMgy1fy5jwcv0kuj30ah090q2p.jpg" alt=""></p><p>清除浮动后：<img src="http://wx1.sinaimg.cn/large/006ttwEMgy1fy5jwdc1bkj309p08cmwx.jpg" alt=""></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">    &lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">        <span class="selector-class">.father</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">            <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">            <span class="comment">/* float: left;   给father 创建了BFC*/</span></span><br><span class="line">            <span class="comment">/*position: absolute; 给father 创建了BFC*/</span></span><br><span class="line">            <span class="comment">/*display: inline-block; 给father 创建了BFC*/</span></span><br><span class="line">            <span class="attribute">overflow</span>: hidden;   <span class="comment">/*给father创建了BFC*/</span></span><br><span class="line">            <span class="attribute">zoom</span>: <span class="number">1</span>; <span class="comment">/*兼容ie6 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.son1</span>, <span class="selector-class">.son2</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">background-color</span>: pink;</span><br><span class="line">            <span class="attribute">float</span>: left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.son2</span> &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: purple;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">&lt;div class="father"&gt;</span><br><span class="line">    &lt;div class="son1"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;div class="son2"&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p><br></p><p>(2) 解决外边距合并问题</p><p>外边距合并的问题。</p><p>主要用到 <strong>盒子垂直方向的距离由margin决定，属于同一个BFC的两个相邻盒子的margin会发生重叠，不属于统一BFC的相邻盒子不会margin重叠</strong>这一特性</p><p>属于同一个BFC的两个相邻盒子的margin会发生重叠，那么我们创建不属于同一个BFC，就不会发生margin重叠了。<img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy5jwchk3tj30fk0caq2w.jpg" alt=""></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">    &lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">        <span class="selector-class">.father</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">            <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.son1</span>, <span class="selector-class">.son2</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">background-color</span>: pink;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.son1</span> &#123;</span><br><span class="line">            <span class="attribute">margin-bottom</span>: <span class="number">50px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.over</span> &#123;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;<span class="comment">/*形成BFC区域*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.son2</span> &#123;</span><br><span class="line">            <span class="attribute">background-color</span>: purple;</span><br><span class="line">            <span class="attribute">margin-top</span>: <span class="number">100px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">&lt;div class="father"&gt;</span><br><span class="line">    &lt;div class="over"&gt; &lt;!--over隔开，那么 son1 就和son1 不是同一BFC--&gt;</span><br><span class="line">        &lt;div class="son1"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class="son2"&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p><br></p><p>(3) 制作右侧自适应的盒子问题</p><p>主要用到<strong>普通流体元素BFC后，为了和浮动元素不产生任何交集，顺着浮动边缘形成自己的封闭上下文</strong></p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy5jwdxel9j30d20f4t8z.jpg" alt=""></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">    &lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">        <span class="selector-class">.father</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">            <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.box</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">            <span class="attribute">background-color</span>: pink;</span><br><span class="line">            <span class="attribute">float</span>: left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.txt</span> &#123;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">            <span class="attribute">background-color</span>: purple;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;  <span class="comment">/*给txt 创建BFC 区域 在不和浮动产生交集 紧贴制浮动的边缘 */</span></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">&lt;div class="father"&gt;</span><br><span class="line">    &lt;div class="box"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;div class="txt"&gt;我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子</span><br><span class="line">        我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子</span><br><span class="line">        我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子</span><br><span class="line">        我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子我可以制作右侧自适应的盒子&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p><br></p><h3 id="BFC-总结"><a href="#BFC-总结" class="headerlink" title="BFC 总结"></a>BFC 总结</h3><p>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素。反之也如此。包括浮动，和外边距合并等等，因此，有了这个特性，我们布局的时候就不会出现意外情况了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>外边距塌陷问题</title>
      <link href="/2018/12/08/%E5%A4%96%E8%BE%B9%E8%B7%9D%E5%A1%8C%E9%99%B7%E9%97%AE%E9%A2%98.html"/>
      <url>/2018/12/08/%E5%A4%96%E8%BE%B9%E8%B7%9D%E5%A1%8C%E9%99%B7%E9%97%AE%E9%A2%98.html</url>
      
        <content type="html"><![CDATA[<h2 id="外边距合并"><a href="#外边距合并" class="headerlink" title="外边距合并"></a>外边距合并</h2><p>使用margin定义块元素的垂直外边距时，可能会出现外边距的合并。</p><h3 id="相邻块元素垂直外边距的合并"><a href="#相邻块元素垂直外边距的合并" class="headerlink" title="相邻块元素垂直外边距的合并"></a>相邻块元素垂直外边距的合并</h3><p>当上下相邻的两个块元素相遇时，如果上面的元素有下外边距margin-bottom，下面的元素有上外边距margin-top，则他们之间的垂直间距不是margin-bottom与margin-top之和，而是两者中的较大者。这种现象被称为相邻块元素垂直外边距的合并（也称外边距塌陷）。</p><p><img src="http://wx1.sinaimg.cn/mw690/006ttwEMgy1fy0xzlda0nj30e008lq2t.jpg" alt=""></p><p>解决方案一： 避免这样写就好了。。。。</p><p>解决方案二：详见我的另一篇博文<a href="https://dunteng.github.io/[object%20Object]2018/12/10/%E6%B5%85%E8%B0%88BFC.html#BFC%E7%9A%84%E4%B8%BB%E8%A6%81%E7%94%A8%E9%80%94">利用BFC机制解决外边距合并问题</a></p><h3 id="嵌套块元素垂直外边距的合并"><a href="#嵌套块元素垂直外边距的合并" class="headerlink" title="嵌套块元素垂直外边距的合并"></a>嵌套块元素垂直外边距的合并</h3><p>对于两个嵌套关系的块元素，如果父元素没有上内边距及边框，则父元素的上外边距会与子元素的上外边距发生合并，合并后的外边距为两者中的较大者，即使父元素的上外边距为0，也会发生合并。</p><p><img src="http://wx2.sinaimg.cn/mw690/006ttwEMgy1fy0xzb8o6vj30e005fwec.jpg" alt=""></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">* &#123;</span></span><br><span class="line"><span class="undefined">margin: 0;</span></span><br><span class="line"><span class="undefined">padding: 0;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.baba</span> &#123;</span></span><br><span class="line"><span class="css"><span class="comment">/* border-top: 1px solid black; */</span></span></span><br><span class="line"><span class="undefined">height: 100px;</span></span><br><span class="line"><span class="undefined">width: 100px;</span></span><br><span class="line"><span class="undefined">background-color: red;</span></span><br><span class="line"><span class="undefined">margin-top: 30px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.erzi</span> &#123;</span></span><br><span class="line"><span class="undefined">height: 50px;</span></span><br><span class="line"><span class="undefined">width: 50px;</span></span><br><span class="line"><span class="undefined">background-color: pink;</span></span><br><span class="line"><span class="undefined">margin-top: 10px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">      </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"baba"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"erzi"</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><br>观察下图erzi块的效果，erzi与baba之间没有margin撑开，不是我们想要的效果<img src="http://wx1.sinaimg.cn/large/006ttwEMgy1fy0zwmwqw8j311y0heq3o.jpg" alt=""></p><p><br>父元素的上外边距会与子元素的上外边距发生合并，合并后的外边距为两者中的较大者<img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy0zwnceysj311y0heaau.jpg" alt=""></p><p>解决方案：</p><ol><li>可以为父元素定义1像素的上边框或上内边距。</li><li>可以为父元素添加overflow:hidden。</li></ol><p><br>解决该问题后，erzi块与baba块有了我们想要的margin<img src="http://wx1.sinaimg.cn/large/006ttwEMgy1fy0zwnq65qj311y0hemxw.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy0zwo350qj311y0hedgm.jpg" alt=""></p><p><br><br>待续。。。。</p><p><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字体图标的使用</title>
      <link href="/2018/12/08/%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87%E7%9A%84%E4%BD%BF%E7%94%A8.html"/>
      <url>/2018/12/08/%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87%E7%9A%84%E4%BD%BF%E7%94%A8.html</url>
      
        <content type="html"><![CDATA[<h1 id="字体格式"><a href="#字体格式" class="headerlink" title="字体格式"></a>字体格式</h1><p>不同浏览器所支持的字体格式是不一样的，我们有必要了解一下有关字体格式的知识。</p><p>1、TureType(.ttf)格式</p><p>.ttf字体是Windows和Mac的最常见的字体，是一种RAW格式，支持这种字体的浏览器有IE9+、Firefox3.5+、Chrome4+、Safari3+、Opera10+、iOS Mobile、Safari4.2+；</p><p>2、OpenType(.otf)格式</p><p>.otf字体被认为是一种原始的字体格式，其内置在TureType的基础上，支持这种字体的浏览器有Firefox3.5+、Chrome4.0+、Safari3.1+、Opera10.0+、iOS Mobile、Safari4.2+；</p><p>3、Web Open Font Format(.woff)格式</p><p>woff字体是Web字体中最佳格式，他是一个开放的TrueType/OpenType的压缩版本，同时也支持元数据包的分离，支持这种字体的浏览器有IE9+、Firefox3.5+、Chrome6+、Safari3.6+、Opera11.1+；</p><p>4、Embedded Open Type(.eot)格式</p><p>.eot字体是IE专用字体，可以从TrueType创建此格式字体，支持这种字体的浏览器有IE4+；</p><p>5、SVG(.svg)格式</p><p>.svg字体是基于SVG字体渲染的一种格式，支持这种字体的浏览器有Chrome4+、Safari3.1+、Opera10.0+、iOS Mobile Safari3.2+；</p><p>了解了上面的知识后，我们就需要为不同的浏览器准备不同格式的字体，通常我们会通过字体生成工具帮我们生成各种格式的字体，因此无需过于在意字体格式间的区别差异。</p><h1 id="字体图标"><a href="#字体图标" class="headerlink" title="字体图标"></a>字体图标</h1><p>图片是有诸多优点的，但是缺点很明显，比如图片不但增加了总文件的大小，还增加了很多额外的”http请求”，这都会大大降低网页的性能的。更重要的是图片不能很好的进行“缩放”，因为图片放大和缩小会失真。 我们学习移动端响应式，很多情况下希望我们的图标是可以缩放的。此时，一个非常重要的技术出现了，就是字体图标（iconfont).</p><h2 id="字体图标优点"><a href="#字体图标优点" class="headerlink" title="字体图标优点"></a>字体图标优点</h2><p>可以做出跟图片一样可以做的事情，改变透明度、旋转度，等等..<br>但是本质其实是文字，可以很随意的改变颜色、产生阴影、透明效果等等…<br>本身体积更小，但携带的信息并没有削减。<br>几乎支持所有的浏览器<br>移动端设备必备良药…</p><h2 id="字体图标使用流程"><a href="#字体图标使用流程" class="headerlink" title="字体图标使用流程"></a>字体图标使用流程</h2><p>总体来说，字体图标按照如下流程：</p><p><img src="http://wx2.sinaimg.cn/large/006ttwEMgy1fy4ayku0rmj30xt0a8mxz.jpg" alt=""></p><h3 id="设计字体图标"><a href="#设计字体图标" class="headerlink" title="设计字体图标"></a>设计字体图标</h3><p>假如图标是我们公司单独设计，那就需要第一步了，这个属于UI设计人员的工作， 他们在 illustrator 或 Sketch 这类矢量图形软件里创建 icon图标， 比如下图：</p><p><img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy4ayliklzj30dc05wwf5.jpg" alt=""></p><p>  之后保存为svg格式，然后给我们前端人员就好了。 </p><p>  其实第一步，我们不需要关心，只需要给我们这些图标就可以了，如果图标是大众的，网上本来就有的，可以直接跳过第一步，进入第三步。</p><h3 id="上传生成字体包"><a href="#上传生成字体包" class="headerlink" title="上传生成字体包"></a>上传生成字体包</h3><p>   当UI设计人员给我们svg文件的时候，我们需要转换成我们页面能使用的字体文件， 而且需要生成的是兼容性的适合各个浏览器的。</p><p>​    推荐网站： <a href="http://icomoon.io" target="_blank" rel="noopener">http://icomoon.io</a></p><p><strong>icomoon字库</strong></p><p>IcoMoon成立于2011年，推出的第一个自定义图标字体生成器，它允许用户选择他们所需要的图标，使它们成一字型。 内容种类繁多，非常全面。</p><p>   推荐网站： <a href="http://www.iconfont.cn/" target="_blank" rel="noopener">http://www.iconfont.cn/</a></p><p><strong>阿里icon font字库</strong></p><p><a href="http://www.iconfont.cn/" target="_blank" rel="noopener">http://www.iconfont.cn/</a></p><p>这个是阿里妈妈M2UX的一个icon font字体图标字库，包含了淘宝图标库和阿里妈妈图标库。可以使用AI制作图标上传生成。 一个字，免费，免费！！</p><p><strong>fontello</strong></p><p><a href="http://fontello.com/" target="_blank" rel="noopener">http://fontello.com/</a></p><p>在线定制你自己的icon font字体图标字库，也可以直接从GitHub下载整个图标集，该项目也是开源的。</p><p><strong>Font-Awesome</strong></p><p><a href="http://fortawesome.github.io/Font-Awesome/" target="_blank" rel="noopener">http://fortawesome.github.io/Font-Awesome/</a></p><p>这是我最喜欢的字库之一了，更新比较快。目前已经有369个图标了。</p><p><strong>Glyphicon Halflings</strong></p><p><a href="http://glyphicons.com/" target="_blank" rel="noopener">http://glyphicons.com/</a></p><p>这个字体图标可以在Bootstrap下免费使用。自带了200多个图标。</p><p><strong>Icons8</strong></p><p><a href="https://icons8.com/" target="_blank" rel="noopener">https://icons8.com/</a></p><p>提供PNG免费下载，像素大能到500PX</p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy4aym7ehpj30gm08vq38.jpg" alt="1513132290173"></p><h3 id="下载兼容字体包"><a href="#下载兼容字体包" class="headerlink" title="下载兼容字体包"></a>下载兼容字体包</h3><p>刚才上传完毕， 网站会给我们把UI做的svg图片转换为我们的字体格式， 然后下载下来就好了</p><p>当然，我们不需要自己专门的图标，是想网上找几个图标使用，以上2步可以直接省略了， 直接到刚才的网站上找喜欢的下载使用吧。</p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy4ayjisn4j30k70db750.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy4ayk46x9j30lx0g53z3.jpg" alt=""></p><h3 id="字体引入到HTML"><a href="#字体引入到HTML" class="headerlink" title="字体引入到HTML"></a>字体引入到HTML</h3><p>得到压缩包之后，最后一步，是最重要的一步了， 就是字体文件已经有了，我们需要引入到我们页面中。</p><ol><li><p>首先把 以下4个文件放入到 fonts文件夹里面。 通俗的做法</p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy4aymmz4oj30bo06wweh.jpg" alt=""></p><h5 id="第一步：在样式里面声明字体：-告诉别人我们自己定义的字体"><a href="#第一步：在样式里面声明字体：-告诉别人我们自己定义的字体" class="headerlink" title="第一步：在样式里面声明字体： 告诉别人我们自己定义的字体"></a>第一步：在样式里面声明字体： 告诉别人我们自己定义的字体</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">font-face</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">'icomoon'</span>;</span><br><span class="line">  <span class="attribute">src</span>:  <span class="built_in">url</span>(<span class="string">'fonts/icomoon.eot?7kkyc2'</span>);<span class="comment">/*注意路径不要照搬，看实际位置*/</span></span><br><span class="line">  <span class="attribute">src</span>:  <span class="built_in">url</span>(<span class="string">'fonts/icomoon.eot?7kkyc2#iefix'</span>) <span class="built_in">format</span>(<span class="string">'embedded-opentype'</span>),</span><br><span class="line">    <span class="built_in">url</span>(<span class="string">'fonts/icomoon.ttf?7kkyc2'</span>) <span class="built_in">format</span>(<span class="string">'truetype'</span>),</span><br><span class="line">    <span class="built_in">url</span>(<span class="string">'fonts/icomoon.woff?7kkyc2'</span>) <span class="built_in">format</span>(<span class="string">'woff'</span>),</span><br><span class="line">    <span class="built_in">url</span>(<span class="string">'fonts/icomoon.svg?7kkyc2#icomoon'</span>) <span class="built_in">format</span>(<span class="string">'svg'</span>);</span><br><span class="line">  <span class="attribute">font-weight</span>: normal;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="第二步：给盒子使用字体"><a href="#第二步：给盒子使用字体" class="headerlink" title="第二步：给盒子使用字体"></a>第二步：给盒子使用字体</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line"><span class="attribute">font-family</span>: <span class="string">"icomoon"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="第三步：盒子里面添加结构"><a href="#第三步：盒子里面添加结构" class="headerlink" title="第三步：盒子里面添加结构"></a>第三步：盒子里面添加结构</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line"> <span class="attribute">content</span>: <span class="string">"\e900"</span>;</span><br><span class="line">&#125;</span><br><span class="line">或者  </span><br><span class="line">&lt;span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure><h3 id="追加新图标到原来库里面"><a href="#追加新图标到原来库里面" class="headerlink" title="追加新图标到原来库里面"></a>追加新图标到原来库里面</h3><p>如果工作中，原来的字体图标不够用了，我们需要添加新的字体图标，但是原来的不能删除，继续使用，此时我们需要这样做</p><p>把压缩包里面的selection.json 从新上传，然后，选中自己想要新的图标，从新下载压缩包，替换原来文件即可。</p><p><img src="http://wx1.sinaimg.cn/large/006ttwEMgy1fy4ayilxtvj30dx0cc0ti.jpg" alt=""></p></li></ol><p><br><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vertical-align</title>
      <link href="/2018/12/07/vertical-align.html"/>
      <url>/2018/12/07/vertical-align.html</url>
      
        <content type="html"><![CDATA[<p>让带有宽度的块级元素居中对齐，是margin: 0 auto;</p><p>让文字居中对齐，是 text-align: center;</p><p>本文讲一下垂直居中的属性.</p><p><br></p><h3 id="图片、表单和文字对齐"><a href="#图片、表单和文字对齐" class="headerlink" title="图片、表单和文字对齐"></a>图片、表单和文字对齐</h3><p>vertical-align 垂直对齐， 这个看上去很美好的一个属性， 实际有着不可捉摸的脾气。<br></p><p><img src="http://wx2.sinaimg.cn/large/006ttwEMgy1fy4740ts24j30ku0410th.jpg" alt=""><br><br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vertical-align : baseline |top |middle |bottom</span><br></pre></td></tr></table></figure><p><strong>vertical-align 不影响块级元素中的内容对齐，它只针对于 行内元素或者行内块元素，特别是行内块元素， 通常用来控制图片/表单与文字的对齐</strong>。</p><p>默认的图片会和文字基线对齐，我们可以通过vertical-align 控制图片和文字的垂直关系了。 </p><p><br></p><h3 id="去除图片底侧空白缝隙"><a href="#去除图片底侧空白缝隙" class="headerlink" title="去除图片底侧空白缝隙"></a>去除图片底侧空白缝隙</h3><p>有个很重要特性你要记住： 图片或者表单等行内块元素，他的底线会和父级盒子的基线对齐。这样会造成一个问题，就是图片底侧会有一个空白缝隙。</p><p>解决的方法就是：  </p><p>1.给img vertical-align:middle | top等等。  让图片不要和基线对齐。</p><p><img src="http://wx2.sinaimg.cn/large/006ttwEMgy1fy47418d8ej30he08cab3.jpg" alt=""></p><p>2.给img 添加 display：block; 转换为块级元素就不会存在问题了。</p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy4741w8mnj30kp0a0404.jpg" alt=""></p><p><br><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实现微信滑动门</title>
      <link href="/2018/12/07/%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E6%BB%91%E5%8A%A8%E9%97%A8.html"/>
      <url>/2018/12/07/%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E6%BB%91%E5%8A%A8%E9%97%A8.html</url>
      
        <content type="html"><![CDATA[<h2 id="滑动门出现的背景"><a href="#滑动门出现的背景" class="headerlink" title="滑动门出现的背景"></a>滑动门出现的背景</h2><p>制作网页时，为了美观，常常需要为网页元素设置特殊形状的背景，比如微信导航栏，有凸起和凹下去的感觉，最大的问题是里面的字数不一样多，按照传统思维，这就意味着要多张长度不同的背景图片，不过有更好的解决方法。</p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy49ltwng4j30xq0dcdi1.jpg" alt=""></p><p>为了使各种特殊形状的背景能够自适应元素中文本内容的多少，出现了CSS滑动门技术。它从新的角度构建页面，使各种特殊形状的背景能够自由拉伸滑动，以适应元素内部的文本内容，可用性更强。 最常见于各种导航栏的滑动门。</p><h2 id="核心技术"><a href="#核心技术" class="headerlink" title="核心技术"></a>核心技术</h2><p>核心技术就是利用CSS精灵（主要是背景位置）和盒子padding撑开宽度, 以便能适应不同字数的导航栏。</p><p>一般的经典布局都是这样的：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>导航栏内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>两张背景图：</p><p>一张是凸起的：</p><p><img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy49gsni0vj30ao00x0bn.jpg" alt=""></p><p>另一张是凹陷的：</p><p><img src="http://wx4.sinaimg.cn/large/006ttwEMgy1fy49gs3rmtj30ao00x0az.jpg" alt=""></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(images/wx.jpg)  repeat-x; </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line"><span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line"><span class="comment">/*1. a 左边放 左圆角   但是文字需要往右走 15px*/</span></span><br><span class="line"><span class="attribute">height</span>: <span class="number">33px</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">33px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line"><span class="attribute">text-decoration</span>: none;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(images/to.png) no-repeat;</span><br><span class="line"><span class="attribute">display</span>: inline-block;</span><br><span class="line"><span class="attribute">padding-left</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span>  <span class="selector-tag">span</span> &#123;</span><br><span class="line"><span class="comment">/*2. span 右边放右圆角   但是文字需要往左走 15px*/</span></span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(images/to.png) no-repeat right;</span><br><span class="line"><span class="attribute">display</span>: inline-block;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">33px</span>;</span><br><span class="line"><span class="attribute">padding-right</span>: <span class="number">15px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.nav</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>, <span class="selector-class">.nav</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(images/ao.png);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">&lt;ul class="nav"&gt;</span><br><span class="line">&lt;<span class="selector-tag">li</span>&gt;</span><br><span class="line">      &lt;a href="#"&gt;</span><br><span class="line">      &lt;span&gt;首页&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line">&lt;<span class="selector-tag">li</span>&gt;</span><br><span class="line">      &lt;a href="#"&gt;</span><br><span class="line">      &lt;span&gt;三个字&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line">&lt;<span class="selector-tag">li</span>&gt;</span><br><span class="line">      &lt;a href="#"&gt;</span><br><span class="line">      &lt;span&gt;新闻客户端&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p><strong>实现效果：</strong></p><p><img src="http://wx2.sinaimg.cn/large/006ttwEMgy1fy49v5c8vuj30a7069wen.jpg" alt=""></p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><ol><li>a 设置 背景左侧，padding撑开合适宽度。    </li><li>span 设置背景右侧， padding撑开合适宽度 剩下由文字继续撑开宽度。</li><li>之所以a包含span就是因为 整个导航都是可以点击的。</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> 小案例 </tag>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>绝对定位的盒子水平/垂直居中</title>
      <link href="/2018/12/06/%E7%BB%9D%E5%AF%B9%E5%AE%9A%E4%BD%8D%E7%9B%92%E5%AD%90%E6%B0%B4%E5%B9%B3%E5%B1%85%E4%B8%AD.html"/>
      <url>/2018/12/06/%E7%BB%9D%E5%AF%B9%E5%AE%9A%E4%BD%8D%E7%9B%92%E5%AD%90%E6%B0%B4%E5%B9%B3%E5%B1%85%E4%B8%AD.html</url>
      
        <content type="html"><![CDATA[<p>普通的盒子是左右margin 改为 auto就可， 但是对于绝对定位就无效了</p><p>定位的盒子也可以水平或者垂直居中，有一个算法。</p><ol><li><p>首先left 50%   父盒子的一半大小</p></li><li><p>然后margin-left的值设为负数的自己盒子宽度的一半值就可以了</p><p>另外可以使用CSS3的translate来做更方便，避免了人工计算<a id="more"></a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">499.9999px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>:<span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">top</span>:<span class="number">50%</span>;</span><br><span class="line">  <span class="comment">/* margin-left: -250px; */</span></span><br><span class="line">  <span class="attribute">transform</span>:<span class="built_in">translate</span>(-50%,-50%);  <span class="comment">/* 走的自己的一半 */</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">    &lt;div class="box"&gt;&lt;/div&gt;   </span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p><br><br><br><br><br></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端开发仿站小工具</title>
      <link href="/2018/12/05/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E4%BB%BF%E7%AB%99%E5%B0%8F%E5%B7%A5%E5%85%B7.html"/>
      <url>/2018/12/05/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E4%BB%BF%E7%AB%99%E5%B0%8F%E5%B7%A5%E5%85%B7.html</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>仿站小工具是通过网址下载静态网页的工具。从输入的网址下载html代码，提取出JS、Css、Image、Picture、Flash等静态文件网址，再从下载完好的Css代码中提取出Image静态文件网址，通过网址下载静态文件，根据软件设置好的保存规则，自动修正html和css代码链接路径，最终这些静态文件被按分类保存到电脑文件夹。<a id="more"></a></p><h2 id="如何使用？"><a href="#如何使用？" class="headerlink" title="如何使用？"></a>如何使用？</h2><p>比如我想仿写OPPO官网，那么我可以把oppo网址复制并添加到仿站小工具中，然后下载即可。</p><p><img src="http://wx1.sinaimg.cn/mw690/006ttwEMgy1fy0xzatdfuj30iv0egt8z.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/006ttwEMgy1fy0xzaffrdj30iv0egq38.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/006ttwEMgy1fy0xz9z7ttj30iv0eg0ta.jpg" alt=""></p><p><img src="http://wx2.sinaimg.cn/mw690/006ttwEMgy1fy0xz5x6qdj30iv0eggm4.jpg" alt=""></p><p>打开目录，如下图所示。包含了oppo网站的html代码，提取出JS、Css、Image、Picture、Flash等静态文件。通过这些文件我们可以更好地学习这些优秀网页是如何写成的，并试着仿写之。</p><p>下载下来的文件夹:</p><p><img src="http://wx4.sinaimg.cn/mw690/006ttwEMgy1fy0xz87fxqj30hk0400so.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/006ttwEMgy1fy0xz2bpkmj30gy06674b.jpg" alt="static文件夹"></p><p>打开index.html，与oppo官网对比，几乎一模一样。</p><p>oppo官网:</p><p><img src="http://wx2.sinaimg.cn/mw690/006ttwEMgy1fy0xyzxhnfj311y0j9tkx.jpg" alt=""></p><p>本地文件index.html:<img src="http://wx3.sinaimg.cn/mw690/006ttwEMgy1fy0xzlqjfnj311y0jb7c2.jpg" alt=""></p><p>最后附上<a href="https://pan.baidu.com/s/1vye5PeNeEp_RPcVhAez4lQ" target="_blank" rel="noopener">下载链接</a></p><p><br><br><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> 工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈清除（闭合）浮动</title>
      <link href="/2018/12/05/%E6%B5%85%E8%B0%88%E6%B8%85%E9%99%A4%EF%BC%88%E9%97%AD%E5%90%88%EF%BC%89%E6%B5%AE%E5%8A%A8.html"/>
      <url>/2018/12/05/%E6%B5%85%E8%B0%88%E6%B8%85%E9%99%A4%EF%BC%88%E9%97%AD%E5%90%88%EF%BC%89%E6%B5%AE%E5%8A%A8.html</url>
      
        <content type="html"><![CDATA[<h2 id="为什么要清除浮动"><a href="#为什么要清除浮动" class="headerlink" title="为什么要清除浮动"></a>为什么要清除浮动</h2><p>由于浮动元素不再占用原文档流的位置，所以它会对后面的元素排版产生影响，为了解决这些问题，此时就需要在该元素中清除浮动。</p><p>准确地说，并不是清除浮动，而是<strong>清除浮动后造成的影响</strong></p><p>如果浮动一开始就是一个美丽的错误，那么请用正确的方法挽救它。</p><h2 id="清除浮动本质"><a href="#清除浮动本质" class="headerlink" title="清除浮动本质"></a>清除浮动本质</h2><p>我们一般不直接给定父级元素的高度，更希望子元素可以撑起父级元素。</p><p>清除浮动主要为了解决父级元素高度为0，因为子级浮动引起无法撑起父级元素的问题。</p><p><img src="http://wx3.sinaimg.cn/large/006ttwEMgy1fy35tsuml3j30gp09hdh5.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/large/006ttwEMgy1fy35ts9v92j30gq05iwfn.jpg" alt=""><br></p><h2 id="清除浮动的方法"><a href="#清除浮动的方法" class="headerlink" title="清除浮动的方法"></a>清除浮动的方法</h2><p>其实本质叫做闭合浮动更好一些, 记住，清除浮动就是把浮动的盒子圈到里面，让父盒子闭合出口和入口不让他们出来影响其他元素。最最暴力的方法是给父级元素加上高度，但是这显然不是一个好方法。</p><p>在CSS中，clear属性用于清除浮动，其基本语法格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">选择器&#123;clear:属性值;&#125;   clear 清除</span><br></pre></td></tr></table></figure><table><thead><tr><th>属性值</th><th>描述</th></tr></thead><tbody><tr><td>left</td><td>不允许左侧有浮动元素（清除左侧浮动的影响）</td></tr><tr><td>right</td><td>不允许右侧有浮动元素（清除右侧浮动的影响）</td></tr><tr><td>both</td><td>同时清除左右两侧浮动的影响</td></tr></tbody></table><p><br></p><h3 id="1-额外标签法"><a href="#1-额外标签法" class="headerlink" title="1. 额外标签法"></a>1. 额外标签法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">是W3C推荐的做法是通过在浮动元素末尾添加一个空的标签例如 <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">”clear:both”</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>，或则其他标签br等亦可。</span><br></pre></td></tr></table></figure><p>优点： 通俗易懂，书写方便</p><p>缺点： 添加许多无意义的标签，结构化较差。<br></p><h3 id="2-父级添加overflow属性方法"><a href="#2-父级添加overflow属性方法" class="headerlink" title="2. 父级添加overflow属性方法"></a>2. 父级添加overflow属性方法</h3><p>可以通过触发BFC的方式，可以实现清除浮动效果。（BFC后面讲解）</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以给父级添加： overflow为 hidden|auto|scroll  都可以实现。</span><br></pre></td></tr></table></figure><p>优点：  代码简洁</p><p>缺点：  内容增多时候容易造成不会自动换行导致内容被隐藏掉，无法显示需要溢出的元素。<br></p><h3 id="3-父级标签使用after伪元素清除浮动"><a href="#3-父级标签使用after伪元素清除浮动" class="headerlink" title="3. 父级标签使用after伪元素清除浮动"></a>3. 父级标签使用after伪元素清除浮动</h3><p><strong>:after 方式为空元素的升级版，好处是不用单独加标签了</strong> </p><p>使用方法：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">     <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">     <span class="attribute">display</span>: block;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">clear</span>: both;</span><br><span class="line">     <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"> .clearfix &#123;*zoom: 1;&#125;   /* IE6、7 专有 */</span><br></pre></td></tr></table></figure><p>优点： 符合闭合浮动思想  结构语义化正确</p><p>缺点： 由于IE6-7不支持:after，使用 zoom:1触发 hasLayout。</p><p>代表网站： 百度、淘宝网、网易等</p><p><img src="http://wx2.sinaimg.cn/large/006ttwEMgy1fy35tt9hxkj30u80ho41p.jpg" alt=""></p><p>注意： content:””   尽量不带点</p><p><br></p><h3 id="4-父级标签使用before和after双伪元素清除浮动"><a href="#4-父级标签使用before和after双伪元素清除浮动" class="headerlink" title="4. 父级标签使用before和after双伪元素清除浮动"></a>4. 父级标签使用before和after双伪元素清除浮动</h3><p>使用方法：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:before</span>,<span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123; </span><br><span class="line">  <span class="attribute">content</span>:<span class="string">""</span>;</span><br><span class="line">  <span class="attribute">display</span>:table;  <span class="comment">/* 这句话可以出发BFC BFC可以清除浮动,BFC我们后面讲 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line"> <span class="attribute">clear</span>:both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">  *zoom:1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>优点：  代码更简洁</p><p>缺点：  由于IE6-7不支持:after，使用 zoom:1触发 hasLayout。</p><p>代表网站： 小米、腾讯等<br><br><br><br></p>]]></content>
      
      
      
        <tags>
            
            <tag> html/css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>你好哇~</title>
      <link href="/2018/11/30/ABOUT%20ME.html"/>
      <url>/2018/11/30/ABOUT%20ME.html</url>
      
        <content type="html"><![CDATA[<h2 id="关于Dunteng’s-Blog"><a href="#关于Dunteng’s-Blog" class="headerlink" title="关于Dunteng’s Blog"></a>关于Dunteng’s Blog</h2><p>我叫Dunteng ！</p><p>我將在這里分享我的IT技術筆記和其他生活隨筆，let’s record and share together ！</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>数组常用方法</title>
      <link href="/2018/08/22/%E6%95%B0%E7%BB%84.html"/>
      <url>/2018/08/22/%E6%95%B0%E7%BB%84.html</url>
      
        <content type="html"><![CDATA[<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="数组的常用方法（ES3）"><a href="#数组的常用方法（ES3）" class="headerlink" title="数组的常用方法（ES3）"></a>数组的常用方法（ES3）</h4><ul><li><p>改变原数组的</p><ul><li><p>push()`        在原数组最后位添加</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line">    arr.push(<span class="number">10</span>);   <span class="comment">//[10]</span></span><br><span class="line">    arr.push(<span class="number">11</span>);   <span class="comment">//[10,11]</span></span><br><span class="line">    arr.push(<span class="number">9</span>);    <span class="comment">//[10,11,9]</span></span><br><span class="line">    arr.push(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>)     <span class="comment">//[10,11,9,1,2,3,4,5,6,7]</span></span><br></pre></td></tr></table></figure><p><em>手动实现一下push方法</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.myPush = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="built_in">arguments</span>.length; i++)&#123;</span><br><span class="line">            <span class="keyword">this</span>[<span class="keyword">this</span>.length] = <span class="built_in">arguments</span>[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.length;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><br></p></li><li><p>pop()            把原数组的最后一位剪切出来，pop方法无视传参</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    arr.pop();      <span class="comment">//[1,2]</span></span><br><span class="line">    arr.pop();      <span class="comment">//[1]</span></span><br></pre></td></tr></table></figure><p><br></p></li><li><p>shift()           把原数组的第一位删除</p></li><li><p>unshift()       在原数组的第一位添加，都是添加，只是和push的方向不同。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    arr.unshift(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(arr);  <span class="comment">//[0,1,2,3]</span></span><br><span class="line">    arr.unshift(<span class="number">-3</span>,<span class="number">-2</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(arr);  <span class="comment">//[-3,-2,-1,0,1,2,3,]</span></span><br><span class="line">    arr.shift();</span><br><span class="line">    <span class="built_in">console</span>.log(arr);  <span class="comment">//[-2,-1,0,1,2,3,]</span></span><br></pre></td></tr></table></figure><p><br></p></li><li><p>sort()             升序数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">2</span>];   <span class="comment">//无序的数组</span></span><br><span class="line">arr.sort();</span><br><span class="line"><span class="built_in">console</span>.log(arr);   <span class="comment">//得：[1,2,3,4,9]</span></span><br></pre></td></tr></table></figure><p>那么 <code>var arr = [4,3,9,1,2];</code>   的话就是   <code>[1,2,3,4,9,10]</code>咯？</p><p>很遗憾，不是，结果是   <code>[1, 10, 2, 3, 4, 9]</code></p><p>为什么呢？因为sort方法提供的升序排序是按照ascii码值继续排序，那么可以用sort（）方法来达到我们想要得到的结果吗？可以，因为sort还提供了一个编程接口，允许我们在sort方法中传入一个参数，这个参数要是一个方法，在方法里面让我们自己来编写排序规则。</p><p>但是这个方法有两个一定要的约定：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line"><span class="comment">//这是我们自己的升序规则</span></span><br><span class="line">    <span class="keyword">if</span>(x&gt;y)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>​    * <strong>1.必须写两个参数</strong></p><p>​    <strong>*2.看返回值</strong></p><p>​        <strong>*当返回值是负数时，x依然在前，y在后</strong></p><p>​        <strong>*当返回值是正数时，y在前，x在后</strong></p><p>​        <strong>*当返回值是0时，不动</strong></p><p>那么sort括号里的函数是什么时候，怎么执行，执行多少次？</p><p>首先，第一次调用匿名函数传入的x，y分别是arr数组中的第一位和第二位，也就是拿4跟3比</p><p>4&gt;3吗？是，返回1，返回值正数，所以换一下位置，3在前4在后，</p><p><code>匿名函数执行第一次后arr数组： [3,4,9,1,2]</code></p><p>第二次执行，第一位变成3了，拿第一位和第三位比，3&gt;9吗？不大，返回-1，返回值负数，x，也就是3依然在前，y（9）在后。</p><p>第三次执行，x是3，y是1，结果arr数组： [1,3,4,9,2]</p><p>第四次，x是1，y是2，结果arr数组： [1,3,4,9,2]</p><p>第五次了，第一位已经和其他位全部比完，x从第二位拿，x是3，y是4</p><p>如此循环下去。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line"><span class="comment">//这是我们自己的升序规则</span></span><br><span class="line">    <span class="keyword">if</span>(x&gt;y)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>上面代码中如果判断条件是x&lt;y就是降序功能，数值大的在前小的在后。</p><p>优化代码：</p><p>依然是升序，既然我们需要 一个返回结果，x和y作比较，x大于y返回结果要是一个正数，那么直接</p><p><code>return   x - y</code>  就满足了上述要求。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line"><span class="comment">//这是我们自己的升序规则</span></span><br><span class="line"><span class="keyword">return</span> x-y;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>x大于y那么相减肯定是正数，反之是负数。</p><p>如果是要降序，则判断条件改为<code>y-x</code>。</p><p><br></p></li><li><p>reverse         颠倒原数组元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.reverse());    <span class="comment">//['c','b','a']</span></span><br></pre></td></tr></table></figure><p><br></p></li><li><p>splice（参数1，参数2，参数3）           </p><p>参数1：从下标是几开始切？</p><p>参数2：切多少？</p><p>参数3：在切口处添加新数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>];</span><br><span class="line">    <span class="comment">//两个参数的</span></span><br><span class="line">    arr.splice(<span class="number">1</span>,<span class="number">1</span>);      <span class="comment">//从下标是1的地方开始切，切一个长度的数据</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr);     <span class="comment">//['a','c']</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>];</span><br><span class="line">    <span class="comment">//三个参数的，假如要实现将数组arr添加一位数据变成[1,2,3,4,5]?</span></span><br><span class="line">    arr.splice(<span class="number">3</span>,<span class="number">0</span>,<span class="number">4</span>);  </span><br><span class="line"><span class="comment">//在下标是3的地方，切除0个(也就是没有切，所以光标也就是切口，在数字5的前面)，添加一个数据4</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr); <span class="comment">//[1,2,3,4,5]</span></span><br></pre></td></tr></table></figure><p><strong>注意：参数1可以为负数</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">arr.splice(<span class="number">-1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr);   <span class="comment">//[1,2]</span></span><br></pre></td></tr></table></figure><p><strong>-1 代表倒数第几位</strong></p><p><br></p><p><br></p></li></ul></li><li><p>不改变原数组的，返回一个新数组出来。</p><ul><li><p>concat()      连接两个数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">const</span> arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>];</span><br><span class="line">    <span class="built_in">console</span>.log(arr1.concat(arr2));</span><br></pre></td></tr></table></figure><p>拼接完之后控制台打印的结果是 [1,2,3,4,5,6,7] ， arr1和arr2都没有改变。</p><p><br></p></li><li><p>join()       数组转换为字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> str = arr.join(<span class="string">'-'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span>(str) +<span class="string">' : '</span> + str);  </span><br><span class="line"><span class="comment">//控制台</span></span><br><span class="line"><span class="comment">//string : 1-2-3</span></span><br></pre></td></tr></table></figure><p>join函数不传参数默认用逗号<code>,</code>连接。</p><p>数组转换为字符串是用join，与之对应的，字符串转换数组是split( )</p><p><strong>字符串的split( )函数</strong></p><p>split（  按照字符串中的什么拆分为数组 ）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'a-b-c-d-e-f-g'</span>;</span><br><span class="line"><span class="keyword">var</span> arr = str.split(<span class="string">'-'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr);   <span class="comment">//(7) ["a", "b", "c", "d", "e", "f", "g"]</span></span><br></pre></td></tr></table></figure></li><li><p>slice()      截取</p><p>slice（）</p><p>无参数，截取整个数组。</p><p>slice（<code>从下标多少开始截取到最后</code>）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> newArr = arr.slice(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(newArr);  <span class="comment">//[3,4,5]</span></span><br></pre></td></tr></table></figure><p>参数如果是负数则表示从倒数第几位开始截取。</p><p>slice( <code>从下标多少开始截取</code>，<code>截取到第几下标</code> )</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> newArr = arr.slice(<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(newArr);  <span class="comment">//[1,2]</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><h3 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h3><p>1、给一个有序的数组，如何操作才可以让这个有序的数组乱序？</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//有序的数组使之乱序</span></span><br><span class="line">    <span class="keyword">const</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>];</span><br><span class="line">    <span class="built_in">console</span>.log( arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>; &#125;) );</span><br></pre></td></tr></table></figure><p>2、颠倒字符串 str=’abcde’ 为  ‘edcba’</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abcde'</span>;</span><br><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line"><span class="comment">//字符串转换为数组</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;str.length;i++)&#123;</span><br><span class="line">    arr.push(str.charAt(i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//颠倒数组</span></span><br><span class="line">arr.reverse();</span><br><span class="line"><span class="comment">//数组转换字符串，正则表达式去掉逗号</span></span><br><span class="line">str = arr.join().replace(<span class="regexp">/,/g</span>, <span class="string">""</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
